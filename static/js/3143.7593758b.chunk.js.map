{"version":3,"file":"static/js/3143.7593758b.chunk.js","mappings":"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","sources":["../node_modules/src/.internal/core/util/ResizeSensor.ts","../node_modules/src/.internal/core/util/InterfaceColors.ts","../node_modules/src/.internal/core/util/NumberFormatter.ts","../node_modules/src/.internal/core/util/Timezone.ts","../node_modules/src/.internal/core/util/DateFormatter.ts","../node_modules/src/.internal/core/util/DurationFormatter.ts","../node_modules/src/locales/en.ts","../node_modules/src/.internal/core/util/Language.ts","../node_modules/src/.internal/core/util/Matrix.ts","../node_modules/svg-arc-to-cubic-bezier/modules/index.js","../node_modules/src/.internal/core/render/backend/CanvasRenderer.ts","../node_modules/src/.internal/core/Root.ts","../node_modules/@arcgis/core/widgets/support/chartUtilsAm5.js","../node_modules/src/.internal/core/render/PointedRectangle.ts","../node_modules/src/.internal/core/render/Tooltip.ts"],"sourcesContent":["/** @ignore *//** */\n\nimport type { IDisposer } from \"./Disposer\";\nimport * as $array from \"./Array\";\nimport * as $utils from \"./Utils\";\n\n/**\n * @ignore\n */\ninterface Sensor {\n\taddTarget(target: Element, callback: () => void): void;\n\tremoveTarget(target: Element): void;\n}\n\n/**\n * @ignore\n */\ndeclare const ResizeObserver: any;\n\n/**\n * @ignore\n */\nclass Native implements Sensor {\n\tprivate _observer: any;\n\tprivate _targets: Array<{ target: Element, callback: () => void }> = [];\n\n\tconstructor() {\n\t\tthis._observer = new ResizeObserver((entries: Array<any>) => {\n\t\t\t$array.each(entries, (entry) => {\n\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\tif (x.target === entry.target) {\n\t\t\t\t\t\tx.callback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tthis._observer.observe(target, { box: \"border-box\" });\n\t\tthis._targets.push({ target, callback });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\tthis._observer.unobserve(target);\n\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\t}\n}\n\n/**\n * @ignore\n */\ninterface ClientBounds {\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\ttop: number,\n\tbottom: number,\n\tx: number,\n\ty: number\n}\n\n\n/**\n * @ignore\n */\nclass Raf implements Sensor {\n\tpublic static delay: number = 200;\n\n\tprivate _timer: number | null = null;\n\tprivate _targets: Array<{ target: Element, callback: () => void, size: ClientRect | DOMRect | ClientBounds }> = [];\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tif (this._timer === null) {\n\t\t\tlet lastTime: number | null = null;\n\n\t\t\tconst loop = () => {\n\t\t\t\tconst currentTime = Date.now();\n\n\t\t\t\tif (lastTime === null || currentTime > (lastTime + Raf.delay)) {\n\t\t\t\t\tlastTime = currentTime;\n\n\t\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\t\tlet newSize = x.target.getBoundingClientRect();\n\n\t\t\t\t\t\tif (newSize.width !== x.size.width || newSize.height !== x.size.height) {\n\t\t\t\t\t\t\tx.size = newSize;\n\t\t\t\t\t\t\tx.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this._targets.length === 0) {\n\t\t\t\t\tthis._timer = null;\n\n\t\t\t\t} else {\n\t\t\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t}\n\n\t\t// We start off with fake bounds so that sensor always kicks in\n\t\tlet size = { width: 0, height: 0, left: 0, right: 0, top: 0, bottom: 0, x: 0, y: 0 };\n\t\tthis._targets.push({ target, callback, size });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\n\t\tif (this._targets.length === 0) {\n\t\t\tif (this._timer !== null) {\n\t\t\t\tcancelAnimationFrame(this._timer);\n\t\t\t\tthis._timer = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * @ignore\n */\nlet observer: Sensor | null = null;\n\n/**\n * @ignore\n */\nfunction makeSensor(): Sensor {\n\tif (observer === null) {\n\t\tif (typeof ResizeObserver !== \"undefined\") {\n\t\t\tobserver = new Native();\n\n\t\t} else {\n\t\t\tobserver = new Raf();\n\t\t}\n\t}\n\n\treturn observer;\n}\n\n/**\n * @ignore\n */\nexport class ResizeSensor implements IDisposer {\n\tprivate _sensor: Sensor;\n\tprivate _element: Element;\n\tprivate _listener: IDisposer;\n\tprivate _disposed: boolean = false;\n\n\tconstructor(element: Element, callback: () => void) {\n\t\tthis._sensor = makeSensor();\n\t\tthis._element = element;\n\n\t\t// This is needed because we need to know when the window is zoomed\n\t\tthis._listener = $utils.onZoom(callback);\n\n\t\tthis._sensor.addTarget(element, callback);\n\t}\n\n\tpublic isDisposed() {\n\t\treturn this._disposed;\n\t}\n\n\tpublic dispose() {\n\t\tif (!this._disposed) {\n\t\t\tthis._disposed = true;\n\t\t\tthis._sensor.removeTarget(this._element);\n\t\t\tthis._listener.dispose();\n\t\t}\n\t}\n\n\tpublic get sensor(): Sensor {\n\t\treturn this._sensor;\n\t}\n}\n","import type { Color } from \"./Color\"\n\nimport { Entity, IEntitySettings } from \"./Entity\"\n\n\nexport interface IInterfaceColorsSettings extends IEntitySettings {\n\n\t/**\n\t * Used for generic outlines.\n\t */\n\tstroke?: Color,\n\n\t/**\n\t * Used for generic fills.\n\t */\n\tfill?: Color,\n\n\t/**\n\t * Primary button fill color.\n\t */\n\tprimaryButton?: Color,\n\n\t/**\n\t * Primary button fill color on hover.\n\t */\n\tprimaryButtonHover?: Color,\n\n\t/**\n\t * Primary button fill color when pressing down on it.\n\t */\n\tprimaryButtonDown?: Color,\n\n\t/**\n\t * Primary button fill color when it is set as active.\n\t */\n\tprimaryButtonActive?: Color,\n\n\t/**\n\t * Primary button fill color when it is set as disabled.\n\t */\n\tprimaryButtonDisabled?: Color,\t\n\n\t/**\n\t * Primary button text color when it is set as disabled.\n\t */\n\tprimaryButtonTextDisabled?: Color,\n\n\t/**\n\t * Primary button text color.\n\t */\n\tprimaryButtonText?: Color,\t\n\n\t/**\n\t * Primary button stroke (outline) color.\n\t */\n\tprimaryButtonStroke?: Color,\n\n\t/**\n\t * Secondary button fill color.\n\t */\n\tsecondaryButton?: Color,\n\n\t/**\n\t * Secondary button fill color on hover.\n\t */\n\tsecondaryButtonHover?: Color,\n\n\t/**\n\t * Secondary button fill color when pressing down on it.\n\t */\n\tsecondaryButtonDown?: Color,\n\n\t/**\n\t * Secondary button fill color when it is set as active.\n\t */\n\tsecondaryButtonActive?: Color,\n\n\t/**\n\t * Secondary button text color.\n\t */\n\tsecondaryButtonText?: Color,\n\n\t/**\n\t * Secondary button stroke (outline) color.\n\t */\n\tsecondaryButtonStroke?: Color,\n\n\t/**\n\t * Grid color.\n\t */\n\tgrid?: Color,\n\n\t/**\n\t * Chart background color.\n\t */\n\tbackground?: Color,\n\n\t/**\n\t * Alternative background, for elements that need to contrast with primary\n\t * background.\n\t */\n\talternativeBackground?: Color,\n\n\t/**\n\t * Label text color.\n\t */\n\ttext?: Color,\n\n\t/**\n\t * Alternative text color, used for inverted (dark) backgrounds.\n\t * @type {[type]}\n\t */\n\talternativeText?: Color,\n\n\t/**\n\t * Color for disabled elements.\n\t */\n\tdisabled?: Color,\n\n\t/**\n\t * Color to indicate positive value.\n\t */\n\tpositive?: Color,\n\n\t/**\n\t * Color to indicate negative value.\n\t */\n\tnegative?: Color\n\n}\n\n\n/**\n * Presets for common UI elements.\n */\nexport class InterfaceColors extends Entity {\n\tpublic static className: string = \"InterfaceColors\";\n\tpublic static classNames: Array<string> = Entity.classNames.concat([InterfaceColors.className]);\n\n\tdeclare public _settings: IInterfaceColorsSettings;\n}\n","import type { Language } from \"./Language\";\n\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport { TextFormatter } from \"./TextFormatter\";\n\nimport * as $object from \"./Object\";\nimport * as $utils from \"./Utils\";\nimport * as $type from \"./Type\";\n\n/**\n * @ignore\n */\nexport interface INumberSuffix {\n\tnumber: number;\n\tsuffix: string;\n}\n\nexport interface INumberFormatterSettings extends IEntitySettings {\n\n\t/**\n\t * Number format to be used when formatting numbers.\n\t *\n\t * @default \"#,###.#####\"\n\t */\n\tnumberFormat?: string | Intl.NumberFormatOptions;\n\n\t/**\n\t * A threshold value for negative numbers.\n\t *\n\t * @default 0\n\t */\n\tnegativeBase?: number;\n\n\t/**\n\t * Prefixes and thresholds to group big numbers into, e.g. 1M.\n\t *\n\t * Used in conjunction with `a` modifier of the number format.\n\t */\n\tbigNumberPrefixes?: INumberSuffix[];\n\n\t/**\n\t * Prefixes and thresholds to group small numbers into, e.g. 1m.\n\t *\n\t * Used in conjunction with `a` modifier of the number format.\n\t */\n\tsmallNumberPrefixes?: INumberSuffix[];\n\n\t/**\n\t * All numbers below this value are considered small.\n\t *\n\t * @default 1\n\t */\n\tsmallNumberThreshold?: number;\n\n\t/**\n\t * Prefixes to and thresholds to use when grouping data size numbers, e.g. 1MB.\n\t *\n\t * Used in conjunction with `b` modifier of the number format.\n\t */\n\tbytePrefixes?: INumberSuffix[];\n\n\t/**\n\t * Indicates which fields in data should be considered numeric.\n\t *\n\t * It is used when formatting data placeholder values.\n\t */\n\tnumericFields?: string[];\n\n\t/**\n\t * Locales if you are using date formats in `Intl.NumberFormatOptions` syntax.\n\t *\n\t * @see (@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NumberFormat) about using Intl for number formatting\n\t * @param value Locales\n\t */\n\tintlLocales?: string;\n\n\t/**\n\t * If set to `true` will force the number string to be LTR, even if RTL is\n\t * enabled.\n\t * \n\t * @default false\n\t * @since 5.3.13\n\t */\n\tforceLTR?: boolean;\n\n}\n\nexport interface INumberFormatterPrivate extends IEntityPrivate {\n}\n\n/**\n * Number formatter\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\n * @important\n */\nexport class NumberFormatter extends Entity {\n\tdeclare public _settings: INumberFormatterSettings;\n\tdeclare public _privateSettings: INumberFormatterPrivate;\n\n\tprotected _setDefaults() {\n\t\t// Defaults\n\t\tthis._setDefault(\"negativeBase\", 0);\n\t\tthis._setDefault(\"numberFormat\", \"#,###.#####\");\n\t\tthis._setDefault(\"smallNumberThreshold\", 1.00);\n\n\t\tconst bns = \"_big_number_suffix_\";\n\t\tconst sns = \"_small_number_suffix_\";\n\t\tconst bs = \"_byte_suffix_\";\n\n\t\tthis._setDefault(\"bigNumberPrefixes\", [\n\t\t\t{ \"number\": 1e+3, \"suffix\": this._t(bns + \"3\") },\n\t\t\t{ \"number\": 1e+6, \"suffix\": this._t(bns + \"6\") },\n\t\t\t{ \"number\": 1e+9, \"suffix\": this._t(bns + \"9\") },\n\t\t\t{ \"number\": 1e+12, \"suffix\": this._t(bns + \"12\") },\n\t\t\t{ \"number\": 1e+15, \"suffix\": this._t(bns + \"15\") },\n\t\t\t{ \"number\": 1e+18, \"suffix\": this._t(bns + \"18\") },\n\t\t\t{ \"number\": 1e+21, \"suffix\": this._t(bns + \"21\") },\n\t\t\t{ \"number\": 1e+24, \"suffix\": this._t(bns + \"24\") }\n\t\t]);\n\n\t\tthis._setDefault(\"smallNumberPrefixes\", [\n\t\t\t{ \"number\": 1e-24, \"suffix\": this._t(sns + \"24\") },\n\t\t\t{ \"number\": 1e-21, \"suffix\": this._t(sns + \"21\") },\n\t\t\t{ \"number\": 1e-18, \"suffix\": this._t(sns + \"18\") },\n\t\t\t{ \"number\": 1e-15, \"suffix\": this._t(sns + \"15\") },\n\t\t\t{ \"number\": 1e-12, \"suffix\": this._t(sns + \"12\") },\n\t\t\t{ \"number\": 1e-9, \"suffix\": this._t(sns + \"9\") },\n\t\t\t{ \"number\": 1e-6, \"suffix\": this._t(sns + \"6\") },\n\t\t\t{ \"number\": 1e-3, \"suffix\": this._t(sns + \"3\") }\n\t\t]);\n\n\t\tthis._setDefault(\"bytePrefixes\", [\n\t\t\t{ \"number\": 1, suffix: this._t(bs + \"B\") },\n\t\t\t{ \"number\": 1024, suffix: this._t(bs + \"KB\") },\n\t\t\t{ \"number\": 1048576, suffix: this._t(bs + \"MB\") },\n\t\t\t{ \"number\": 1073741824, suffix: this._t(bs + \"GB\") },\n\t\t\t{ \"number\": 1099511627776, suffix: this._t(bs + \"TB\") },\n\t\t\t{ \"number\": 1125899906842624, suffix: this._t(bs + \"PB\") }\n\t\t]);\n\n\t\tsuper._setDefaults();\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\t}\n\n\t/**\n\t * Formats the number according to specific format.\n\t *\n\t * @param value   Value to format\n\t * @param format  Format to apply\n\t * @return Formatted number\n\t */\n\tpublic format(value: number | string, format?: string | Intl.NumberFormatOptions, precision?: number): string {\n\n\t\t// no format passed in or \"Number\"\n\t\tif (format == null || ($type.isString(format) && format.toLowerCase() === \"number\")) {\n\t\t\tformat = this.get(\"numberFormat\", \"\");\n\t\t}\n\n\t\t// Init return value\n\t\tlet formatted;\n\n\t\t// Cast to number just in case\n\t\t// TODO: maybe use better casting\n\t\tlet source: number = Number(value);\n\n\t\t// Is it a built-in format or Intl.NumberFormatOptions\n\t\tif ($type.isObject(format)) {\n\t\t\ttry {\n\t\t\t\tif (this.get(\"intlLocales\")) {\n\t\t\t\t\treturn new Intl.NumberFormat(this.get(\"intlLocales\"), <Intl.NumberFormatOptions>format).format(source);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn new Intl.NumberFormat(undefined, <Intl.NumberFormatOptions>format).format(source);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn \"Invalid\";\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\t// Clean format\n\t\t\tformat = $utils.cleanFormat(format!);\n\n\t\t\t// Get format info (it will also deal with parser caching)\n\t\t\tlet info = this.parseFormat(format, this._root.language);\n\n\n\t\t\t// format and replace the number\n\t\t\tlet details;\n\t\t\tif (source > this.get(\"negativeBase\")) {\n\t\t\t\tdetails = info.positive;\n\t\t\t}\n\t\t\telse if (source < this.get(\"negativeBase\")) {\n\t\t\t\tdetails = info.negative;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdetails = info.zero;\n\t\t\t}\n\n\t\t\t// Adjust precision\n\t\t\tif (precision != null && !details.mod) {\n\t\t\t\tdetails = $object.copy(details);\n\t\t\t\tdetails.decimals.active = source == 0 ? 0 : precision;\n\t\t\t}\n\n\t\t\t// Format\n\t\t\tformatted = details.template.split($type.PLACEHOLDER).join(this.applyFormat(source, details));\n\n\t\t}\n\n\t\tif (this.get(\"forceLTR\") === true) {\n\t\t\tformatted = \"\" + formatted;\n\t\t}\n\n\t\treturn formatted;\n\t}\n\n\t/**\n\t * Parses supplied format into structured object which can be used to format\n\t * the number.\n\t *\n\t * @param format Format string, i.e. \"#,###.00\"\n\t * @param language Language\n\t * @ignore\n\t */\n\tprotected parseFormat(format: string, language: Language): any {\n\n\t\t// Check cache\n\t\t// TODO\n\t\t// let cached = this.getCache(format);\n\t\t// if (cached != null) {\n\t\t// \treturn cached;\n\t\t// }\n\n\t\tconst thousandSeparator = language.translateEmpty(\"_thousandSeparator\");\n\t\tconst decimalSeparator = language.translateEmpty(\"_decimalSeparator\")\n\n\t\t// init format parse info holder\n\t\tlet info: any = {\n\t\t\t\"positive\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t},\n\t\t\t\"negative\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t},\n\t\t\t\"zero\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t}\n\t\t};\n\n\t\t// Escape double vertical bars (that mean display one vertical bar)\n\t\tformat = format.replace(\"||\", $type.PLACEHOLDER2);\n\n\t\t// Split it up and deal with different formats\n\t\tlet parts = format.split(\"|\");\n\t\tinfo.positive.source = parts[0];\n\n\t\tif (typeof parts[2] === \"undefined\") {\n\t\t\tinfo.zero = info.positive;\n\t\t}\n\t\telse {\n\t\t\tinfo.zero.source = parts[2];\n\t\t}\n\n\t\tif (typeof parts[1] === \"undefined\") {\n\t\t\tinfo.negative = info.positive;\n\t\t}\n\t\telse {\n\t\t\tinfo.negative.source = parts[1];\n\t\t}\n\n\t\t// Parse each\n\t\t$object.each(info, (_part, item) => {\n\t\t\t// Already parsed\n\t\t\tif (item.parsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check cached\n\t\t\t// TODO\n\t\t\t// if (typeof this.getCache(item.source) !== \"undefined\") {\n\t\t\t// \tinfo[part] = this.getCache(item.source);\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\t// Begin parsing\n\t\t\tlet partFormat = item.source;\n\n\t\t\t// Just \"Number\"?\n\t\t\tif (partFormat.toLowerCase() === \"number\") {\n\t\t\t\tpartFormat = this.get(\"numberFormat\", \"#,###.#####\");\n\t\t\t}\n\n\t\t\t// Let TextFormatter split into chunks\n\t\t\tlet chunks = TextFormatter.chunk(partFormat, true);\n\t\t\tfor (let i: number = 0; i < chunks.length; i++) {\n\t\t\t\tlet chunk = chunks[i];\n\n\t\t\t\t// replace back double vertical bar\n\t\t\t\tchunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\n\n\t\t\t\tif (chunk.type === \"value\") {\n\t\t\t\t\t// Parse format\n\n\t\t\t\t\t// Look for codes\n\t\t\t\t\tlet matches: string[] | null = chunk.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP!]?/);\n\n\t\t\t\t\tif (matches) {\n\t\t\t\t\t\tif (matches === null || matches[0] === \"\") {\n\t\t\t\t\t\t\t// no codes here - assume string\n\t\t\t\t\t\t\t// nothing to do here\n\t\t\t\t\t\t\titem.template += chunk.text;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\n\t\t\t\t\t\t\t// look for the format modifiers at the end\n\t\t\t\t\t\t\tlet mods: string[] | null = matches[0].match(/[abespABESP%!]{2}|[abespABESP%]{1}$/);\n\n\t\t\t\t\t\t\tif (mods) {\n\t\t\t\t\t\t\t\titem.mod = mods[0].toLowerCase();\n\t\t\t\t\t\t\t\titem.modSpacing = matches[0].match(/[ ]{1}[abespABESP%!]{1}$/) ? true : false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// break the format up\n\t\t\t\t\t\t\tlet a = matches[0].split(\".\");\n\n\t\t\t\t\t\t\t// Deal with thousands\n\t\t\t\t\t\t\tif (a[0] === \"\") {\n\t\t\t\t\t\t\t\t// No directives for thousands\n\t\t\t\t\t\t\t\t// Leave default settings (no formatting)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Counts\n\t\t\t\t\t\t\t\titem.thousands.active = (a[0].match(/0/g) || []).length;\n\t\t\t\t\t\t\t\titem.thousands.passive = (a[0].match(/\\#/g) || []).length + item.thousands.active;\n\n\t\t\t\t\t\t\t\t// Separator interval\n\t\t\t\t\t\t\t\tlet b = a[0].split(\",\");\n\t\t\t\t\t\t\t\tif (b.length === 1) {\n\t\t\t\t\t\t\t\t\t// No thousands separators\n\t\t\t\t\t\t\t\t\t// Do nothing\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// Use length fo the last chunk as thousands length\n\t\t\t\t\t\t\t\t\titem.thousands.interval = (b.pop() || \"\").length;\n\n\t\t\t\t\t\t\t\t\tif (item.thousands.interval === 0) {\n\t\t\t\t\t\t\t\t\t\titem.thousands.interval = -1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Deal with decimals\n\t\t\t\t\t\t\tif (typeof (a[1]) === \"undefined\") {\n\t\t\t\t\t\t\t\t// No directives for decimals\n\t\t\t\t\t\t\t\t// Leave at defaults (no formatting)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Counts\n\t\t\t\t\t\t\t\titem.decimals.active = (a[1].match(/0/g) || []).length;\n\t\t\t\t\t\t\t\titem.decimals.passive = (a[1].match(/\\#/g) || []).length + item.decimals.active;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Add special code to template\n\t\t\t\t\t\t\titem.template += chunk.text.split(matches[0]).join($type.PLACEHOLDER);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Quoted string - take it as it is\n\t\t\t\t\titem.template += chunk.text;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply style formatting\n\t\t\t//item.template = getTextFormatter().format(item.template, this.outputFormat);\n\n\t\t\t// Save cache\n\t\t\t// TODO\n\t\t\t//this.setCache(item.source, item);\n\n\t\t\t// Mark this as parsed\n\t\t\titem.parsed = true;\n\n\t\t});\n\n\t\t// Save cache (the whole thing)\n\t\t// TODO\n\t\t//this.setCache(format, info);\n\n\t\treturn info;\n\t}\n\n\t/**\n\t * Applies parsed format to a numeric value.\n\t *\n\t * @param value    Value\n\t * @param details  Parsed format as returned by parseFormat()\n\t * @return Formatted number\n\t * @ignore\n\t */\n\tprotected applyFormat(value: number, details: any): string {\n\n\t\t// Use absolute values\n\t\tlet negative: boolean = value < 0;\n\t\tvalue = Math.abs(value);\n\n\t\t// Recalculate according to modifier\n\t\tlet prefix: string = \"\", suffix: string = \"\";\n\t\tlet mods: string[] = details.mod ? details.mod.split(\"\") : [];\n\t\tif (mods.indexOf(\"b\") !== -1) {\n\t\t\tlet a = this.applyPrefix(value, this.get(\"bytePrefixes\")!, mods.indexOf(\"!\") !== -1);\n\t\t\tvalue = a[0];\n\t\t\tprefix = a[1];\n\t\t\tsuffix = a[2];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"a\") !== -1) {\n\t\t\tlet a = this.applyPrefix(value, value < this.get(\"smallNumberThreshold\")! ? this.get(\"smallNumberPrefixes\")! : this.get(\"bigNumberPrefixes\")!, mods.indexOf(\"!\") !== -1);\n\t\t\tvalue = a[0];\n\t\t\tprefix = a[1];\n\t\t\tsuffix = a[2];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"p\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 2, 21);\n\t\t\t//value *= 100;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tprefix = this._root.language.translate(\"_percentPrefix\");\n\t\t\tsuffix = this._root.language.translate(\"_percentSuffix\");\n\t\t\tif (prefix == \"\" && suffix == \"\") {\n\t\t\t\tsuffix = \"%\";\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"%\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 2, 21);\n\t\t\tvalue *= 100;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tsuffix = \"%\";\n\t\t}\n\t\telse if (mods.indexOf(\"\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 3, 21);\n\t\t\tvalue *= 1000;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tsuffix = \"\";\n\t\t}\n\n\t\t// Round to passive\n\t\tif (mods.indexOf(\"e\") !== -1) {\n\t\t\t// convert the value to exponential\n\t\t\tlet exp: string[];\n\t\t\tif (details.decimals.passive >= 0) {\n\t\t\t\texp = value.toExponential(details.decimals.passive).split(\"e\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\texp = value.toExponential().split(\"e\");\n\t\t\t}\n\t\t\tvalue = Number(exp[0]);\n\t\t\tsuffix = \"e\" + exp[1];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (details.decimals.passive === 0) {\n\t\t\tvalue = Math.round(value);\n\t\t}\n\t\telse if (details.decimals.passive > 0) {\n\t\t\tconst decimals = $utils.decimalPlaces(value);\n\t\t\tif (decimals > 0) {\n\t\t\t\tconst d = Math.pow(10, details.decimals.passive);\n\t\t\t\tvalue = Math.round(parseFloat((value * d).toFixed(decimals))) / d;\n\t\t\t}\n\t\t}\n\n\t\t// Init return value\n\t\tlet res: string = \"\";\n\n\t\t// Calc integer and decimal parts\n\t\tlet a = $type.numberToString(value).split(\".\");\n\n\t\t// Format integers\n\t\tlet ints = a[0];\n\n\t\t// Pad integers to active length\n\t\tif (ints.length < details.thousands.active) {\n\t\t\tints = Array(details.thousands.active - ints.length + 1).join(\"0\") + ints;\n\t\t}\n\n\t\t// Insert thousands separators\n\t\tif (details.thousands.interval > 0) {\n\t\t\tlet ip: string[] = [];\n\t\t\tlet intsr: string = ints.split(\"\").reverse().join(\"\");\n\t\t\tfor (let i = 0, len = ints.length; i <= len; i += details.thousands.interval) {\n\t\t\t\tlet c: string = intsr.substr(i, details.thousands.interval).split(\"\").reverse().join(\"\");\n\t\t\t\tif (c !== \"\") {\n\t\t\t\t\tip.unshift(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\tints = ip.join(details.thousands.separator);\n\t\t}\n\n\t\t// Add integers\n\t\tres += ints;\n\n\t\t// Add decimals\n\t\tif (a.length === 1) {\n\t\t\ta.push(\"\");\n\t\t}\n\t\tlet decs: string = a[1];\n\n\t\t// Fill zeros?\n\t\tif (decs.length < details.decimals.active) {\n\t\t\tdecs += Array(details.decimals.active - decs.length + 1).join(\"0\");\n\t\t}\n\n\t\tif (decs !== \"\") {\n\t\t\tres += details.decimals.separator + decs;\n\t\t}\n\n\t\t// Can't have empty return value\n\t\tif (res === \"\") {\n\t\t\tres = \"0\";\n\t\t}\n\n\t\t// Add minus sign back\n\t\tif (value !== 0 && negative && (mods.indexOf(\"s\") === -1)) {\n\t\t\tres = \"-\" + res;\n\t\t}\n\n\t\t// Add suffixes/prefixes\n\t\tif (prefix) {\n\t\t\tres = prefix + res;\n\t\t}\n\t\tif (suffix) {\n\t\t\tres += suffix;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\n\tprotected applyPrefix(value: number, prefixes: any[], force: boolean = false): any[] {\n\t\tlet newvalue = value;\n\t\tlet prefix = \"\";\n\t\tlet suffix = \"\";\n\t\tlet applied = false;\n\t\tlet k = 1;\n\n\t\tfor (let i = 0, len = prefixes.length; i < len; i++) {\n\t\t\tif (prefixes[i].number <= value) {\n\t\t\t\tif (prefixes[i].number === 0) {\n\t\t\t\t\tnewvalue = 0;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewvalue = value / prefixes[i].number;\n\t\t\t\t\tk = prefixes[i].number;\n\t\t\t\t}\n\t\t\t\tprefix = prefixes[i].prefix;\n\t\t\t\tsuffix = prefixes[i].suffix;\n\t\t\t\tapplied = true;\n\t\t\t}\n\t\t}\n\n\n\t\tif (!applied && force && prefixes.length && value != 0) {\n\t\t\t// Prefix was not applied. Use the first prefix.\n\t\t\tnewvalue = value / prefixes[0].number;\n\t\t\tprefix = prefixes[0].prefix;\n\t\t\tsuffix = prefixes[0].suffix;\n\t\t\tapplied = true;\n\t\t}\n\n\t\tif (applied) {\n\t\t\tnewvalue = parseFloat(\n\t\t\t\tnewvalue.toPrecision(\n\t\t\t\t\tMath.min(k.toString().length + Math.floor(newvalue).toString().replace(/[^0-9]*/g, \"\").length, 21)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn [newvalue, prefix, suffix];\n\t}\n\n\t/**\n\t * Replaces brackets with temporary placeholders.\n\t *\n\t * @ignore Exclude from docs\n\t * @param text  Input text\n\t * @return Escaped text\n\t */\n\tpublic escape(text: string): string {\n\t\treturn text.replace(\"||\", $type.PLACEHOLDER2);\n\t}\n\n\t/**\n\t * Replaces placeholders back to brackets.\n\t *\n\t * @ignore Exclude from docs\n\t * @param text  Escaped text\n\t * @return Unescaped text\n\t */\n\tpublic unescape(text: string): string {\n\t\treturn text.replace($type.PLACEHOLDER2, \"|\");\n\t}\n\n}\n","interface ParsedDate {\n\tyear: number,\n\tmonth: number,\n\tday: number,\n\thour: number,\n\tminute: number,\n\tsecond: number,\n\tmillisecond: number,\n\tweekday: number\n}\n\nfunction parseDate(timezone: Intl.DateTimeFormat, date: Date): ParsedDate {\n\tlet year = 0;\n\tlet month = 0;\n\tlet day = 1;\n\tlet hour = 0;\n\tlet minute = 0;\n\tlet second = 0;\n\tlet millisecond = 0;\n\tlet weekday = 0;\n\n\n\n\ttimezone.formatToParts(date).forEach((x) => {\n\n\t\tswitch (x.type) {\n\t\t\tcase \"year\":\n\t\t\t\tyear = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"month\":\n\t\t\t\tmonth = (+x.value) - 1;\n\t\t\t\tbreak;\n\t\t\tcase \"day\":\n\t\t\t\tday = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"hour\":\n\t\t\t\thour = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"minute\":\n\t\t\t\tminute = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"second\":\n\t\t\t\tsecond = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"fractionalSecond\" as any:\n\t\t\t\tmillisecond = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"weekday\":\n\t\t\t\tswitch (x.value) {\n\t\t\t\t\tcase \"Sun\":\n\t\t\t\t\t\tweekday = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Mon\":\n\t\t\t\t\t\tweekday = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Tue\":\n\t\t\t\t\t\tweekday = 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Wed\":\n\t\t\t\t\t\tweekday = 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Thu\":\n\t\t\t\t\t\tweekday = 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Fri\":\n\t\t\t\t\t\tweekday = 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Sat\":\n\t\t\t\t\t\tweekday = 6;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t});\n\n\tif (hour === 24) {\n\t\thour = 0;\n\t}\n\n\treturn { year, month, day, hour, minute, second, millisecond, weekday };\n}\n\n\nfunction toUTCDate(timezone: Intl.DateTimeFormat, date: Date): number {\n\tconst { year, month, day, hour, minute, second, millisecond } = parseDate(timezone, date);\n\treturn Date.UTC(year, month, day, hour, minute, second, millisecond);\n}\n\n\nexport class Timezone {\n\tprivate _utc: Intl.DateTimeFormat;\n\tprivate _dtf: Intl.DateTimeFormat;\n\n\tpublic readonly name: string | undefined;\n\n\t/**\n\t * Use this method to create an instance of this class.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/#New_element_syntax} for more info\n\t * @param   timezone  IANA timezone\n\t * @return            Instantiated object\n\t */\n\tstatic new<C extends typeof Timezone, T extends InstanceType<C>>(this: C, timezone: string | undefined): T {\n\t\treturn (new this(timezone, true)) as T;\n\t}\n\n\tconstructor(timezone: string | undefined, isReal: boolean) {\n\t\tif (!isReal) {\n\t\t\tthrow new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n\t\t}\n\n\t\tthis.name = timezone;\n\n\t\tthis._utc = new Intl.DateTimeFormat(\"en-US\", {\n\t\t\thour12: false,\n\t\t\ttimeZone: \"UTC\",\n\t\t\tyear: \"numeric\",\n\t\t\tmonth: \"2-digit\",\n\t\t\tday: \"2-digit\",\n\t\t\thour: \"2-digit\",\n\t\t\tminute: \"2-digit\",\n\t\t\tsecond: \"2-digit\",\n\t\t\tweekday: \"short\",\n\t\t\tfractionalSecondDigits: 3,\n\t\t} as any);\n\n\t\tthis._dtf = new Intl.DateTimeFormat(\"en-US\", {\n\t\t\thour12: false,\n\t\t\ttimeZone: timezone,\n\t\t\tyear: \"numeric\",\n\t\t\tmonth: \"2-digit\",\n\t\t\tday: \"2-digit\",\n\t\t\thour: \"2-digit\",\n\t\t\tminute: \"2-digit\",\n\t\t\tsecond: \"2-digit\",\n\t\t\tweekday: \"short\",\n\t\t\tfractionalSecondDigits: 3,\n\t\t} as any);\n\t}\n\n\tconvertLocal(date: Date): Date {\n\t\tconst offset = this.offsetUTC(date);\n\t\tconst userOffset = date.getTimezoneOffset();\n\t\tconst output = new Date(date);\n\t\toutput.setUTCMinutes(output.getUTCMinutes() - (offset - userOffset));\n\n\t\tconst newUserOffset = output.getTimezoneOffset();\n\n\t\tif (userOffset != newUserOffset) {\n\t\t\toutput.setUTCMinutes(output.getUTCMinutes() + newUserOffset - userOffset)\n\t\t}\n\n\t\treturn output;\n\t}\n\n\toffsetUTC(date: Date): number {\n\t\tconst utc = toUTCDate(this._utc, date);\n\t\tconst dtf = toUTCDate(this._dtf, date);\n\t\treturn (utc - dtf) / 60000;\n\t}\n\n\tparseDate(date: Date): ParsedDate {\n\t\treturn parseDate(this._dtf, date)\n\t}\n}\n","import type { ILocaleSettings } from \"./Language\"\n\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport { TextFormatter } from \"./TextFormatter\"\nimport { Timezone } from \"./Timezone\"\n\nimport * as $type from \"./Type\"\nimport * as $utils from \"./Utils\";\n\n/**\n * Interface describing parsed date format definition.\n *\n * @ignore\n */\nexport interface DateFormatInfo {\n\t\"template\": string;\n\t\"parts\": any[];\n}\n\nexport interface IDateFormatterSettings extends IEntitySettings {\n\n\t/**\n\t * Should the first letter of the formatted date be capitalized?\n\t *\n\t * @default true\n\t */\n\tcapitalize?: boolean;\n\n\t/**\n\t * A date format to be used when formatting dates.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tdateFormat?: string | Intl.DateTimeFormatOptions;\n\n\t/**\n\t * An array of data fields that hold date values and should be formatted\n\t * with a [[DateFormatter]].\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/data-placeholders/#Formatting_placeholders} for more info\n\t */\n\tdateFields?: string[];\n\n\t/**\n\t * Locales to use when formatting using `Intl.DateFormatter`.\n\t */\n\tintlLocales?: string;\n\n}\n\nexport interface IDateFormatterPrivate extends IEntityPrivate {\n}\n\ntype Months = \"January\" | \"February\" | \"March\" | \"April\" | \"May\" | \"June\" | \"July\" | \"August\" | \"September\" | \"October\" | \"November\" | \"December\";\ntype ShortMonths = \"Jan\" | \"Feb\" | \"Mar\" | \"Apr\" | \"May(short)\" | \"Jun\" | \"Jul\" | \"Aug\" | \"Sep\" | \"Oct\" | \"Nov\" | \"Dec\";\ntype Weekdays = \"Sunday\" | \"Monday\" | \"Tuesday\" | \"Wednesday\" | \"Thursday\" | \"Friday\" | \"Saturday\";\ntype ShortWeekdays = \"Sun\" | \"Mon\" | \"Tue\" | \"Wed\" | \"Thu\" | \"Fri\" | \"Sat\";\n\n\n/**\n * Date formatter class.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n * @important\n */\nexport class DateFormatter extends Entity {\n\tdeclare public _settings: IDateFormatterSettings;\n\tdeclare public _privateSettings: IDateFormatterPrivate;\n\n\tprotected _setDefaults() {\n\t\t// Defaults\n\t\tthis._setDefault(\"capitalize\", true);\n\t\tthis._setDefault(\"dateFormat\", \"yyyy-MM-dd\");\n\n\t\tsuper._setDefaults();\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\t}\n\n\t/**\n\t * Formats a source `Date` object into string format\n\t * @param   source          inpout date\n\t * @param   format          Output format\n\t * @param   ignoreTimezone  Ignore timezone?\n\t * @return                  Formatted date\n\t */\n\tpublic format(source: any, format?: string | Intl.DateTimeFormatOptions, ignoreTimezone: boolean = false): string {\n\n\t\t// Locale?\n\t\t// TODO\n\n\t\t// No format passed in or it's empty\n\t\tif (typeof format === \"undefined\" || format === \"\") {\n\t\t\tformat = this.get(\"dateFormat\", \"yyyy-MM-dd\");\n\t\t}\n\n\t\t// Init return value\n\t\tlet formatted;\n\n\t\t// Cast?\n\t\t// TODO: decide if we need to cast\n\t\tlet date: Date = source;\n\n\n\t\t// Is it a built-in format or Intl.DateTimeFormat\n\t\tif ($type.isObject(format)) {\n\n\t\t\ttry {\n\t\t\t\tconst locales = this.get(\"intlLocales\");\n\t\t\t\tif (locales) {\n\t\t\t\t\treturn new Intl.DateTimeFormat(locales, <Intl.DateTimeFormatOptions>format).format(date);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn new Intl.DateTimeFormat(undefined, <Intl.DateTimeFormatOptions>format).format(date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn \"Invalid\";\n\t\t\t}\n\n\t\t}\n\n\t\t// get format info (it will also deal with parser caching)\n\t\tlet info = this.parseFormat(format);\n\n\t\t// Should we apply custom time zone?\n\t\tconst timezone = this._root.timezone;\n\t\tlet originalDate = date;\n\t\tif (timezone && !this._root.utc && !ignoreTimezone) {\n\t\t\tdate = timezone.convertLocal(date);\n\t\t}\n\n\t\t// Check if it's a valid date\n\t\tif (!$type.isNumber(date.getTime())) {\n\t\t\t// TODO translation\n\t\t\t//return this._t(\"Invalid date\");\n\t\t\treturn \"Invalid date\";\n\t\t}\n\n\t\t// Apply format\n\t\tformatted = this.applyFormat(date, info, ignoreTimezone, originalDate);\n\n\t\t// Capitalize\n\t\tif (this.get(\"capitalize\")) {\n\t\t\tformatted = formatted.replace(\n\t\t\t\t/^.{1}/, formatted.substr(0, 1).toUpperCase()\n\t\t\t);\n\t\t}\n\n\t\t// We're done\n\t\treturn formatted;\n\t}\n\n\t/**\n\t * Applies format to Date.\n\t *\n\t * @param date      Date object\n\t * @param info      Parsed format information\n\t * @return Formatted date string\n\t */\n\tprotected applyFormat(date: Date, info: DateFormatInfo, ignoreTimezone: boolean = false, originalDate?: Date): string {\n\n\t\t// Init return value\n\t\tlet res = info.template;\n\n\t\t// Get values\n\t\tlet fullYear: number,\n\t\t\tmonth: number,\n\t\t\tweekday: number,\n\t\t\tday: number,\n\t\t\thours: number,\n\t\t\tminutes: number,\n\t\t\tseconds: number,\n\t\t\tmilliseconds: number,\n\t\t\ttimestamp: number = date.getTime();\n\t\tif (this._root.utc && !ignoreTimezone) {\n\t\t\tfullYear = date.getUTCFullYear();\n\t\t\tmonth = date.getUTCMonth();\n\t\t\tweekday = date.getUTCDay();\n\t\t\tday = date.getUTCDate();\n\t\t\thours = date.getUTCHours();\n\t\t\tminutes = date.getUTCMinutes();\n\t\t\tseconds = date.getUTCSeconds();\n\t\t\tmilliseconds = date.getUTCMilliseconds();\n\t\t}\n\t\telse {\n\t\t\tfullYear = date.getFullYear();\n\t\t\tmonth = date.getMonth();\n\t\t\tweekday = date.getDay();\n\t\t\tday = date.getDate();\n\t\t\thours = date.getHours();\n\t\t\tminutes = date.getMinutes();\n\t\t\tseconds = date.getSeconds();\n\t\t\tmilliseconds = date.getMilliseconds();\n\t\t}\n\n\t\t// Go through each part and format/replace it in template\n\t\tfor (let i = 0, len = info.parts.length; i < len; i++) {\n\t\t\tlet value: string = \"\";\n\t\t\tswitch (info.parts[i]) {\n\n\t\t\t\tcase \"G\":\n\t\t\t\t\tvalue = this._t(\n\t\t\t\t\t\tfullYear < 0\n\t\t\t\t\t\t\t? \"_era_bc\"\n\t\t\t\t\t\t\t: \"_era_ad\"\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyyy\":\n\t\t\t\t\tvalue = Math.abs(fullYear).toString();\n\t\t\t\t\tif (fullYear < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyy\":\n\t\t\t\tcase \"yy\":\n\t\t\t\tcase \"y\":\n\t\t\t\t\tvalue = Math.abs(fullYear).toString().substr(-info.parts[i].length);\n\t\t\t\t\tif (fullYear < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"YYYY\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\tcase \"YY\":\n\t\t\t\tcase \"Y\":\n\t\t\t\t\tlet year = $utils.getWeekYear(date, this._root.utc);\n\t\t\t\t\tif (info.parts[i] == \"YYYY\") {\n\t\t\t\t\t\tvalue = Math.abs(year).toString();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = Math.abs(year).toString().substr(-info.parts[i].length);\n\t\t\t\t\t}\n\t\t\t\t\tif (year < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"u\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"q\":\n\t\t\t\t\tvalue = \"\" + Math.ceil((date.getMonth() + 1) / 3);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMMM\":\n\t\t\t\t\tvalue = this._t(this._getMonth(month)).substr(0, 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMM\":\n\t\t\t\t\tvalue = this._t(this._getMonth(month));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMM\":\n\t\t\t\t\tvalue = this._t(this._getShortMonth(month));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MM\":\n\t\t\t\t\tvalue = $utils.padString(month + 1, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"M\":\n\t\t\t\t\tvalue = (month + 1).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ww\":\n\t\t\t\t\tvalue = $utils.padString($utils.getWeek(date, this._root.utc), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"w\":\n\t\t\t\t\tvalue = $utils.getWeek(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"W\":\n\t\t\t\t\tvalue = $utils.getMonthWeek(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dd\":\n\t\t\t\t\tvalue = $utils.padString(day, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"d\":\n\t\t\t\t\tvalue = day.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"DD\":\n\t\t\t\tcase \"DDD\":\n\t\t\t\t\tvalue = $utils.padString($utils.getYearDay(date, this._root.utc).toString(), info.parts[i].length, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"D\":\n\t\t\t\t\tvalue = $utils.getYearDay(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"F\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"g\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"t\":\n\t\t\t\t\tvalue = this._root.language.translateFunc(\"_dateOrd\").call(this, day);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"E\":\n\t\t\t\t\tvalue = (weekday || 7).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EE\":\n\t\t\t\t\tvalue = $utils.padString((weekday || 7).toString(), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEE\":\n\t\t\t\tcase \"eee\":\n\t\t\t\t\tvalue = this._t(this._getShortWeekday(weekday));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEEE\":\n\t\t\t\tcase \"eeee\":\n\t\t\t\t\tvalue = this._t(this._getWeekday(weekday));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEEEE\":\n\t\t\t\tcase \"eeeee\":\n\t\t\t\t\tvalue = this._t(this._getShortWeekday(weekday)).substr(0, 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"e\":\n\t\t\t\tcase \"ee\":\n\t\t\t\t\tvalue = (weekday - (this._root.locale.firstDayOfWeek || 1) + 1).toString();\n\t\t\t\t\tif (info.parts[i] == \"ee\") {\n\t\t\t\t\t\tvalue = $utils.padString(value, 2, \"0\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"a\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"PM\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"AM\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aa\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"P.M.\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"A.M.\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aaa\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"P\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"A\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"h\":\n\t\t\t\t\tvalue = $utils.get12Hours(hours).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"hh\":\n\t\t\t\t\tvalue = $utils.padString($utils.get12Hours(hours), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"H\":\n\t\t\t\t\tvalue = hours.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"HH\":\n\t\t\t\t\tvalue = $utils.padString(hours, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"K\":\n\t\t\t\t\tvalue = $utils.get12Hours(hours, 0).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"KK\":\n\t\t\t\t\tvalue = $utils.padString($utils.get12Hours(hours, 0), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"k\":\n\t\t\t\t\tvalue = (hours + 1).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"kk\":\n\t\t\t\t\tvalue = $utils.padString(hours + 1, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"m\":\n\t\t\t\t\tvalue = minutes.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"mm\":\n\t\t\t\t\tvalue = $utils.padString(minutes, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"s\":\n\t\t\t\t\tvalue = seconds.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ss\":\n\t\t\t\t\tvalue = $utils.padString(seconds, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"S\":\n\t\t\t\tcase \"SS\":\n\t\t\t\tcase \"SSS\":\n\t\t\t\t\tvalue = Math.round((milliseconds / 1000) * Math.pow(10, info.parts[i].length)).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"x\":\n\t\t\t\t\tvalue = timestamp.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"n\":\n\t\t\t\tcase \"nn\":\n\t\t\t\tcase \"nnn\":\n\t\t\t\t\tvalue = $utils.padString(milliseconds, info.parts[i].length, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"z\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, false, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, true, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zzz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, false, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zzzz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, true, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Z\":\n\t\t\t\tcase \"ZZ\":\n\t\t\t\t\tlet timezone = this._root.utc ? \"UTC\" : this._root.timezone;\n\t\t\t\t\tif (timezone instanceof Timezone) {\n\t\t\t\t\t\ttimezone = timezone.name;\n\t\t\t\t\t}\n\t\t\t\t\tconst offset = timezone ? $utils.getTimezoneOffset(timezone, originalDate || date) : date.getTimezoneOffset();\n\n\t\t\t\t\tlet tz = Math.abs(offset) / 60;\n\t\t\t\t\tlet tzh = Math.floor(tz);\n\t\t\t\t\tlet tzm = tz * 60 - tzh * 60;\n\n\t\t\t\t\tif (this._root.utc) {\n\t\t\t\t\t\ttzh = 0;\n\t\t\t\t\t\ttzm = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (info.parts[i] == \"Z\") {\n\t\t\t\t\t\tvalue = \"GMT\";\n\t\t\t\t\t\tvalue += offset > 0 ? \"-\" : \"+\";\n\t\t\t\t\t\tvalue += $utils.padString(tzh, 2) + \":\" + $utils.padString(tzm, 2);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = offset > 0 ? \"-\" : \"+\";\n\t\t\t\t\t\tvalue += $utils.padString(tzh, 2) + $utils.padString(tzm, 2);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"i\":\n\t\t\t\t\tvalue = date.toISOString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"I\":\n\t\t\t\t\tvalue = date.toUTCString();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\tres = res.replace($type.PLACEHOLDER, value);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t/**\n\t * Parses format into structured infromation.\n\t *\n\t * @param format Format template\n\t */\n\tprotected parseFormat(format: string): DateFormatInfo {\n\n\t\t// Check cache\n\t\t// TODO: implement caching of the parsed format\n\n\t\t// Init format parse info holder\n\t\tlet info: DateFormatInfo = {\n\t\t\t\"template\": \"\",\n\t\t\t\"parts\": <any>[]\n\t\t};\n\n\t\t// Let TextFormatter split into chunks\n\t\tlet chunks = TextFormatter.chunk(format, true);\n\t\tfor (let i: number = 0; i < chunks.length; i++) {\n\t\t\tlet chunk = chunks[i];\n\n\t\t\tif (chunk.type === \"value\") {\n\n\t\t\t\t// Just \"Date\"?\n\t\t\t\tif (chunk.text.match(/^date$/i)) {\n\t\t\t\t\tlet dateFormat = this.get(\"dateFormat\", \"yyyy-MM-dd\");\n\t\t\t\t\tif (!$type.isString(dateFormat)) {\n\t\t\t\t\t\tdateFormat = \"yyyy-MM-dd\";\n\t\t\t\t\t}\n\t\t\t\t\tchunk.text = dateFormat;\n\t\t\t\t}\n\n\t\t\t\t// Find all possible parts\n\t\t\t\tlet matches = chunk.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);\n\n\t\t\t\t// Found?\n\t\t\t\tif (matches) {\n\n\t\t\t\t\t// Populate template\n\t\t\t\t\tfor (let x = 0; x < matches.length; x++) {\n\t\t\t\t\t\tinfo.parts.push(matches[x]);\n\t\t\t\t\t\tchunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply to template\n\t\t\tinfo.template += chunk.text;\n\t\t}\n\n\t\t// Save cache\n\t\t// TODO\n\n\t\treturn info;\n\t}\n\n\tprotected _months(): Months[] {\n\t\treturn [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\t}\n\n\tprotected _getMonth(index: number): Months {\n\t\treturn this._months()[index];\n\t}\n\n\tprotected _shortMonths(): ShortMonths[] {\n\t\treturn [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May(short)\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\t}\n\n\tprotected _getShortMonth(index: number): ShortMonths {\n\t\treturn this._shortMonths()[index];\n\t}\n\n\tprotected _weekdays(): Weekdays[] {\n\t\treturn [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n\t}\n\n\tprotected _getWeekday(index: number): Weekdays {\n\t\treturn this._weekdays()[index];\n\t}\n\n\tprotected _shortWeekdays(): ShortWeekdays[] {\n\t\treturn [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\t}\n\n\tprotected _getShortWeekday(index: number): ShortWeekdays {\n\t\treturn this._shortWeekdays()[index];\n\t}\n\n\tpublic parse(source: any, format: string, utc?: boolean): Date {\n\n\t\t// If UTC is not supplied, use Root setting\n\t\tif (typeof utc === \"undefined\") {\n\t\t\tutc = this._root.utc;\n\t\t}\n\n\t\t// Is it already a Date\n\t\tif (source instanceof Date) {\n\t\t\treturn source;\n\t\t}\n\n\t\t// Is it a numeric timestamp\n\t\tif ($type.isNumber(source)) {\n\t\t\treturn new Date(source);\n\t\t}\n\n\t\t// Are we parsing a timestamp?\n\t\tif (format == \"x\") {\n\t\t\treturn new Date(parseInt(source));\n\t\t}\n\n\t\t// No? Let's check if it's string, and try converting to it if nec\n\t\tif (!$type.isString(source)) {\n\t\t\tsource = source.toString();\n\t\t}\n\n\t\t// Init return value\n\t\tlet res: Date;\n\n\t\t// Init RegEx for parsing\n\t\tlet reg: string = \"\";\n\n\t\t// Clean format\n\t\tformat = $utils.cleanFormat(format);\n\n\t\t// Clip format to length of the source string\n\t\tformat = format.substr(0, source.length);\n\n\t\t// Parse format\n\t\tlet info = this.parseFormat(format);\n\n\t\t// Init parsed items holder\n\t\tlet parsedIndexes = {\n\t\t\t\"year\": -1,\n\t\t\t\"year3\": -1,\n\t\t\t\"year2\": -1,\n\t\t\t\"year1\": -1,\n\t\t\t\"month\": -1,\n\t\t\t\"monthShort\": -1,\n\t\t\t\"monthLong\": -1,\n\t\t\t\"weekdayShort\": -1,\n\t\t\t\"weekdayLong\": -1,\n\t\t\t\"day\": -1,\n\t\t\t\"yearDay\": -1,\n\t\t\t\"week\": -1,\n\t\t\t\"hourBase0\": -1,\n\t\t\t\"hour12Base0\": -1,\n\t\t\t\"hourBase1\": -1,\n\t\t\t\"hour12Base1\": -1,\n\t\t\t\"minute\": -1,\n\t\t\t\"second\": -1,\n\t\t\t\"millisecond\": -1,\n\t\t\t\"millisecondDigits\": -1,\n\t\t\t\"am\": -1,\n\t\t\t\"zone\": -1,\n\t\t\t\"timestamp\": -1,\n\t\t\t\"iso\": -1\n\t\t};\n\n\t\t// Init values\n\t\tlet resValues = {\n\t\t\t\"year\": 1970,\n\t\t\t\"month\": 0,\n\t\t\t\"day\": 1,\n\t\t\t\"hour\": 0,\n\t\t\t\"minute\": 0,\n\t\t\t\"second\": 0,\n\t\t\t\"millisecond\": 0,\n\t\t\t\"timestamp\": <any>null,\n\t\t\t\"offset\": 0,\n\t\t\t\"utc\": utc\n\t\t}\n\n\t\t// Index adjuster\n\t\tlet indexAdjust: number = 0;\n\t\tlet index: number = 0;\n\n\t\t// Iterate through all of the parts\n\t\tfor (let i: number = 0; i < info.parts.length; i++) {\n\n\t\t\t// Set current match index\n\t\t\tindex = i + indexAdjust + 1;\n\n\t\t\tswitch (info.parts[i]) {\n\n\t\t\t\tcase \"yyyy\":\n\t\t\t\tcase \"YYYY\":\n\t\t\t\t\treg += \"([0-9]{4})\";\n\t\t\t\t\tparsedIndexes.year = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyy\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\t\treg += \"([0-9]{3})\";\n\t\t\t\t\tparsedIndexes.year3 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yy\":\n\t\t\t\tcase \"YY\":\n\t\t\t\t\treg += \"([0-9]{2})\";\n\t\t\t\t\tparsedIndexes.year2 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"y\":\n\t\t\t\tcase \"Y\":\n\t\t\t\t\treg += \"([0-9]{1})\";\n\t\t\t\t\tparsedIndexes.year1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMM\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._months()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.monthLong = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMM\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._shortMonths()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.monthShort = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MM\":\n\t\t\t\tcase \"M\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.month = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ww\":\n\t\t\t\tcase \"w\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.week = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dd\":\n\t\t\t\tcase \"d\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.day = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"DDD\":\n\t\t\t\tcase \"DD\":\n\t\t\t\tcase \"D\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.yearDay = index;\n\t\t\t\t\tbreak;\n\n\n\t\t\t\tcase \"dddd\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._weekdays()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.weekdayLong = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ddd\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._shortWeekdays()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.weekdayShort = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aaa\":\n\t\t\t\tcase \"aa\":\n\t\t\t\tcase \"a\":\n\t\t\t\t\t// TODO: fix (escape regex)\n\t\t\t\t\treg += \"(\" + this.getStringList([\"AM\", \"PM\", \"A\\.M\\.\", \"P\\.M\\.\", \"A\", \"P\"]).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.am = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"hh\":\n\t\t\t\tcase \"h\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hour12Base1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"HH\":\n\t\t\t\tcase \"H\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hourBase0 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"KK\":\n\t\t\t\tcase \"K\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hour12Base0 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"kk\":\n\t\t\t\tcase \"k\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hourBase1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"mm\":\n\t\t\t\tcase \"m\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.minute = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ss\":\n\t\t\t\tcase \"s\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.second = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"SSS\":\n\t\t\t\tcase \"SS\":\n\t\t\t\tcase \"S\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.millisecond = index;\n\t\t\t\t\tparsedIndexes.millisecondDigits = info.parts[i].length;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"nnn\":\n\t\t\t\tcase \"nn\":\n\t\t\t\tcase \"n\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.millisecond = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"x\":\n\t\t\t\t\treg += \"([0-9]{1,})\";\n\t\t\t\t\tparsedIndexes.timestamp = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Z\":\n\t\t\t\t\treg += \"GMT([-+]+[0-9]{2}:[0-9]{2})\";\n\t\t\t\t\tparsedIndexes.zone = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ZZ\":\n\t\t\t\t\treg += \"([\\\\-+]+[0-9]{2}[0-9]{2})\";\n\t\t\t\t\tparsedIndexes.zone = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"i\":\n\t\t\t\t\treg += \"([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\\\.?([0-9]{0,3})([zZ]|[+\\\\-][0-9]{2}:?[0-9]{2}|$)\";\n\t\t\t\t\tparsedIndexes.iso = index;\n\t\t\t\t\tindexAdjust += 7;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"G\":\n\t\t\t\tcase \"YYYY\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\tcase \"YY\":\n\t\t\t\tcase \"Y\":\n\t\t\t\tcase \"MMMMM\":\n\t\t\t\tcase \"W\":\n\t\t\t\tcase \"EEEEE\":\n\t\t\t\tcase \"EEEE\":\n\t\t\t\tcase \"EEE\":\n\t\t\t\tcase \"EE\":\n\t\t\t\tcase \"E\":\n\t\t\t\tcase \"eeeee\":\n\t\t\t\tcase \"eeee\":\n\t\t\t\tcase \"eee\":\n\t\t\t\tcase \"ee\":\n\t\t\t\tcase \"e\":\n\t\t\t\tcase \"zzzz\":\n\t\t\t\tcase \"zzz\":\n\t\t\t\tcase \"zz\":\n\t\t\t\tcase \"z\":\n\t\t\t\tcase \"t\":\n\t\t\t\t\t// Ignore\n\t\t\t\t\tindexAdjust--;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treg += \"[^0-9]*\";\n\t\t}\n\n\t\t// Try matching\n\t\tlet regex = new RegExp(reg);\n\t\tlet matches: RegExpMatchArray = source.match(regex);\n\n\t\tif (matches) {\n\t\t\t// Populate the date object\n\n\t\t\t// Full year\n\t\t\tif (parsedIndexes.year > -1) {\n\t\t\t\tresValues.year = parseInt(matches[parsedIndexes.year]);\n\t\t\t}\n\n\t\t\t// 3-digit year\n\t\t\tif (parsedIndexes.year3 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year3]);\n\t\t\t\tval += 1000;\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// 2-digit year\n\t\t\tif (parsedIndexes.year2 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year2]);\n\t\t\t\tif (val > 50) {\n\t\t\t\t\tval += 1000;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tval += 2000;\n\t\t\t\t}\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// 1-digit year\n\t\t\tif (parsedIndexes.year1 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year1]);\n\t\t\t\tval = Math.floor((new Date().getFullYear()) / 10) * 10 + val;\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// Full month\n\t\t\tif (parsedIndexes.monthLong > -1) {\n\t\t\t\tresValues.month = this.resolveMonth(<any>matches[parsedIndexes.monthLong]);\n\t\t\t}\n\n\t\t\t// Short month\n\t\t\tif (parsedIndexes.monthShort > -1) {\n\t\t\t\tresValues.month = this.resolveShortMonth(<any>matches[parsedIndexes.monthShort]);\n\t\t\t}\n\n\t\t\t// Numeric month\n\t\t\tif (parsedIndexes.month > -1) {\n\t\t\t\tresValues.month = parseInt(matches[parsedIndexes.month]) - 1;\n\t\t\t}\n\n\t\t\t// Weekday\n\t\t\t// @todo\n\n\t\t\t// Week\n\t\t\tif ((parsedIndexes.week > -1) && (parsedIndexes.day === -1)) {\n\t\t\t\t// We parse weeks ONLY if day is not explicitly set\n\t\t\t\t// TODO: this needs work\n\t\t\t\t// (but maybe later - I can hardly imagine anyone passing their dates in weeks)\n\t\t\t\tresValues.month = 0;\n\t\t\t\tresValues.day = $utils.getDayFromWeek(\n\t\t\t\t\tparseInt(matches[parsedIndexes.week]),\n\t\t\t\t\tresValues.year,\n\t\t\t\t\t1,\n\t\t\t\t\tutc\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Day\n\t\t\tif (parsedIndexes.day > -1) {\n\t\t\t\tresValues.day = parseInt(matches[parsedIndexes.day]);\n\t\t\t}\n\n\t\t\t// Year day\n\t\t\tif (parsedIndexes.yearDay > -1) {\n\t\t\t\tresValues.month = 0;\n\t\t\t\tresValues.day = parseInt(matches[parsedIndexes.yearDay]);\n\t\t\t}\n\n\t\t\t// 24 Hour (0-23)\n\t\t\tif (parsedIndexes.hourBase0 > -1) {\n\t\t\t\tresValues.hour = parseInt(matches[parsedIndexes.hourBase0]);\n\t\t\t}\n\n\t\t\t// 24 Hour (1-24)\n\t\t\tif (parsedIndexes.hourBase1 > -1) {\n\t\t\t\tresValues.hour = parseInt(matches[parsedIndexes.hourBase1]) - 1;\n\t\t\t}\n\n\t\t\t// 12 Hour (0-11)\n\t\t\tif (parsedIndexes.hour12Base0 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.hour12Base0]);\n\t\t\t\tif (val == 11) {\n\t\t\t\t\tval = 0;\n\t\t\t\t}\n\t\t\t\tif ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\n\t\t\t\t\tval += 12;\n\t\t\t\t}\n\t\t\t\tresValues.hour = val;\n\t\t\t}\n\n\t\t\t// 12 Hour (1-12)\n\t\t\tif (parsedIndexes.hour12Base1 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.hour12Base1]);\n\t\t\t\tif (val == 12) {\n\t\t\t\t\tval = 0;\n\t\t\t\t}\n\t\t\t\tif ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\n\t\t\t\t\tval += 12;\n\t\t\t\t}\n\t\t\t\tresValues.hour = val;\n\t\t\t}\n\n\t\t\t// Minute\n\t\t\tif (parsedIndexes.minute > -1) {\n\t\t\t\tresValues.minute = parseInt(matches[parsedIndexes.minute]);\n\t\t\t}\n\n\t\t\t// Second\n\t\t\tif (parsedIndexes.second > -1) {\n\t\t\t\tresValues.second = parseInt(matches[parsedIndexes.second]);\n\t\t\t}\n\n\t\t\t// Millisecond\n\t\t\tif (parsedIndexes.millisecond > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.millisecond]);\n\t\t\t\tif (parsedIndexes.millisecondDigits == 2) {\n\t\t\t\t\tval *= 10;\n\t\t\t\t}\n\t\t\t\telse if (parsedIndexes.millisecondDigits == 1) {\n\t\t\t\t\tval *= 100;\n\t\t\t\t}\n\t\t\t\tresValues.millisecond = val;\n\t\t\t}\n\n\t\t\t// Timestamp\n\t\t\tif (parsedIndexes.timestamp > -1) {\n\t\t\t\tresValues.timestamp = parseInt(matches[parsedIndexes.timestamp]);\n\n\t\t\t\tconst ts = new Date(resValues.timestamp);\n\t\t\t\tresValues.year = ts.getUTCFullYear();\n\t\t\t\tresValues.month = ts.getUTCMonth();\n\t\t\t\tresValues.day = ts.getUTCDate();\n\t\t\t\tresValues.hour = ts.getUTCHours();\n\t\t\t\tresValues.minute = ts.getUTCMinutes();\n\t\t\t\tresValues.second = ts.getUTCSeconds();\n\t\t\t\tresValues.millisecond = ts.getUTCMilliseconds();\n\t\t\t}\n\n\t\t\t// Adjust time zone\n\t\t\tif (parsedIndexes.zone > -1) {\n\t\t\t\tresValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.zone]);\n\t\t\t}\n\n\t\t\t// ISO\n\t\t\tif (parsedIndexes.iso > -1) {\n\n\t\t\t\tresValues.year = $type.toNumber(matches[parsedIndexes.iso + 0]);\n\t\t\t\tresValues.month = $type.toNumber(matches[parsedIndexes.iso + 1]) - 1;\n\t\t\t\tresValues.day = $type.toNumber(matches[parsedIndexes.iso + 2]);\n\t\t\t\tresValues.hour = $type.toNumber(matches[parsedIndexes.iso + 3]);\n\t\t\t\tresValues.minute = $type.toNumber(matches[parsedIndexes.iso + 4]);\n\t\t\t\tresValues.second = $type.toNumber(matches[parsedIndexes.iso + 5]);\n\t\t\t\tresValues.millisecond = $type.toNumber(matches[parsedIndexes.iso + 6]);\n\n\t\t\t\tif (matches[parsedIndexes.iso + 7] == \"Z\" || matches[parsedIndexes.iso + 7] == \"z\") {\n\t\t\t\t\tresValues.utc = true;\n\t\t\t\t}\n\t\t\t\telse if (matches[parsedIndexes.iso + 7] != \"\") {\n\t\t\t\t\tresValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.iso + 7]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create Date object\n\t\t\tif (resValues.utc) {\n\t\t\t\tres = new Date(Date.UTC(\n\t\t\t\t\tresValues.year,\n\t\t\t\t\tresValues.month,\n\t\t\t\t\tresValues.day,\n\t\t\t\t\tresValues.hour,\n\t\t\t\t\tresValues.minute,\n\t\t\t\t\tresValues.second,\n\t\t\t\t\tresValues.millisecond\n\t\t\t\t));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tres = new Date(\n\t\t\t\t\tresValues.year,\n\t\t\t\t\tresValues.month,\n\t\t\t\t\tresValues.day,\n\t\t\t\t\tresValues.hour,\n\t\t\t\t\tresValues.minute + resValues.offset,\n\t\t\t\t\tresValues.second,\n\t\t\t\t\tresValues.millisecond\n\t\t\t\t);\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\t// Didn't match anything\n\t\t\t// Let's try dropping it into Date constructor and hope for the best\n\t\t\tres = new Date(source);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected resolveTimezoneOffset(date: Date, zone: string): number {\n\t\tlet value = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/);\n\t\tif (value) {\n\t\t\tlet match = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/)!;\n\t\t\tlet dir = match[1];\n\t\t\tlet hour = match[2];\n\t\t\tlet minute = match[3];\n\t\t\tlet offset = parseInt(hour) * 60 + parseInt(minute);\n\n\t\t\t// Adjust offset\n\t\t\t// Making it negative does not seem to make sense, but it's right\n\t\t\t// because of how JavaScript calculates GMT offsets\n\t\t\tif (dir == \"+\") {\n\t\t\t\toffset *= -1;\n\t\t\t}\n\n\t\t\t// Check the difference in offset\n\t\t\tlet originalOffset = (date || new Date()).getTimezoneOffset();\n\t\t\tlet diff = offset - originalOffset;\n\t\t\treturn diff;\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Resolves month name (i.e. \"December\") into a month number (11).\n\t *\n\t * @param value  Month name\n\t * @return Month number\n\t */\n\tprotected resolveMonth(value: Months): number {\n\n\t\t// Let's try English first\n\t\tlet month: number = this._months().indexOf(value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Try the translation\n\t\tif (!this._root.language.isDefault()) {\n\t\t\tmonth = this._root.language.translateAll(this._months()).indexOf(value);\n\t\t\tif (month > -1) {\n\t\t\t\treturn month\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Resolves short month name (i.e. \"Dec\") into a month number.\n\t *\n\t * @param value  Short month name\n\t * @return Month number\n\t */\n\tprotected resolveShortMonth(value: ShortMonths): number {\n\n\t\t// Let's try English first\n\t\tlet month: number = this._shortMonths().indexOf(value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Maybe long month (workaround for May)\n\t\tmonth = this._months().indexOf(<any>value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Try the translation\n\t\tif (this._root.language && !this._root.language.isDefault()) {\n\t\t\tmonth = this._root.language.translateAll(this._shortMonths()).indexOf(value);\n\t\t\tif (month > -1) {\n\t\t\t\treturn month\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Checks if passed in string represents AM/PM notation in many of its\n\t * versions.\n\t *\n\t * @param value  Source string\n\t * @return Is it AM/PM?\n\t */\n\tprotected isAm(value: string): boolean {\n\t\tlet list = this.getStringList([\"AM\", \"A.M.\", \"A\"]);\n\t\treturn list.indexOf(value.toUpperCase()) > -1;\n\t}\n\n\t/**\n\t * Translates list of strings.\n\t *\n\t * @param list  Source strings\n\t * @return Translated strings\n\t */\n\tprotected getStringList(list: Array<keyof ILocaleSettings>): Array<string> {\n\t\tlet res: string[] = [];\n\t\tfor (let i: number = 0; i < list.length; i++) {\n\t\t\t// translate?\n\t\t\tif (this._root.language) {\n\t\t\t\tres.push($utils.escapeForRgex(this._t(list[i])));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tres.push($utils.escapeForRgex(list[i]));\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n}\n","import type { TimeUnit } from \"./Time\";\r\n\r\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\r\nimport { TextFormatter } from \"./TextFormatter\";\r\n\r\nimport * as $object from \"./Object\";\r\nimport * as $utils from \"./Utils\";\r\nimport * as $type from \"./Type\";\r\n\r\n\r\nexport interface IDurationFormatterSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A universal duration format to use wherever number needs to be formatted\r\n\t * as a duration.\r\n\t */\r\n\tdurationFormat?: string;\r\n\r\n\t/**\r\n\t * A base value. Any number below it will be considered \"negative\".\r\n\t *\r\n\t * @default 0\r\n\t */\r\n\tnegativeBase?: number;\r\n\r\n\t/**\r\n\t * Identifies what values are used in duration.\r\n\t *\r\n\t * Available options: `\"millisecond\"`, `\"second\"` (default), `\"minute\"`, `\"hour\"`, `\"day\"`, `\"week\"`, `\"month\"`, and `\"year\"`.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-durations/#Base_unit} for more info\r\n\t * @default \"second\"\r\n\t */\r\n\tbaseUnit?: TimeUnit;\r\n\r\n\t/**\r\n\t * Time unit dependent duration formats.\r\n\t *\r\n\t * Used be [[DurationAxis]].\r\n\t */\r\n\tdurationFormats?: Partial<Record<TimeUnit, Partial<Record<TimeUnit, string>>>>;\r\n\r\n\t/**\r\n\t * An array of data fields that hold duration values and should be formatted\r\n\t * with a [[DurationFormatter]].\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/data-placeholders/#Formatting_placeholders} for more info\r\n\t */\r\n\tdurationFields?: string[];\r\n\r\n}\r\n\r\nexport interface IDurationFormatterPrivate extends IEntityPrivate {\r\n}\r\n\r\n/**\r\n * A class used to format numberic values as time duration.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-durations/} for more info\r\n */\r\nexport class DurationFormatter extends Entity {\r\n\tdeclare public _settings: IDurationFormatterSettings;\r\n\tdeclare public _privateSettings: IDurationFormatterPrivate;\r\n\r\n\tprotected _setDefaults() {\r\n\t\tconst dmillisecond = \"_duration_millisecond\";\r\n\t\tconst dsecond = \"_duration_second\";\r\n\t\tconst dminute = \"_duration_minute\";\r\n\t\tconst dhour = \"_duration_hour\";\r\n\t\tconst dday = \"_duration_day\";\r\n\t\tconst dweek = \"_duration_week\";\r\n\t\tconst dmonth = \"_duration_month\";\r\n\t\tconst dyear = \"_duration_year\";\r\n\r\n\t\tconst asecond = \"_second\";\r\n\t\tconst aminute = \"_minute\";\r\n\t\tconst ahour = \"_hour\";\r\n\t\tconst aday = \"_day\";\r\n\t\tconst aweek = \"_week\";\r\n\t\tconst amonth = \"_week\";\r\n\t\tconst ayear = \"_year\";\r\n\r\n\t\t// Defaults\r\n\t\tthis._setDefault(\"negativeBase\", 0);\r\n\t\tthis._setDefault(\"baseUnit\", \"second\");\r\n\t\tthis._setDefault(\"durationFormats\", {\r\n\t\t\t\"millisecond\": {\r\n\t\t\t\t\"millisecond\": this._t(dmillisecond),\r\n\t\t\t\t\"second\": this._t((dmillisecond + asecond) as any),\r\n\t\t\t\t\"minute\": this._t((dmillisecond + aminute) as any),\r\n\t\t\t\t\"hour\": this._t((dmillisecond + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dmillisecond + aday) as any),\r\n\t\t\t\t\"week\": this._t((dmillisecond + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dmillisecond + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dmillisecond + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"second\": {\r\n\t\t\t\t\"second\": this._t((dsecond) as any),\r\n\t\t\t\t\"minute\": this._t((dsecond + aminute) as any),\r\n\t\t\t\t\"hour\": this._t((dsecond + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dsecond + aday) as any),\r\n\t\t\t\t\"week\": this._t((dsecond + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dsecond + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dsecond + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"minute\": {\r\n\t\t\t\t\"minute\": this._t((dminute) as any),\r\n\t\t\t\t\"hour\": this._t((dminute + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dminute + aday) as any),\r\n\t\t\t\t\"week\": this._t((dminute + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dminute + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dminute + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"hour\": {\r\n\t\t\t\t\"hour\": this._t((dhour) as any),\r\n\t\t\t\t\"day\": this._t((dhour + aday) as any),\r\n\t\t\t\t\"week\": this._t((dhour + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dhour + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dhour + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"day\": {\r\n\t\t\t\t\"day\": this._t((dday) as any),\r\n\t\t\t\t\"week\": this._t((dday + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dday + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dday + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"week\": {\r\n\t\t\t\t\"week\": this._t((dweek) as any),\r\n\t\t\t\t\"month\": this._t((dweek + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dweek + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"month\": {\r\n\t\t\t\t\"month\": this._t((dmonth) as any),\r\n\t\t\t\t\"year\": this._t((dmonth + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"year\": {\r\n\t\t\t\t\"year\": this._t(dyear)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsuper._setDefaults();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Collection of aliases for units.\r\n\t */\r\n\tprotected _unitAliases: { [index: string]: string } = {\r\n\t\t\"Y\": \"y\",\r\n\t\t\"D\": \"d\",\r\n\t\t\"H\": \"h\",\r\n\t\t\"K\": \"h\",\r\n\t\t\"k\": \"h\",\r\n\t\t\"n\": \"S\"\r\n\t};\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t}\r\n\r\n\t/**\r\n\t * Formats the number as duration.\r\n\t *\r\n\t * For example `1000` (base unit seconds) would be converted to `16:40` as in\r\n\t * 16 minutes and 40 seconds.\r\n\t *\r\n\t * @param value   Value to format\r\n\t * @param format  Format to apply\r\n\t * @param base    Override base unit\r\n\t * @return Formatted number\r\n\t */\r\n\tpublic format(value: number | string, format?: string, base?: TimeUnit): string {\r\n\r\n\t\t// no base unit?\r\n\t\tlet baseUnit = base || this.get(\"baseUnit\");\r\n\r\n\t\t// no format passed in or empty\r\n\t\tif (typeof format === \"undefined\" || format === \"\") {\r\n\t\t\tif (this.get(\"durationFormat\") != null) {\r\n\t\t\t\tformat = this.get(\"durationFormat\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tformat = this.getFormat($type.toNumber(value), undefined, baseUnit);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Clean format\r\n\t\tformat = $utils.cleanFormat(format!);\r\n\r\n\t\t// get format info (it will also deal with parser caching)\r\n\t\tlet info = this.parseFormat(format, baseUnit);\r\n\r\n\t\t// cast to number just in case\r\n\t\t// TODO: maybe use better casting\r\n\t\tlet source: number = Number(value);\r\n\r\n\t\t// format and replace the number\r\n\t\tlet details;\r\n\t\tif (source > this.get(\"negativeBase\")) {\r\n\t\t\tdetails = info.positive;\r\n\t\t}\r\n\t\telse if (source < this.get(\"negativeBase\")) {\r\n\t\t\tdetails = info.negative;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdetails = info.zero;\r\n\t\t}\r\n\r\n\r\n\t\t// Format\r\n\t\tlet formatted = this.applyFormat(source, details);\r\n\r\n\t\t// Apply color?\r\n\t\tif (details.color !== \"\") {\r\n\t\t\tformatted = \"[\" + details.color + \"]\" + formatted + \"[/]\";\r\n\t\t}\r\n\r\n\t\treturn formatted;\r\n\t}\r\n\r\n\t/**\r\n\t * Parses supplied format into structured object which can be used to format\r\n\t * the number.\r\n\t *\r\n\t * @param format  Format string, i.e. \"#,###.00\"\r\n\t * @param base    Override base unit\r\n\t * @return Parsed information\r\n\t */\r\n\tprotected parseFormat(format: string, base?: TimeUnit): any {\r\n\r\n\t\t// Check cache\r\n\t\t// TODO\r\n\t\t// let cached = this.getCache(format);\r\n\t\t// if (cached != null) {\r\n\t\t// \treturn cached;\r\n\t\t// }\r\n\r\n\t\t// no base unit?\r\n\t\tlet baseUnit = base || this.get(\"baseUnit\");\r\n\r\n\t\t// Initialize duration parsing info\r\n\t\tlet info = {\r\n\t\t\t\"positive\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t},\r\n\t\t\t\"negative\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t},\r\n\t\t\t\"zero\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Escape double vertical bars (that mean display one vertical bar)\r\n\t\tformat = format.replace(\"||\", $type.PLACEHOLDER2);\r\n\r\n\t\t// Split it up and deal with different formats\r\n\t\tlet parts = format.split(\"|\");\r\n\t\tinfo.positive.source = parts[0];\r\n\r\n\t\tif (typeof parts[2] === \"undefined\") {\r\n\t\t\tinfo.zero = info.positive;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinfo.zero.source = parts[2];\r\n\t\t}\r\n\r\n\t\tif (typeof parts[1] === \"undefined\") {\r\n\t\t\tinfo.negative = info.positive;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinfo.negative.source = parts[1];\r\n\t\t}\r\n\r\n\t\t// Parse each\r\n\t\t$object.each(info, (_part, item) => {\r\n\t\t\t// Already parsed\r\n\t\t\tif (item.parsed) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Check cached\r\n\t\t\t// TODO\r\n\t\t\t// if (typeof this.getCache(item.source) !== \"undefined\") {\r\n\t\t\t// \tinfo[part] = this.getCache(item.source);\r\n\t\t\t// \treturn;\r\n\t\t\t// }\r\n\r\n\t\t\t// Begin parsing\r\n\t\t\tlet partFormat: string = item.source;\r\n\r\n\t\t\t// Check for [] directives\r\n\t\t\tlet dirs: string[] | null = [];\r\n\t\t\tdirs = item.source.match(/^\\[([^\\]]*)\\]/);\r\n\t\t\tif (dirs && dirs.length && dirs[0] !== \"\") {\r\n\t\t\t\tpartFormat = item.source.substr(dirs[0].length);\r\n\t\t\t\titem.color = dirs[1];\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Let TextFormatter split into chunks\r\n\t\t\tlet chunks = TextFormatter.chunk(partFormat, true);\r\n\t\t\tfor (let i: number = 0; i < chunks.length; i++) {\r\n\t\t\t\tlet chunk = chunks[i];\r\n\r\n\t\t\t\t// replace back double vertical bar\r\n\t\t\t\tchunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\r\n\r\n\t\t\t\tif (chunk.type === \"value\") {\r\n\r\n\t\t\t\t\t// Just \"Duration\"?\r\n\t\t\t\t\t// if (chunk.text.toLowerCase() === \"duration\") {\r\n\t\t\t\t\t// \tchunk.text = durationFormat;\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\t// Check for \"a\" (absolute) modifier\r\n\t\t\t\t\tif (chunk.text.match(/[yYMdDwhHKkmsSn]+a/)) {\r\n\t\t\t\t\t\titem.absolute = true;\r\n\t\t\t\t\t\tchunk.text = chunk.text.replace(/([yYMdDwhHKkmsSn]+)a/, \"$1\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Find all possible parts\r\n\t\t\t\t\tlet matches = chunk.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);\r\n\r\n\t\t\t\t\tif (matches) {\r\n\t\t\t\t\t\t// Populate template\r\n\t\t\t\t\t\tfor (let x = 0; x < matches.length; x++) {\r\n\t\t\t\t\t\t\t// Is it an alias?\r\n\t\t\t\t\t\t\tif (matches[x] == null) {\r\n\t\t\t\t\t\t\t\tmatches[x] = this._unitAliases[matches[x]];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titem.parts.push(matches[x]);\r\n\t\t\t\t\t\t\tchunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Apply to template\r\n\t\t\t\titem.template += chunk.text;\r\n\t\t\t}\r\n\r\n\t\t\t// Apply style formatting\r\n\t\t\t//item.template = TextFormatter.format(item.template, this.outputFormat);\r\n\r\n\t\t\t// Save cache\r\n\t\t\t// TODO\r\n\t\t\t//this.setCache(item.source, item);\r\n\r\n\t\t\t// Mark this as parsed\r\n\t\t\titem.parsed = true;\r\n\t\t});\r\n\r\n\t\t// Save cache (the whole thing)\r\n\t\t// TODO\r\n\t\t//this.setCache(format, info);\r\n\r\n\t\treturn info;\r\n\t}\r\n\r\n\t/**\r\n\t * Applies parsed format to a numeric value.\r\n\t *\r\n\t * @param value    Value\r\n\t * @param details  Parsed format as returned by {parseFormat}\r\n\t * @return Formatted duration\r\n\t */\r\n\tprotected applyFormat(value: number, details: any): string {\r\n\r\n\t\t// Use absolute values\r\n\t\tlet negative = !details.absolute && (value < this.get(\"negativeBase\"));\r\n\t\tvalue = Math.abs(value);\r\n\r\n\r\n\t\t// Recalculate to milliseconds\r\n\t\tlet tstamp = this.toTimeStamp(value, details.baseUnit);\r\n\r\n\t\t// Init return value\r\n\t\tlet res = details.template;\r\n\t\tconst values: any  = {\r\n\t\t\tmillisecond: 0,\r\n\t\t\tsecond: 0,\r\n\t\t\tminute: 0,\r\n\t\t\thour: 0,\r\n\t\t\tday: 0,\r\n\t\t\tweek: 0,\r\n\t\t\tmonth: 0,\r\n\t\t\tyear: 0\r\n\t\t};\r\n\r\n\t\t// Iterate through duration parts\r\n\t\tfor (let i = 0, len = details.parts.length; i < len; i++) {\r\n\r\n\t\t\t// Gather the part\r\n\t\t\tlet part = details.parts[i];\r\n\t\t\tlet unit: any = this._toTimeUnit(part.substr(0, 1));\r\n\r\n\t\t\t// Calculate current unit value\r\n\t\t\tlet ints: number;\r\n\t\t\tconst unitValue = this._getUnitValue(unit!);\r\n\t\t\tif (i < (len -1)) {\r\n\t\t\t\tints = Math.floor(tstamp / unitValue);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tints = Math.round(tstamp / unitValue);\r\n\t\t\t}\r\n\r\n\t\t\tvalues[unit] += ints;\r\n\r\n\t\t\t// Reduce timestamp\r\n\t\t\ttstamp -= ints * unitValue;\r\n\t\t}\r\n\r\n\t\t// Check if we have full unit that we need to bump up to higher unit\r\n\t\t$object.each(values, (unit, value) => {\r\n\t\t\tif (unit == \"millisecond\" && value == 1000) {\r\n\t\t\t\tvalues[\"second\"]++;\r\n\t\t\t\tvalues[\"millisecond\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"second\" && value == 60) {\r\n\t\t\t\tvalues[\"minute\"]++;\r\n\t\t\t\tvalues[\"second\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"minute\" && value == 60) {\r\n\t\t\t\tvalues[\"hour\"]++;\r\n\t\t\t\tvalues[\"minute\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"hour\" && value == 24) {\r\n\t\t\t\tvalues[\"day\"]++;\r\n\t\t\t\tvalues[\"hour\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"day\" && value == 7 && details.parts.indexOf(\"w\") !== -1) {\r\n\t\t\t\tvalues[\"week\"]++;\r\n\t\t\t\tvalues[\"day\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"day\" && value == 30) {\r\n\t\t\t\tvalues[\"month\"]++;\r\n\t\t\t\tvalues[\"day\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"month\" && value == 12) {\r\n\t\t\t\tvalues[\"year\"]++;\r\n\t\t\t\tvalues[\"month\"] = 0;\r\n\t\t\t}\r\n\t\t\t// if (val > 0) {\r\n\t\t\t// \tres = res.replace($type.PLACEHOLDER, $utils.padString(val, 2, \"0\"));\r\n\t\t\t// }\r\n\t\t\t// else {\r\n\t\t\t// \tres = res.replace($type.PLACEHOLDER, \"\");\r\n\t\t\t// }\r\n\t\t});\r\n\r\n\t\t// Iterate again\r\n\t\tfor (let i = 0, len = details.parts.length; i < len; i++) {\r\n\t\t\t// Gather the part\r\n\t\t\tlet part = details.parts[i];\r\n\t\t\tlet unit: any = this._toTimeUnit(part.substr(0, 1));\r\n\t\t\tlet digits = part.length;\r\n\r\n\t\t\t// Calculate current unit value\r\n\t\t\tres = res.replace($type.PLACEHOLDER, $utils.padString(values[unit], digits, \"0\"));\r\n\t\t}\r\n\r\n\r\n\t\t// Reapply negative sign\r\n\t\tif (negative) {\r\n\t\t\tres = \"-\" + res;\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts numeric value to timestamp in milliseconds.\r\n\t *\r\n\t * @param value     A source value\r\n\t * @param baseUnit  Base unit the source value is in: \"q\", \"s\", \"i\", \"h\", \"d\", \"w\", \"m\", \"y\"\r\n\t * @return Value representation as a timestamp in milliseconds\r\n\t */\r\n\tpublic toTimeStamp(value: number, baseUnit: TimeUnit): number {\r\n\t\treturn value * this._getUnitValue(baseUnit);\r\n\t}\r\n\r\n\tprotected _toTimeUnit(code: string): TimeUnit | undefined {\r\n\t\tswitch (code) {\r\n\t\t\tcase \"S\":\r\n\t\t\t\treturn \"millisecond\";\r\n\t\t\tcase \"s\":\r\n\t\t\t\treturn \"second\";\r\n\t\t\tcase \"m\":\r\n\t\t\t\treturn \"minute\";\r\n\t\t\tcase \"h\":\r\n\t\t\t\treturn \"hour\";\r\n\t\t\tcase \"d\":\r\n\t\t\t\treturn \"day\";\r\n\t\t\tcase \"w\":\r\n\t\t\t\treturn \"week\";\r\n\t\t\tcase \"M\":\r\n\t\t\t\treturn \"month\";\r\n\t\t\tcase \"y\":\r\n\t\t\t\treturn \"year\";\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Returns appropriate default format for the value.\r\n\t *\r\n\t * If `maxValue` is sepcified, it will use that value to determine the time\r\n\t * unit for the format.\r\n\t *\r\n\t * For example if your `baseUnit` is `\"second\"` and you pass in `10`, you\r\n\t * will get `\"10\"`.\r\n\t *\r\n\t * However, you might want it to be formatted in the context of bigger scale,\r\n\t * say 10 minutes (600 seconds). If you pass in `600` as `maxValue`, all\r\n\t * values, including small ones will use format with minutes, e.g.:\r\n\t * `00:10`, `00:50`, `12: 30`, etc.\r\n\t *\r\n\t * @param value     Value to format\r\n\t * @param maxValue  Maximum value to be used to determine format\r\n\t * @param baseUnit  Base unit of the value\r\n\t * @return Format\r\n\t */\r\n\tpublic getFormat(value: number, maxValue?: number, baseUnit?: TimeUnit): string {\r\n\r\n\t\t// Is format override set?\r\n\t\tif (this.get(\"durationFormat\") != null) {\r\n\t\t\treturn this.get(\"durationFormat\")!;\r\n\t\t}\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\tif (maxValue != null && value != maxValue) {\r\n\t\t\tvalue = Math.abs(value);\r\n\t\t\tmaxValue = Math.abs(maxValue);\r\n\t\t\tlet maxUnit = this.getValueUnit(Math.max(value, maxValue), baseUnit);\r\n\t\t\treturn (<any>this.get(\"durationFormats\"))[baseUnit!][maxUnit!];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet unit = this.getValueUnit(value, baseUnit);\r\n\t\t\treturn (<any>this.get(\"durationFormats\"))[baseUnit!][unit!];\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns value's closest denominator time unit, e.g 100 seconds is\r\n\t * `\"minute\"`, while 59 seconds would still be `second`.\r\n\t *\r\n\t * @param value     Source duration value\r\n\t * @param baseUnit  Base unit\r\n\t * @return Denominator\r\n\t */\r\n\tpublic getValueUnit(value: number, baseUnit?: TimeUnit): TimeUnit | undefined {\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\t// Convert to milliseconds\r\n\t\tlet currentUnit: any;\r\n\t\tlet ms = this.getMilliseconds(value, baseUnit);\r\n\t\t$object.eachContinue(this._getUnitValues(), (key, val) => {\r\n\t\t\tif (key == baseUnit || currentUnit) {\r\n\t\t\t\tlet num = ms / val;\r\n\t\t\t\tif (num <= 1) {\r\n\t\t\t\t\tif (!currentUnit) {\r\n\t\t\t\t\t\tcurrentUnit = key;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tcurrentUnit = key;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\treturn currentUnit;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts value to milliseconds according to `baseUnit`.\r\n\t *\r\n\t * @param value     Source duration value\r\n\t * @param baseUnit  Base unit\r\n\t * @return Value in milliseconds\r\n\t */\r\n\tpublic getMilliseconds(value: number, baseUnit?: TimeUnit): number {\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\treturn value * this._getUnitValue(baseUnit!);\r\n\t}\r\n\r\n\tprotected _getUnitValue(timeUnit: TimeUnit): number {\r\n\t\treturn this._getUnitValues()[timeUnit];\r\n\t}\r\n\r\n\tprotected _getUnitValues(): any {\r\n\t\treturn {\r\n\t\t\t\"millisecond\": 1,\r\n\t\t\t\"second\": 1000,\r\n\t\t\t\"minute\": 60000,\r\n\t\t\t\"hour\": 3600000,\r\n\t\t\t\"day\": 86400000,\r\n\t\t\t\"week\": 604800000,\r\n\t\t\t\"month\": 2592000000,\r\n\t\t\t\"year\": 31536000000,\r\n\t\t};\r\n\t}\r\n\r\n}\r\n","/**\n * amCharts 5 locale\n * \n * Locale: en\n * Language: International English\n * Author: Martynas Majeris\n *\n * Follow instructions in [on this page](https://www.amcharts.com/docs/v5/tutorials/creating-translations/) to make corrections or add new translations.\n *\n * ---\n * Edit but leave the header section above this line. You can remove any\n * subsequent comment sections.\n * ---\n *\n * Use this file as a template to create translations. Leave the key part in\n * English intact. Fill the value with a translation.\n *\n * Empty string means no translation, so default \"International English\"\n * will be used.\n *\n * If you need the translation to literally be an empty string, use `null`\n * instead.\n *\n * IMPORTANT:\n * When translating make good effort to keep the translation length\n * at least the same chartcount as the English, especially for short prompts.\n *\n * Having significantly longer prompts may distort the actual charts.\n *\n * NOTE:\n * Some prompts - like months or weekdays - come in two versions: full and\n * shortened.\n *\n * If there's no official shortened version of these in your language, and it\n * would not be possible to invent such short versions that don't seem weird\n * to native speakers of that language, fill those with the same as full\n * version.\n *\n * PLACEHOLDERS:\n * Some prompts have placeholders like \"%1\". Those will be replaced by actual\n * values during translation and should be retained in the translated prompts.\n *\n * Placeholder positions may be changed to better suit structure of the\n * sentence.\n *\n * For example \"From %1 to %2\", when actually used will replace \"%1\" with an\n * actual value representing range start, and \"%2\" will be replaced by end\n * value.\n *\n * E.g. in a Scrollbar for Value axis \"From %1 to %2\" will become\n * \"From 100 to 200\". You may translate \"From\" and \"to\", as well as re-arrange\n * the order of the prompt itself, but make sure the \"%1\" and \"%2\" remain, in\n * places where they will make sense.\n *\n * Save the file as language_LOCALE, i.e. `en_GB.ts`, `fr_FR.ts`, etc.\n */\nexport default {\n\t\"firstDayOfWeek\": 1,\n\t\n\t// Number formatting options.\n\t// \n\t// Please check with the local standards which separator is accepted to be\n\t// used for separating decimals, and which for thousands.\n\t\"_decimalSeparator\": \".\",\n\t\"_thousandSeparator\": \",\",\n\n\t// Position of the percent sign in numbers\n\t\"_percentPrefix\": null,\n\t\"_percentSuffix\": \"%\",\n\n\t// Suffixes for numbers\n\t// When formatting numbers, big or small numers might be reformatted to\n\t// shorter version, by applying a suffix.\n\t// \n\t// For example, 1000000 might become \"1m\".\n\t// Or 1024 might become \"1KB\" if we're formatting byte numbers.\n\t// \n\t// This section defines such suffixes for all such cases.\n\t\"_big_number_suffix_3\": \"k\",\n\t\"_big_number_suffix_6\": \"M\",\n\t\"_big_number_suffix_9\": \"G\",\n\t\"_big_number_suffix_12\": \"T\",\n\t\"_big_number_suffix_15\": \"P\",\n\t\"_big_number_suffix_18\": \"E\",\n\t\"_big_number_suffix_21\": \"Z\",\n\t\"_big_number_suffix_24\": \"Y\",\n\n\t\"_small_number_suffix_3\": \"m\",\n\t\"_small_number_suffix_6\": \"\",\n\t\"_small_number_suffix_9\": \"n\",\n\t\"_small_number_suffix_12\": \"p\",\n\t\"_small_number_suffix_15\": \"f\",\n\t\"_small_number_suffix_18\": \"a\",\n\t\"_small_number_suffix_21\": \"z\",\n\t\"_small_number_suffix_24\": \"y\",\n\n\t\"_byte_suffix_B\": \"B\",\n\t\"_byte_suffix_KB\": \"KB\",\n\t\"_byte_suffix_MB\": \"MB\",\n\t\"_byte_suffix_GB\": \"GB\",\n\t\"_byte_suffix_TB\": \"TB\",\n\t\"_byte_suffix_PB\": \"PB\",\n\n\t// Default date formats for various periods.\n\t// \n\t// This should reflect official or de facto formatting universally accepted\n\t// in the country translation is being made for\n\t// Available format codes here:\n\t// https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#Format_codes\n\t// \n\t// This will be used when formatting date/time for particular granularity,\n\t// e.g. \"_date_hour\" will be shown whenever we need to show time as hours.\n\t// \n\t// \"date\" is used as in default date format when showing standalone dates.\n\t\"_date\": \"yyyy-MM-dd\",\n\t\"_date_millisecond\": \"mm:ss SSS\",\n\t\"_date_millisecond_full\": \"HH:mm:ss SSS\",\n\t\"_date_second\": \"HH:mm:ss\",\n\t\"_date_second_full\": \"HH:mm:ss\",\n\t\"_date_minute\": \"HH:mm\",\n\t\"_date_minute_full\": \"HH:mm - MMM dd, yyyy\",\n\t\"_date_hour\": \"HH:mm\",\n\t\"_date_hour_short\": \"HH\",\n\t\"_date_hour_full\": \"HH:mm - MMM dd, yyyy\",\n\t\"_date_day\": \"MMM dd\",\n\t\"_date_day_full\": \"MMM dd, yyyy\",\n\t\"_date_week\": \"ww\",\n\t\"_date_week_full\": \"MMM dd, yyyy\",\n\t\"_date_month\": \"MMM\",\n\t\"_date_month_full\": \"MMM, yyyy\",\n\t\"_date_year\": \"yyyy\",\n\n\t// Default duration formats for various base units.\n\t// \n\t// This will be used by DurationFormatter to format numeric values into\n\t// duration.\n\t// \n\t// Notice how each duration unit comes in several versions. This is to ensure\n\t// that each base unit is shown correctly.\n\t// \n\t// For example, if we have baseUnit set to \"second\", meaning our duration is\n\t// in seconds.\n\t// \n\t// If we pass in `50` to formatter, it will know that we have just 50 seconds\n\t// (less than a minute) so it will use format in `\"_duration_second\"` (\"ss\"),\n\t// and the formatted result will be in like `\"50\"`.\n\t// \n\t// If we pass in `70`, which is more than a minute, the formatter will switch\n\t// to `\"_duration_second_minute\"` (\"mm:ss\"), resulting in \"01:10\" formatted\n\t// text.\n\t// \n\t// Available codes here:\n\t// https://www.amcharts.com/docs/v4/concepts/formatters/formatting-duration/#Available_Codes\n\t\"_duration_millisecond\": \"SSS\",\n\t\"_duration_millisecond_second\": \"ss.SSS\",\n\t\"_duration_millisecond_minute\": \"mm:ss SSS\",\n\t\"_duration_millisecond_hour\": \"hh:mm:ss SSS\",\n\t\"_duration_millisecond_day\": \"d'd' mm:ss SSS\",\n\t\"_duration_millisecond_week\": \"d'd' mm:ss SSS\",\n\t\"_duration_millisecond_month\": \"M'm' dd'd' mm:ss SSS\",\n\t\"_duration_millisecond_year\": \"y'y' MM'm' dd'd' mm:ss SSS\",\n\n\t\"_duration_second\": \"ss\",\n\t\"_duration_second_minute\": \"mm:ss\",\n\t\"_duration_second_hour\": \"hh:mm:ss\",\n\t\"_duration_second_day\": \"d'd' hh:mm:ss\",\n\t\"_duration_second_week\": \"d'd' hh:mm:ss\",\n\t\"_duration_second_month\": \"M'm' dd'd' hh:mm:ss\",\n\t\"_duration_second_year\": \"y'y' MM'm' dd'd' hh:mm:ss\",\n\n\t\"_duration_minute\": \"mm\",\n\t\"_duration_minute_hour\": \"hh:mm\",\n\t\"_duration_minute_day\": \"d'd' hh:mm\",\n\t\"_duration_minute_week\": \"d'd' hh:mm\",\n\t\"_duration_minute_month\": \"M'm' dd'd' hh:mm\",\n\t\"_duration_minute_year\": \"y'y' MM'm' dd'd' hh:mm\",\n\n\t\"_duration_hour\": \"hh'h'\",\n\t\"_duration_hour_day\": \"d'd' hh'h'\",\n\t\"_duration_hour_week\": \"d'd' hh'h'\",\n\t\"_duration_hour_month\": \"M'm' dd'd' hh'h'\",\n\t\"_duration_hour_year\": \"y'y' MM'm' dd'd' hh'h'\",\n\n\t\"_duration_day\": \"d'd'\",\n\t\"_duration_day_week\": \"d'd'\",\n\t\"_duration_day_month\": \"M'm' dd'd'\",\n\t\"_duration_day_year\": \"y'y' MM'm' dd'd'\",\n\n\t\"_duration_week\": \"w'w'\",\n\t\"_duration_week_month\": \"w'w'\",\n\t\"_duration_week_year\": \"w'w'\",\n\n\t\"_duration_month\": \"M'm'\",\n\t\"_duration_month_year\": \"y'y' MM'm'\",\n\n\t\"_duration_year\": \"y'y'\",\n\n\t// Era translations\n\t\"_era_ad\": \"AD\",\n\t\"_era_bc\": \"BC\",\n\n\t// Day part, used in 12-hour formats, e.g. 5 P.M.\n\t// Please note that these come in 3 variants:\n\t// * one letter (e.g. \"A\")\n\t// * two letters (e.g. \"AM\")\n\t// * two letters with dots (e.g. \"A.M.\")\n\t// \n\t// All three need to to be translated even if they are all the same. Some\n\t// users might use one, some the other.\n\t\"A\": \"\",\n\t\"P\": \"\",\n\t\"AM\": \"\",\n\t\"PM\": \"\",\n\t\"A.M.\": \"\",\n\t\"P.M.\": \"\",\n\n\t// Date-related stuff.\n\t// \n\t// When translating months, if there's a difference, use the form which is\n\t// best for a full date, e.g. as you would use it in \"2018 January 1\".\n\t// \n\t// Note that May is listed twice. This is because in English May is the same\n\t// in both long and short forms, while in other languages it may not be the\n\t// case. Translate \"May\" to full word, while \"May(short)\" to shortened\n\t// version.\n\t// \n\t// Should month names and weekdays be capitalized or not?\n\t// \n\t// Rule of thumb is this: if the names should always be capitalized,\n\t// regardless of name position within date (\"January\", \"21st January 2018\",\n\t// etc.) use capitalized names. Otherwise enter all lowercase.\n\t// \n\t// The date formatter will automatically capitalize names if they are the\n\t// first (or only) word in resulting date.\n\t\"January\": \"\",\n\t\"February\": \"\",\n\t\"March\": \"\",\n\t\"April\": \"\",\n\t\"May\": \"\",\n\t\"June\": \"\",\n\t\"July\": \"\",\n\t\"August\": \"\",\n\t\"September\": \"\",\n\t\"October\": \"\",\n\t\"November\": \"\",\n\t\"December\": \"\",\n\t\"Jan\": \"\",\n\t\"Feb\": \"\",\n\t\"Mar\": \"\",\n\t\"Apr\": \"\",\n\t\"May(short)\": \"May\",\n\t\"Jun\": \"\",\n\t\"Jul\": \"\",\n\t\"Aug\": \"\",\n\t\"Sep\": \"\",\n\t\"Oct\": \"\",\n\t\"Nov\": \"\",\n\t\"Dec\": \"\",\n\n\t// Weekdays.\n\t\"Sunday\": \"\",\n\t\"Monday\": \"\",\n\t\"Tuesday\": \"\",\n\t\"Wednesday\": \"\",\n\t\"Thursday\": \"\",\n\t\"Friday\": \"\",\n\t\"Saturday\": \"\",\n\t\"Sun\": \"\",\n\t\"Mon\": \"\",\n\t\"Tue\": \"\",\n\t\"Wed\": \"\",\n\t\"Thu\": \"\",\n\t\"Fri\": \"\",\n\t\"Sat\": \"\",\n\n\t// Date ordinal function.\n\t// \n\t// This is used when adding number ordinal when formatting days in dates.\n\t// \n\t// E.g. \"January 1st\", \"February 2nd\".\n\t// \n\t// The function accepts day number, and returns a string to be added to the\n\t// day, like in default English translation, if we pass in 2, we will receive\n\t// \"nd\" back.\n\t\"_dateOrd\": function(day: number): string {\n\t\tlet res = \"th\";\n\t\tif ((day < 11) || (day > 13)) {\n\t\t\tswitch (day % 10) {\n\t\t\t\tcase 1:\n\t\t\t\t\tres = \"st\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tres = \"nd\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tres = \"rd\"\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\n\t// Various chart controls.\n\t// Shown as a tooltip on zoom out button.\n\t\"Zoom Out\": \"\",\n\n\t// Timeline buttons\n\t\"Play\": \"\",\n\t\"Stop\": \"\",\n\n\t// Chart's Legend screen reader title.\n\t\"Legend\": \"\",\n\n\t// Legend's item screen reader indicator.\n\t\"Press ENTER to toggle\": \"\",\n\n\t// Shown when the chart is busy loading something.\n\t\"Loading\": \"\",\n\n\t// Shown as the first button in the breadcrumb navigation, e.g.:\n\t// Home > First level > ...\n\t\"Home\": \"\",\n\n\t// Chart types.\n\t// Those are used as default screen reader titles for the main chart element\n\t// unless developer has set some more descriptive title.\n\t\"Chart\": \"\",\n\t\"Serial chart\": \"\",\n\t\"X/Y chart\": \"\",\n\t\"Pie chart\": \"\",\n\t\"Gauge chart\": \"\",\n\t\"Radar chart\": \"\",\n\t\"Sankey diagram\": \"\",\n\t\"Flow diagram\": \"\",\n\t\"Chord diagram\": \"\",\n\t\"TreeMap chart\": \"\",\n\t\"Force directed tree\": \"\",\n\t\"Sliced chart\": \"\",\n\n\t// Series types.\n\t// Used to name series by type for screen readers if they do not have their\n\t// name set.\n\t\"Series\": \"\",\n\t\"Candlestick Series\": \"\",\n\t\"OHLC Series\": \"\",\n\t\"Column Series\": \"\",\n\t\"Line Series\": \"\",\n\t\"Pie Slice Series\": \"\",\n\t\"Funnel Series\": \"\",\n\t\"Pyramid Series\": \"\",\n\t\"X/Y Series\": \"\",\n\n\t// Map-related stuff.\n\t\"Map\": \"\",\n\t\"Press ENTER to zoom in\": \"\",\n\t\"Press ENTER to zoom out\": \"\",\n\t\"Use arrow keys to zoom in and out\": \"\",\n\t\"Use plus and minus keys on your keyboard to zoom in and out\": \"\",\n\n\t// Export-related stuff.\n\t// These prompts are used in Export menu labels.\n\t// \n\t// \"Export\" is the top-level menu item.\n\t// \n\t// \"Image\", \"Data\", \"Print\" as second-level indicating type of export\n\t// operation.\n\t// \n\t// Leave actual format untranslated, unless you absolutely know that they\n\t// would convey more meaning in some other way.\n\t\"Export\": \"\",\n\t\"Image\": \"\",\n\t\"Data\": \"\",\n\t\"Print\": \"\",\n\t\"Press ENTER or use arrow keys to navigate\": \"\",\n\t\"Press ENTER to open\": \"\",\n\t\"Press ENTER to print.\": \"\",\n\t\"Press ENTER to export as %1.\": \"\",\n\t\"(Press ESC to close this message)\": \"\",\n\t\"Image Export Complete\": \"\",\n\t\"Export operation took longer than expected. Something might have gone wrong.\": \"\",\n\t\"Saved from\": \"\",\n\t\"PNG\": \"\",\n\t\"JPG\": \"\",\n\t\"GIF\": \"\",\n\t\"SVG\": \"\",\n\t\"PDF\": \"\",\n\t\"JSON\": \"\",\n\t\"CSV\": \"\",\n\t\"XLSX\": \"\",\n\t\"HTML\": \"\",\n\n\t// Scrollbar-related stuff.\n\t// \n\t// Scrollbar is a control which can zoom and pan the axes on the chart.\n\t// \n\t// Each scrollbar has two grips: left or right (for horizontal scrollbar) or\n\t// upper and lower (for vertical one).\n\t// \n\t// Prompts change in relation to whether Scrollbar is vertical or horizontal.\n\t// \n\t// The final section is used to indicate the current range of selection.\n\t\"Use TAB to select grip buttons or left and right arrows to change selection\": \"\",\n\t\"Use left and right arrows to move selection\": \"\",\n\t\"Use left and right arrows to move left selection\": \"\",\n\t\"Use left and right arrows to move right selection\": \"\",\n\t\"Use TAB select grip buttons or up and down arrows to change selection\": \"\",\n\t\"Use up and down arrows to move selection\": \"\",\n\t\"Use up and down arrows to move lower selection\": \"\",\n\t\"Use up and down arrows to move upper selection\": \"\",\n\t\"From %1 to %2\": \"\",\n\t\"From %1\": \"\",\n\t\"To %1\": \"\",\n\n\t// Data loader-related.\n\t\"No parser available for file: %1\": \"\",\n\t\"Error parsing file: %1\": \"\",\n\t\"Unable to load file: %1\": \"\",\n\t\"Invalid date\": \"\",\n\n\t// Common actions\n\t\"Close\": \"\",\n\t\"Minimize\": \"\",\n\t\"Confirm\": \"\"\n\n};","import { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport * as $array from \"./Array\"\nimport * as $object from \"./Object\"\nimport en from \"../../../locales/en\";\n\n/**\n * Defines properties that exist for the locale.\n *\n * @ignore\n */\nexport interface ILocaleSettings {\n\t\"firstDayOfWeek\"?: number,\n\n\t// number formatter related\n\t\"_decimalSeparator\"?: string;\n\t\"_thousandSeparator\"?: string;\n\n\t\"_percentPrefix\"?: string | null;\n\t\"_percentSuffix\"?: string | null;\n\n\t\"_big_number_suffix_3\"?: string;\n\t\"_big_number_suffix_6\"?: string;\n\t\"_big_number_suffix_9\"?: string;\n\t\"_big_number_suffix_12\"?: string;\n\t\"_big_number_suffix_15\"?: string;\n\t\"_big_number_suffix_18\"?: string;\n\t\"_big_number_suffix_21\"?: string;\n\t\"_big_number_suffix_24\"?: string;\n\n\t\"_small_number_suffix_24\"?: string;\n\t\"_small_number_suffix_21\"?: string;\n\t\"_small_number_suffix_18\"?: string;\n\t\"_small_number_suffix_15\"?: string;\n\t\"_small_number_suffix_12\"?: string;\n\t\"_small_number_suffix_9\"?: string;\n\t\"_small_number_suffix_6\"?: string;\n\t\"_small_number_suffix_3\"?: string;\n\n\t\"_byte_suffix_B\"?: string;\n\t\"_byte_suffix_KB\"?: string;\n\t\"_byte_suffix_MB\"?: string;\n\t\"_byte_suffix_GB\"?: string;\n\t\"_byte_suffix_TB\"?: string;\n\t\"_byte_suffix_PB\"?: string;\n\n\t// Default date formats for various periods\n\t\"_date\"?: string;\n\t\"_date_millisecond\"?: string;\n\t\"_date_millisecond_full\"?: string;\n\t\"_date_second\"?: string;\n\t\"_date_second_full\"?: string;\n\t\"_date_minute\"?: string;\n\t\"_date_minute_full\"?: string;\n\t\"_date_hour\"?: string;\n\t\"_date_hour_short\"?: string;\n\t\"_date_hour_full\"?: string;\n\t\"_date_day\"?: string;\n\t\"_date_day_full\"?: string;\n\t\"_date_week\"?: string;\n\t\"_date_week_full\"?: string;\n\t\"_date_month\"?: string;\n\t\"_date_month_full\"?: string;\n\t\"_date_year\"?: string;\n\n\t// Default duration formats for various base units\n\t\"_duration_millisecond\"?: string;\n\t\"_duration_millisecond_second\"?: string;\n\t\"_duration_millisecond_minute\"?: string;\n\t\"_duration_millisecond_hour\"?: string;\n\t\"_duration_millisecond_day\"?: string;\n\t\"_duration_millisecond_week\"?: string;\n\t\"_duration_millisecond_month\"?: string;\n\t\"_duration_millisecond_year\"?: string;\n\n\t\"_duration_second\"?: string;\n\t\"_duration_second_minute\"?: string;\n\t\"_duration_second_hour\"?: string;\n\t\"_duration_second_day\"?: string;\n\t\"_duration_second_week\"?: string;\n\t\"_duration_second_month\"?: string;\n\t\"_duration_second_year\"?: string;\n\n\t\"_duration_minute\"?: string;\n\t\"_duration_minute_hour\"?: string;\n\t\"_duration_minute_day\"?: string;\n\t\"_duration_minute_week\"?: string;\n\t\"_duration_minute_month\"?: string;\n\t\"_duration_minute_year\"?: string;\n\n\t\"_duration_hour\"?: string;\n\t\"_duration_hour_day\"?: string;\n\t\"_duration_hour_week\"?: string;\n\t\"_duration_hour_month\"?: string;\n\t\"_duration_hour_year\"?: string;\n\n\t\"_duration_day\"?: string;\n\t\"_duration_day_week\"?: string;\n\t\"_duration_day_month\"?: string;\n\t\"_duration_day_year\"?: string;\n\n\t\"_duration_week\"?: string;\n\t\"_duration_week_month\"?: string;\n\t\"_duration_week_year\"?: string;\n\n\t\"_duration_month\"?: string;\n\t\"_duration_month_year\"?: string;\n\n\t\"_duration_year\"?: string;\n\n\t// Era\n\t\"_era_ad\"?: string;\n\t\"_era_bc\"?: string;\n\n\t// Period\n\t\"A\"?: string;\n\t\"P\"?: string;\n\t\"AM\"?: string;\n\t\"PM\"?: string;\n\t\"A.M.\"?: string;\n\t\"P.M.\"?: string;\n\n\t// Dates\n\t\"January\"?: string;\n\t\"February\"?: string;\n\t\"March\"?: string;\n\t\"April\"?: string;\n\t\"May\"?: string;\n\t\"June\"?: string;\n\t\"July\"?: string;\n\t\"August\"?: string;\n\t\"September\"?: string;\n\t\"October\"?: string;\n\t\"November\"?: string;\n\t\"December\"?: string;\n\t\"Jan\"?: string;\n\t\"Feb\"?: string;\n\t\"Mar\"?: string;\n\t\"Apr\"?: string;\n\t\"May(short)\"?: string;\n\t\"Jun\"?: string;\n\t\"Jul\"?: string;\n\t\"Aug\"?: string;\n\t\"Sep\"?: string;\n\t\"Oct\"?: string;\n\t\"Nov\"?: string;\n\t\"Dec\"?: string;\n\t\"Sunday\"?: string;\n\t\"Monday\"?: string;\n\t\"Tuesday\"?: string;\n\t\"Wednesday\"?: string;\n\t\"Thursday\"?: string;\n\t\"Friday\"?: string;\n\t\"Saturday\"?: string;\n\t\"Sun\"?: string;\n\t\"Mon\"?: string;\n\t\"Tue\"?: string;\n\t\"Wed\"?: string;\n\t\"Thu\"?: string;\n\t\"Fri\"?: string;\n\t\"Sat\"?: string;\n\n\t// Chart elements\n\t\"Zoom Out\"?: string;\n\t\"Play\"?: string;\n\t\"Stop\"?: string;\n\t\"Legend\"?: string;\n\t\"Press ENTER to toggle\"?: string;\n\t\"Loading\"?: string;\n\t\"%1 shown\"?: string;\n\t\"%1 hidden\"?: string;\n\n\t// Chart types\n\t\"Chart\"?: string;\n\t\"Serial chart\"?: string;\n\t\"X/Y chart\"?: string;\n\t\"Pie chart\"?: string;\n\t\"Sunburst chart\"?: string;\n\t\"Gauge chart\"?: string;\n\t\"Radar chart\"?: string;\n\t\"Sankey diagram\"?: string;\n\t\"Flow diagram\"?: string;\n\t\"Chord diagram\"?: string;\n\t\"TreeMap chart\"?: string;\n\t\"Force directed tree\"?: string;\n\t\"Sliced chart\"?: string;\n\n\t// Series types\n\t\"Series\"?: string;\n\t\"Candlestick Series\"?: string;\n\t\"OHLC Series\"?: string;\n\t\"Column Series\"?: string;\n\t\"Line Series\"?: string;\n\t\"Pie Slice Series\"?: string;\n\t\"Funnel Series\"?: string;\n\t\"Pyramid Series\"?: string;\n\t\"X/Y Series\"?: string;\n\n\t// Map-related\n\t\"Map\"?: string;\n\t\"Press ENTER to zoom in\"?: string;\n\t\"Press ENTER to zoom out\"?: string;\n\t\"Use arrow keys to zoom in and out\"?: string;\n\t\"Use plus and minus keys on your keyboard to zoom in and out\"?: string;\n\t\"Home\"?: string;\n\t\"Zoom level changed to %1\"?: string;\n\n\t// Export-related\n\t\"Export\"?: string;\n\t\"Image\"?: string;\n\t\"Data\"?: string;\n\t\"Print\"?: string;\n\t\"Press ENTER or use arrow keys to navigate\"?: string;\n\t\"Press ENTER to open\"?: string;\n\t\"Press ENTER to print.\"?: string;\n\t\"Press ENTER to export as %1.\"?: string;\n\t\"(Press ESC to close this message)\"?: string;\n\t\"Image Export Complete\"?: string;\n\t\"Export operation took longer than expected. Something might have gone wrong.\"?: string;\n\t\"Saved from\"?: string;\n\t\"PNG\"?: string;\n\t\"JPG\"?: string;\n\t\"GIF\"?: string;\n\t\"SVG\"?: string;\n\t\"PDF\"?: string;\n\t\"JSON\"?: string;\n\t\"CSV\"?: string;\n\t\"XLSX\"?: string;\n\t\"HTML\"?: string;\n\n\t// Scrollbar-related\n\t\"Use TAB to select grip buttons or left and right arrows to change selection\"?: string;\n\t\"Use left and right arrows to move selection\"?: string;\n\t\"Use left and right arrows to move left selection\"?: string;\n\t\"Use left and right arrows to move right selection\"?: string;\n\t\"Use TAB select grip buttons or up and down arrows to change selection\"?: string;\n\t\"Use up and down arrows to move selection\"?: string;\n\t\"Use up and down arrows to move lower selection\"?: string;\n\t\"Use up and down arrows to move upper selection\"?: string;\n\t\"From %1 to %2\"?: string;\n\t\"From %1\"?: string;\n\t\"To %1\"?: string;\n\n\t// Data loader-related\n\t\"No parser available for file: %1\"?: string;\n\t\"Error parsing file: %1\"?: string;\n\t\"Unable to load file: %1\"?: string;\n\t\"Invalid date\"?: string;\n\n\t// Common actions\n\t\"Close\"?: string;\n\t\"Minimize\"?: string;\n\t\"Confirm\"?: string;\n\n\t\"Venn Series\"?: string;\n\t\"Venn Diagram\"?: string;\n\n}\n\n/**\n * Defines functions that exist for the locale.\n *\n * @ignore\n */\nexport interface ILocaleFunctions {\n\t// ordinal function\n\t\"_dateOrd\": (day: number) => string;\n}\n\n/**\n * Defines all of the defaults for locale properties.\n * @ignore\n */\nexport interface ILocaleDefault extends ILocaleSettings, ILocaleFunctions { }\n\n/**\n * Defines locale interface.\n *\n * @ignore\n */\nexport interface ILocale extends Partial<ILocaleDefault> { };\n\nexport interface ILanguageSettings extends IEntitySettings {\n}\n\nexport interface ILanguagePrivate extends IEntityPrivate {\n\n\t/**\n\t * A locale for International English (default).\n\t */\n\tdefaultLocale: ILocale;\n\n}\n\n/**\n * Add localization functionality.\n */\nexport class Language extends Entity {\n\tdeclare public _settings: ILanguageSettings;\n\tdeclare public _privateSettings: ILanguagePrivate;\n\n\tprotected _setDefaults() {\n\t\tthis.setPrivate(\"defaultLocale\", en);\n\t\tsuper._setDefaults();\n\t}\n\n\t/**\n\t * Returns a prompt translation.\n\t * \n\t * @param   prompt   Prompt to translate\n\t * @param   locale   Target locale\n\t * @param   ...rest  Parameters\n\t * @return           Translation\n\t */\n\tpublic translate<Key extends keyof ILocaleSettings>(prompt: Key, locale?: ILocale, ...rest: Array<string>): string {\n\n\t\t// Get langauge\n\t\tif (!locale) {\n\t\t\tlocale = this._root.locale || this.getPrivate(\"defaultLocale\");\n\t\t}\n\n\t\t// Init translation\n\t\tlet translation: string = prompt;\n\t\tlet value = locale[prompt];\n\n\t\t// Try to look for the translation\n\t\tif (value === null) {\n\t\t\ttranslation = \"\";\n\t\t}\n\t\telse if (value != null) {\n\t\t\t// It might be an empty string\n\t\t\tif (value) {\n\t\t\t\ttranslation = <string>value!;\n\t\t\t}\n\t\t}\n\t\telse if (locale !== this.getPrivate(\"defaultLocale\")) {\n\t\t\t// Try to look in default language\n\t\t\treturn this.translate(prompt, this.getPrivate(\"defaultLocale\"), ...rest);\n\t\t}\n\n\t\t// Replace %1, %2, etc params\n\t\tif (rest.length) {\n\t\t\tfor (let len = rest.length, i = 0; i < len; ++i) {\n\t\t\t\ttranslation = translation.split(\"%\" + (i + 1)).join(rest[i]);\n\t\t\t}\n\t\t}\n\n\t\t// Return the translation\n\t\treturn translation;\n\t}\n\n\t/**\n\t * Returns a prompt translation, including custom prompts.\n\t * \n\t * @param   prompt   Prompt to translate\n\t * @param   locale   Target locale\n\t * @param   ...rest  Parameters\n\t * @return           Translation\n\t */\n\tpublic translateAny(prompt: string, locale?: ILocale, ...rest: Array<string>): string {\n\t\treturn this.translate(<any>prompt, locale, ...rest);\n\t}\n\n\t/**\n\t * Add a custom prompt to locale.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\n\t * @param  prompt       Source prompt\n\t * @param  translation  Tanslation\n\t * @param  locale       Target locale\n\t */\n\tpublic setTranslationAny(prompt: string, translation: string, locale?: ILocale): void {\n\t\tconst localeTarget = locale || this._root.locale;\n\t\t(<any>localeTarget)[prompt] = translation;\n\t}\n\n\t/**\n\t * Add a batch of custom prompts.\n\t *\n\t * @since 5.3.3\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\n\t * @param  translations  Translations\n\t * @param  locale        Target locale\n\t */\n\tpublic setTranslationsAny(translations: { [index: string]: any }, locale?: ILocale): void {\n\t\t$object.each(translations, (key, val) => {\n\t\t\tthis.setTranslationAny(key as string, val, locale);\n\t\t});\n\t}\n\n\tpublic translateEmpty<Key extends keyof ILocaleSettings>(prompt: Key, locale?: ILocale, ...rest: Array<string>): string {\n\t\tlet translation = this.translate(prompt, locale, ...rest);\n\t\treturn translation == prompt ? \"\" : translation;\n\t}\n\n\tpublic translateFunc<Key extends keyof ILocaleFunctions>(prompt: Key, locale?: ILocale): ILocaleFunctions[Key] {\n\n\t\tif ((<any>this._root.locale)[prompt]) {\n\t\t\treturn (<any>this._root.locale)[prompt];\n\t\t}\n\n\t\t// Try to look in default language\n\t\tif (locale !== this.getPrivate(\"defaultLocale\")) {\n\t\t\treturn this.translateFunc(prompt, this.getPrivate(\"defaultLocale\"));\n\t\t}\n\n\t\t// Fail - return empty function\n\t\treturn (): string => {\n\t\t\treturn \"\";\n\t\t};\n\t}\n\n\t/**\n\t * Translates a btach of prompts.\n\t * \n\t * @param  list    Array of prompts to translate\n\t * @param  locale  Target locale\n\t * @return         Array of translations\n\t */\n\tpublic translateAll<Key extends keyof ILocaleSettings>(list: Array<Key>, locale?: ILocale): Array<string> {\n\t\t// Translate all items in the list\n\t\tif (!this.isDefault()) {\n\t\t\treturn $array.map(list, (x) => this.translate(x, locale));\n\n\t\t} else {\n\t\t\treturn list;\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if the currently selected locale is a default locale.\n\t *\n\t * @return `true` if locale is default; `false` if it is not.\n\t */\n\tpublic isDefault(): boolean {\n\t\treturn this.getPrivate(\"defaultLocale\") === this._root.locale;\n\t}\n\n}\n","/**\n * Modified from Pixi:\n *\n * The MIT License\n *\n * Copyright (c) 2013-2017 Mathew Groves, Chad Engler\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport type { IPoint } from \"./IPoint\";\n\n/**\n * @ignore\n */\nexport class Matrix {\n\tpublic a: number;\n\tpublic b: number;\n\tpublic c: number;\n\tpublic d: number;\n\tpublic tx: number;\n\tpublic ty: number;\n\n\tconstructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\t\tthis.d = d;\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t}\n\n\t/**\n\t * Sets the matrix based on all the available properties\n\t */\n\tsetTransform(x: number, y: number, pivotX: number, pivotY: number, rotation: number, scale: number = 1): void {\n\t\tthis.a = Math.cos(rotation) * scale;\n\t\tthis.b = Math.sin(rotation) * scale;\n\t\tthis.c = -Math.sin(rotation) * scale;\n\t\tthis.d = Math.cos(rotation) * scale;\n\t\tthis.tx = x - ((pivotX * this.a) + (pivotY * this.c));\n\t\tthis.ty = y - ((pivotX * this.b) + (pivotY * this.d));\n\t}\n\n\t/**\n\t * Get a new position with the current transformation applied.\n\t * Can be used to go from a child's coordinate space to the world coordinate space. (e.g. rendering)\n\t */\n\tapply(origin: IPoint): IPoint {\n\t\treturn {\n\t\t\tx: (this.a * origin.x) + (this.c * origin.y) + this.tx,\n\t\t\ty: (this.b * origin.x) + (this.d * origin.y) + this.ty\n\t\t};\n\t}\n\n\t/**\n\t * Get a new position with the inverse of the current transformation applied.\n\t * Can be used to go from the world coordinate space to a child's coordinate space. (e.g. input)\n\t */\n\tapplyInverse(origin: IPoint): IPoint {\n\t\tconst id = 1 / ((this.a * this.d) + (this.c * -this.b));\n\n\t\treturn {\n\t\t\tx: (this.d * id * origin.x) + (-this.c * id * origin.y) + (((this.ty * this.c) - (this.tx * this.d)) * id),\n\t\t\ty: (this.a * id * origin.y) + (-this.b * id * origin.x) + (((-this.ty * this.a) + (this.tx * this.b)) * id)\n\t\t};\n\t}\n\n\t/**\n\t * Appends the given Matrix to this Matrix.\n\t */\n\tappend(matrix: Matrix): void {\n\t\tconst a1 = this.a;\n\t\tconst b1 = this.b;\n\t\tconst c1 = this.c;\n\t\tconst d1 = this.d;\n\t\tthis.a = (matrix.a * a1) + (matrix.b * c1);\n\t\tthis.b = (matrix.a * b1) + (matrix.b * d1);\n\t\tthis.c = (matrix.c * a1) + (matrix.d * c1);\n\t\tthis.d = (matrix.c * b1) + (matrix.d * d1);\n\t\tthis.tx = (matrix.tx * a1) + (matrix.ty * c1) + this.tx;\n\t\tthis.ty = (matrix.tx * b1) + (matrix.ty * d1) + this.ty;\n\t}\n\n\t/**\n\t * Prepends the given Matrix to this Matrix.\n\t */\n\tprepend(matrix: Matrix): void {\n\t\tconst tx1 = this.tx;\n\t\tif (matrix.a !== 1 || matrix.b !== 0 || matrix.c !== 0 || matrix.d !== 1) {\n\t\t\tconst a1 = this.a;\n\t\t\tconst c1 = this.c;\n\t\t\tthis.a = (a1 * matrix.a) + (this.b * matrix.c);\n\t\t\tthis.b = (a1 * matrix.b) + (this.b * matrix.d);\n\t\t\tthis.c = (c1 * matrix.a) + (this.d * matrix.c);\n\t\t\tthis.d = (c1 * matrix.b) + (this.d * matrix.d);\n\t\t}\n\t\tthis.tx = (tx1 * matrix.a) + (this.ty * matrix.c) + matrix.tx;\n\t\tthis.ty = (tx1 * matrix.b) + (this.ty * matrix.d) + matrix.ty;\n\t}\n\n\t/**\n\t * Copies the other matrix's properties into this matrix\n\t */\n\tcopyFrom(matrix: Matrix): void {\n\t\tthis.a = matrix.a;\n\t\tthis.b = matrix.b;\n\t\tthis.c = matrix.c;\n\t\tthis.d = matrix.d;\n\t\tthis.tx = matrix.tx;\n\t\tthis.ty = matrix.ty;\n\t}\n}\n\n","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar TAU = Math.PI * 2;\n\nvar mapToEllipse = function mapToEllipse(_ref, rx, ry, cosphi, sinphi, centerx, centery) {\n  var x = _ref.x,\n      y = _ref.y;\n\n  x *= rx;\n  y *= ry;\n\n  var xp = cosphi * x - sinphi * y;\n  var yp = sinphi * x + cosphi * y;\n\n  return {\n    x: xp + centerx,\n    y: yp + centery\n  };\n};\n\nvar approxUnitArc = function approxUnitArc(ang1, ang2) {\n  // If 90 degree circular arc, use a constant\n  // as derived from http://spencermortensen.com/articles/bezier-circle\n  var a = ang2 === 1.5707963267948966 ? 0.551915024494 : ang2 === -1.5707963267948966 ? -0.551915024494 : 4 / 3 * Math.tan(ang2 / 4);\n\n  var x1 = Math.cos(ang1);\n  var y1 = Math.sin(ang1);\n  var x2 = Math.cos(ang1 + ang2);\n  var y2 = Math.sin(ang1 + ang2);\n\n  return [{\n    x: x1 - y1 * a,\n    y: y1 + x1 * a\n  }, {\n    x: x2 + y2 * a,\n    y: y2 - x2 * a\n  }, {\n    x: x2,\n    y: y2\n  }];\n};\n\nvar vectorAngle = function vectorAngle(ux, uy, vx, vy) {\n  var sign = ux * vy - uy * vx < 0 ? -1 : 1;\n\n  var dot = ux * vx + uy * vy;\n\n  if (dot > 1) {\n    dot = 1;\n  }\n\n  if (dot < -1) {\n    dot = -1;\n  }\n\n  return sign * Math.acos(dot);\n};\n\nvar getArcCenter = function getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp) {\n  var rxsq = Math.pow(rx, 2);\n  var rysq = Math.pow(ry, 2);\n  var pxpsq = Math.pow(pxp, 2);\n  var pypsq = Math.pow(pyp, 2);\n\n  var radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n\n  if (radicant < 0) {\n    radicant = 0;\n  }\n\n  radicant /= rxsq * pypsq + rysq * pxpsq;\n  radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n\n  var centerxp = radicant * rx / ry * pyp;\n  var centeryp = radicant * -ry / rx * pxp;\n\n  var centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n  var centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n\n  var vx1 = (pxp - centerxp) / rx;\n  var vy1 = (pyp - centeryp) / ry;\n  var vx2 = (-pxp - centerxp) / rx;\n  var vy2 = (-pyp - centeryp) / ry;\n\n  var ang1 = vectorAngle(1, 0, vx1, vy1);\n  var ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n\n  if (sweepFlag === 0 && ang2 > 0) {\n    ang2 -= TAU;\n  }\n\n  if (sweepFlag === 1 && ang2 < 0) {\n    ang2 += TAU;\n  }\n\n  return [centerx, centery, ang1, ang2];\n};\n\nvar arcToBezier = function arcToBezier(_ref2) {\n  var px = _ref2.px,\n      py = _ref2.py,\n      cx = _ref2.cx,\n      cy = _ref2.cy,\n      rx = _ref2.rx,\n      ry = _ref2.ry,\n      _ref2$xAxisRotation = _ref2.xAxisRotation,\n      xAxisRotation = _ref2$xAxisRotation === undefined ? 0 : _ref2$xAxisRotation,\n      _ref2$largeArcFlag = _ref2.largeArcFlag,\n      largeArcFlag = _ref2$largeArcFlag === undefined ? 0 : _ref2$largeArcFlag,\n      _ref2$sweepFlag = _ref2.sweepFlag,\n      sweepFlag = _ref2$sweepFlag === undefined ? 0 : _ref2$sweepFlag;\n\n  var curves = [];\n\n  if (rx === 0 || ry === 0) {\n    return [];\n  }\n\n  var sinphi = Math.sin(xAxisRotation * TAU / 360);\n  var cosphi = Math.cos(xAxisRotation * TAU / 360);\n\n  var pxp = cosphi * (px - cx) / 2 + sinphi * (py - cy) / 2;\n  var pyp = -sinphi * (px - cx) / 2 + cosphi * (py - cy) / 2;\n\n  if (pxp === 0 && pyp === 0) {\n    return [];\n  }\n\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n\n  var lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n\n  var _getArcCenter = getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp),\n      _getArcCenter2 = _slicedToArray(_getArcCenter, 4),\n      centerx = _getArcCenter2[0],\n      centery = _getArcCenter2[1],\n      ang1 = _getArcCenter2[2],\n      ang2 = _getArcCenter2[3];\n\n  // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n  // 1.0000000001. This causes `segments` to be greater than one, which is an\n  // unecessary split, and adds extra points to the bezier curve. To alleviate\n  // this issue, we round to 1.0 when the ratio is close to 1.0.\n\n\n  var ratio = Math.abs(ang2) / (TAU / 4);\n  if (Math.abs(1.0 - ratio) < 0.0000001) {\n    ratio = 1.0;\n  }\n\n  var segments = Math.max(Math.ceil(ratio), 1);\n\n  ang2 /= segments;\n\n  for (var i = 0; i < segments; i++) {\n    curves.push(approxUnitArc(ang1, ang2));\n    ang1 += ang2;\n  }\n\n  return curves.map(function (curve) {\n    var _mapToEllipse = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery),\n        x1 = _mapToEllipse.x,\n        y1 = _mapToEllipse.y;\n\n    var _mapToEllipse2 = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery),\n        x2 = _mapToEllipse2.x,\n        y2 = _mapToEllipse2.y;\n\n    var _mapToEllipse3 = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery),\n        x = _mapToEllipse3.x,\n        y = _mapToEllipse3.y;\n\n    return { x1: x1, y1: y1, x2: x2, y2: y2, x: x, y: y };\n  });\n};\n\nexport default arcToBezier;","/** @ignore *//** */\n\nimport {\n\tIRenderer, IContainer, IDisplayObject, IGraphics, IRendererEvents, IMargin,\n\tIText, ITextStyle, IRadialText, IPicture, IRendererEvent, ILayer, ICanvasOptions, BlendMode, IPointerEvent, Id\n} from \"./Renderer\";\nimport type { IBounds } from \"../../util/IBounds\";\nimport type { IPoint } from \"../../util/IPoint\";\nimport { Color } from \"../../util/Color\";\nimport { Matrix } from \"../../util/Matrix\";\nimport { Percent, percent } from \"../../util/Percent\";\n//import { Throttler } from \"../../util/Throttler\";\nimport { ArrayDisposer, Disposer, DisposerClass, IDisposer, CounterDisposer, MultiDisposer } from \"../../util/Disposer\";\nimport { TextFormatter, ITextChunk } from \"../../util/TextFormatter\";\nimport * as $utils from \"../../util/Utils\";\nimport * as $array from \"../../util/Array\";\nimport * as $object from \"../../util/Object\";\nimport * as $type from \"../../util/Type\";\nimport * as $math from \"../../util/Math\";\nimport arcToBezier from 'svg-arc-to-cubic-bezier';\n\n\n/**\n * @ignore\n */\nfunction checkArgs(name: string, actual: number, expected: number) {\n\tif (actual !== expected) {\n\t\tthrow new Error(\"Required \" + expected + \" arguments for \" + name + \" but got \" + actual);\n\t}\n}\n\n/**\n * @ignore\n */\nfunction checkMinArgs(name: string, actual: number, expected: number) {\n\tif (actual < expected) {\n\t\tthrow new Error(\"Required at least \" + expected + \" arguments for \" + name + \" but got \" + actual);\n\t}\n}\n\n/**\n * @ignore\n */\nfunction checkEvenArgs(name: string, actual: number, expected: number) {\n\tcheckMinArgs(name, actual, expected);\n\n\tif ((actual % expected) !== 0) {\n\t\tthrow new Error(\"Arguments for \" + name + \" must be in pairs of \" + expected);\n\t}\n}\n\n/**\n * @ignore\n * This splits the flag so that way 0017 will be processed as 0 0 17\n *\n * This is important for weird paths like `M17 5A1 1 0 0017 30 1 1 0 0017 5`\n */\nfunction splitArcFlags(args: Array<string>) {\n\tfor (let i = 0; i < args.length; i += 7) {\n\t\tlet index = i + 3;\n\t\tlet flag = args[index];\n\n\t\tif (flag.length > 1) {\n\t\t\tconst a = /^([01])([01])(.*)$/.exec(flag);\n\n\t\t\tif (a !== null) {\n\t\t\t\targs.splice(index, 0, a[1]);\n\t\t\t\t++index;\n\n\t\t\t\targs.splice(index, 0, a[2]);\n\t\t\t\t++index;\n\n\t\t\t\tif (a[3].length > 0) {\n\t\t\t\t\targs[index] = a[3];\n\n\t\t\t\t} else {\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t++index;\n\n\t\tflag = args[index];\n\n\t\tif (flag.length > 1) {\n\t\t\tconst a = /^([01])(.+)$/.exec(flag);\n\n\t\t\tif (a !== null) {\n\t\t\t\targs.splice(index, 0, a[1]);\n\t\t\t\t++index;\n\n\t\t\t\targs[index] = a[2];\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nfunction assertBinary(value: number): 0 | 1 {\n\tif (value === 0 || value === 1) {\n\t\treturn value;\n\n\t} else {\n\t\tthrow new Error(\"Flag must be 0 or 1\");\n\t}\n}\n\n//  1 -> 0xffffff * (2 / 2)\n//  2 -> 0xffffff * (1 / 2)\n//\n//  3 -> 0xffffff * (3 / 4)\n//  4 -> 0xffffff * (1 / 4)\n//\n//  5 -> 0xffffff * (7 / 8)\n//  6 -> 0xffffff * (5 / 8)\n//  7 -> 0xffffff * (3 / 8)\n//  8 -> 0xffffff * (1 / 8)\n//\n//  9 -> 0xffffff * (15 / 16)\n// 10 -> 0xffffff * (13 / 16)\n// 11 -> 0xffffff * (11 / 16)\n// 12 -> 0xffffff *  (9 / 16)\n// 13 -> 0xffffff *  (7 / 16)\n// 14 -> 0xffffff *  (5 / 16)\n// 15 -> 0xffffff *  (3 / 16)\n// 16 -> 0xffffff *  (1 / 16)\n// @todo remove this old color distribution algo if the new one pans out\n/*function distributeId(id: number): number {\n\tif (id === 1) {\n\t\treturn 0x000001;\n\n\t} else {\n\t\t// Finds the closest power of 2\n\t\tconst base = Math.pow(2, Math.ceil(Math.log(id) / Math.log(2)));\n\n\t\t// Translates the id into an odd fraction index\n\t\tconst index = ((base - id) * 2) + 1;\n\n\t\t// TODO is Math.round correct ?\n\t\treturn Math.round(0xffffff * (index / base));\n\t}\n}*/\n\n/**\n * Function by smeans:\n * https://lowcode.life/generating-unique-contrasting-colors-in-javascript/\n * @ignore\n */\nfunction distributeId(id: number): number {\n\tconst rgb = [0, 0, 0];\n\n\tfor (let i = 0; i < 24; i++) {\n\t\trgb[i % 3] <<= 1;\n\t\trgb[i % 3] |= id & 0x01;\n\t\tid >>= 1;\n\t}\n\n\treturn (rgb[0] | 0) + (rgb[1] << 8) + (rgb[2] << 16);\n}\n\n/**\n * @ignore\n */\nfunction eachTargets(hitTarget: CanvasDisplayObject, f: (target: CanvasDisplayObject) => boolean): void {\n\tfor (; ;) {\n\t\tif (hitTarget.interactive) {\n\t\t\tif (!f(hitTarget)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (hitTarget._parent) {\n\t\t\thitTarget = hitTarget._parent;\n\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\n// TODO feature detection for mouse/touch/pointer\n/**\n * @ignore\n */\nfunction onPointerEvent(element: EventTarget, name: string, f: (event: Array<IPointerEvent>, target: Node | null) => void): IDisposer {\n\treturn $utils.addEventListener(element, $utils.getRendererEvent(name), (event: MouseEvent | TouchEvent) => {\n\t\tconst target = $utils.getEventTarget(event);\n\n\t\tlet touches = (<any>event).touches;\n\t\tif (touches) {\n\t\t\tif (touches.length == 0) {\n\t\t\t\ttouches = (<any>event).changedTouches;\n\t\t\t}\n\n\t\t\tf($array.copy(<TouchList>touches), target);\n\n\t\t} else {\n\t\t\tf([<MouseEvent>event], target);\n\t\t}\n\t});\n}\n\n/**\n * @ignore\n */\nfunction isTainted(image: HTMLImageElement): boolean {\n\tconst canvas = document.createElement(\"canvas\");\n\tcanvas.width = 1;\n\tcanvas.height = 1;\n\tconst context = canvas.getContext(\"2d\", { willReadFrequently: true })! as CanvasRenderingContext2D;\n\tcontext.drawImage(image, 0, 0, 1, 1);\n\n\ttry {\n\t\tcontext.getImageData(0, 0, 1, 1);\n\t\treturn false;\n\t}\n\tcatch (err) {\n\t\tconsole.warn(\"Image \\\"\" + image.src + \"\\\" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors\");\n\t\treturn true;\n\t}\n}\n\n/**\n * This is needed to workaround a bug in iOS which causes it to not GC canvas elements.\n *\n * @ignore\n */\nfunction clearCanvas(view: HTMLCanvasElement) {\n\tview.width = 0;\n\tview.height = 0;\n\tview.style.width = \"0px\";\n\tview.style.height = \"0px\";\n}\n\n\n/**\n * Aligns the coordinate to the pixel, so it renders crisp\n *\n * @ignore\n */\nfunction crisp(x: number): number {\n\treturn Math.floor(x) + .5;\n}\n\n/**\n * @ignore\n */\nexport class CanvasPivot implements IPoint {\n\tprotected _x: number = 0;\n\tprotected _y: number = 0;\n\n\tget x(): number {\n\t\treturn this._x;\n\t}\n\n\tget y(): number {\n\t\treturn this._y;\n\t}\n\n\tset x(value: number) {\n\t\tthis._x = value;\n\t}\n\n\tset y(value: number) {\n\t\tthis._y = value;\n\t}\n}\n\n\ninterface IStatus {\n\tlayer: CanvasLayer;\n\tinactive: boolean | null;\n}\n\n/**\n * @ignore\n */\nexport class CanvasDisplayObject extends DisposerClass implements IDisplayObject, IDisposer {\n\tpublic _layer?: CanvasLayer;\n\n\tpublic mask: CanvasGraphics | null = null;\n\tpublic visible: boolean = true;\n\tpublic exportable?: boolean = true;\n\tpublic interactive: boolean = false;\n\tpublic inactive: boolean | null = null;\n\tpublic wheelable: boolean = false;\n\tpublic cancelTouch: boolean = false;\n\tpublic isMeasured: boolean = false;\n\tpublic buttonMode: boolean = false;\n\tpublic alpha: number = 1;\n\tpublic compoundAlpha: number = 1;\n\tpublic angle: number = 0;\n\tpublic scale: number = 1;\n\tpublic x: number = 0;\n\tpublic y: number = 0;\n\tpublic crisp: boolean = false;\n\tpublic pivot: CanvasPivot = new CanvasPivot();\n\n\tpublic filter?: string;\n\n\tpublic cursorOverStyle?: string;\n\tpublic _replacedCursorStyle?: string;\n\n\tpublic _localMatrix: Matrix = new Matrix();\n\tpublic _matrix: Matrix = new Matrix();\n\t// TODO can this be replaced with _localMatrix ?\n\tprotected _uMatrix: Matrix = new Matrix();\n\n\tpublic _renderer: CanvasRenderer;\n\tpublic _parent: CanvasContainer | undefined;\n\n\tprotected _localBounds: IBounds | undefined;\n\tprotected _bounds: IBounds | undefined;\n\tpublic _colorId: string | undefined;\n\n\tconstructor(renderer: CanvasRenderer) {\n\t\tsuper();\n\t\tthis._renderer = renderer;\n\t}\n\n\tprotected subStatus(status: IStatus): IStatus {\n\t\treturn {\n\t\t\tinactive: (this.inactive == null ? status.inactive : this.inactive),\n\t\t\tlayer: this._layer || status.layer,\n\t\t};\n\t}\n\n\tprotected _dispose(): void {\n\t\tthis._renderer._removeObject(this);\n\t\tthis.getLayer().dirty = true;\n\t}\n\n\tpublic getCanvas(): HTMLCanvasElement {\n\t\treturn this.getLayer().view;\n\t}\n\n\tpublic getLayer(): CanvasLayer {\n\t\tlet self: CanvasDisplayObject = this;\n\n\t\tfor (; ;) {\n\t\t\tif (self._layer) {\n\t\t\t\treturn self._layer;\n\n\t\t\t} else if (self._parent) {\n\t\t\t\tself = self._parent;\n\n\t\t\t} else {\n\t\t\t\treturn this._renderer.defaultLayer;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic setLayer(order: number | undefined, margin: IMargin | undefined): void {\n\t\tif (order == null) {\n\t\t\tthis._layer = undefined;\n\n\t\t} else {\n\t\t\tconst visible = true;\n\t\t\tthis._layer = this._renderer.getLayer(order, visible);\n\t\t\tthis._layer.visible = visible;\n\t\t\tthis._layer.margin = margin;\n\t\t\tif (margin) {\n\t\t\t\t$utils.setInteractive(this._layer.view, false);\n\t\t\t}\n\n\t\t\tthis._renderer._ghostLayer.setMargin(this._renderer.layers);\n\n\t\t\tif (this._parent) {\n\t\t\t\tthis._parent.registerChildLayer(this._layer);\n\t\t\t}\n\n\t\t\tthis._layer.dirty = true;\n\t\t\tthis._renderer.resizeLayer(this._layer);\n\t\t\tthis._renderer.resizeGhost();\n\t\t}\n\t}\n\n\tpublic markDirtyLayer(): void {\n\t\tthis.getLayer().dirty = true;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.invalidateBounds();\n\t}\n\n\tpublic invalidateBounds(): void {\n\t\tthis._localBounds = undefined;\n\t}\n\n\tpublic _addBounds(_bounds: IBounds): void { }\n\n\tprotected _getColorId(): string {\n\t\tif (this._colorId === undefined) {\n\t\t\tthis._colorId = this._renderer.paintId(this);\n\t\t}\n\n\t\treturn this._colorId;\n\t}\n\n\tprotected _isInteractive(status: IStatus): boolean {\n\t\treturn !status.inactive && (this.interactive || this._renderer._forceInteractive > 0);\n\t}\n\n\tprotected _isInteractiveMask(status: IStatus): boolean {\n\t\treturn this._isInteractive(status);\n\t}\n\n\tpublic contains(child: CanvasDisplayObject): boolean {\n\t\tfor (; ;) {\n\t\t\tif (child === this) {\n\t\t\t\treturn true;\n\n\t\t\t} else if (child._parent) {\n\t\t\t\tchild = child._parent;\n\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoGlobal(point: IPoint): IPoint {\n\t\treturn this._matrix.apply(point);\n\t}\n\n\ttoLocal(point: IPoint): IPoint {\n\t\treturn this._matrix.applyInverse(point);\n\t}\n\n\tpublic getLocalMatrix(): Matrix {\n\t\tthis._uMatrix.setTransform(0, 0, this.pivot.x, this.pivot.y, this.angle * Math.PI / 180, this.scale);\n\t\treturn this._uMatrix;\n\t}\n\n\tgetLocalBounds(): IBounds {\n\t\tif (!this._localBounds) {\n\n\t\t\tconst bn = 10000000;\n\t\t\tthis._localBounds = {\n\t\t\t\tleft: bn,\n\t\t\t\ttop: bn,\n\t\t\t\tright: -bn,\n\t\t\t\tbottom: -bn\n\t\t\t};\n\n\t\t\tthis._addBounds(this._localBounds);\n\t\t}\n\t\treturn this._localBounds;\n\t}\n\n\tgetAdjustedBounds(bounds: IBounds): IBounds {\n\t\tthis._setMatrix();\n\n\t\tconst matrix = this.getLocalMatrix();\n\n\t\tconst p0 = matrix.apply({ x: bounds.left, y: bounds.top });\n\t\tconst p1 = matrix.apply({ x: bounds.right, y: bounds.top });\n\t\tconst p2 = matrix.apply({ x: bounds.right, y: bounds.bottom });\n\t\tconst p3 = matrix.apply({ x: bounds.left, y: bounds.bottom });\n\n\t\treturn {\n\t\t\tleft: Math.min(p0.x, p1.x, p2.x, p3.x),\n\t\t\ttop: Math.min(p0.y, p1.y, p2.y, p3.y),\n\t\t\tright: Math.max(p0.x, p1.x, p2.x, p3.x),\n\t\t\tbottom: Math.max(p0.y, p1.y, p2.y, p3.y)\n\t\t}\n\t}\n\n\ton<C, Key extends keyof IRendererEvents>(key: Key, callback: (this: C, event: IRendererEvents[Key]) => void, context?: C): IDisposer {\n\t\tif (this.interactive) {\n\t\t\treturn this._renderer._addEvent(this, key, callback, context);\n\n\t\t} else {\n\t\t\treturn new Disposer(() => { });\n\t\t}\n\t}\n\n\tpublic _setMatrix(): void {\n\t\t// TODO only calculate this if it has actually changed\n\t\tthis._localMatrix.setTransform(\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.pivot.x,\n\t\t\tthis.pivot.y,\n\t\t\t// Converts degrees to radians\n\t\t\tthis.angle * Math.PI / 180,\n\t\t\tthis.scale\n\t\t);\n\n\t\tthis._matrix.copyFrom(this._localMatrix);\n\n\t\tif (this._parent) {\n\t\t\t// TODO only calculate this if it has actually changed\n\t\t\tthis._matrix.prepend(this._parent._matrix);\n\t\t}\n\t}\n\n\tpublic _transform(context: CanvasRenderingContext2D, resolution: number): void {\n\t\tconst m = this._matrix;\n\t\tlet tx = m.tx * resolution;\n\t\tlet ty = m.ty * resolution;\n\t\tif (this.crisp) {\n\t\t\ttx = crisp(tx);\n\t\t\tty = crisp(ty);\n\t\t}\n\n\t\tcontext.setTransform(\n\t\t\tm.a * resolution,\n\t\t\tm.b * resolution,\n\t\t\tm.c * resolution,\n\t\t\tm.d * resolution,\n\t\t\ttx,\n\t\t\tty)\n\n\t}\n\n\tpublic _transformMargin(context: CanvasRenderingContext2D, resolution: number, margin: IMargin): void {\n\t\tconst m = this._matrix;\n\t\tcontext.setTransform(\n\t\t\tm.a * resolution,\n\t\t\tm.b * resolution,\n\t\t\tm.c * resolution,\n\t\t\tm.d * resolution,\n\t\t\t(m.tx + margin.left) * resolution,\n\t\t\t(m.ty + margin.top) * resolution\n\t\t);\n\t}\n\n\tpublic _transformLayer(context: CanvasRenderingContext2D, resolution: number, layer: CanvasLayer): void {\n\t\tif (layer.margin) {\n\t\t\tthis._transformMargin(context, layer.scale || resolution, layer.margin);\n\n\t\t} else {\n\t\t\tthis._transform(context, layer.scale || resolution);\n\t\t}\n\t}\n\n\tpublic render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tif (this.visible && (this.exportable !== false || !this._renderer._omitTainted)) {\n\t\t\tthis._setMatrix();\n\n\t\t\tconst subStatus = this.subStatus(status);\n\n\t\t\tconst resolution = this._renderer.resolution;\n\n\t\t\tconst layers = this._renderer.layers;\n\t\t\tconst ghostLayer = this._renderer._ghostLayer;\n\t\t\tconst ghostContext = ghostLayer.context;\n\n\t\t\tconst mask = this.mask;\n\t\t\tif (mask) {\n\t\t\t\tmask._setMatrix();\n\t\t\t}\n\n\t\t\t// TODO improve this\n\t\t\t$array.each(layers, (layer) => {\n\t\t\t\tif (layer) {\n\t\t\t\t\tconst context = layer.context;\n\t\t\t\t\tcontext.save();\n\n\t\t\t\t\t// We must apply the mask before we transform the element\n\t\t\t\t\tif (mask) {\n\t\t\t\t\t\tmask._transformLayer(context, resolution, layer);\n\t\t\t\t\t\tmask._runPath(context);\n\t\t\t\t\t\tcontext.clip();\n\t\t\t\t\t}\n\n\t\t\t\t\tcontext.globalAlpha = this.compoundAlpha * this.alpha;\n\n\t\t\t\t\tthis._transformLayer(context, resolution, layer);\n\n\t\t\t\t\tif (this.filter) {\n\t\t\t\t\t\tcontext.filter = this.filter;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tghostContext.save();\n\n\t\t\t// We must apply the mask before we transform the element\n\t\t\tif (mask && this._isInteractiveMask(subStatus)) {\n\t\t\t\tmask._transformMargin(ghostContext, resolution, ghostLayer.margin);\n\t\t\t\tmask._runPath(ghostContext);\n\t\t\t\tghostContext.clip();\n\t\t\t}\n\n\t\t\tthis._transformMargin(ghostContext, resolution, ghostLayer.margin);\n\t\t\tif ((subStatus.layer.order > 0) && !targetGhostLayer) {\n\t\t\t\t$array.move(this._renderer._deferredGhostLayers, subStatus.layer.order);\n\t\t\t}\n\t\t\tthis._render(subStatus, targetGhostLayer);\n\n\t\t\tghostContext.restore();\n\n\t\t\t$array.each(layers, (layer) => {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.context.restore();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected _render(status: IStatus, _targetGhostLayer: number = 0): void {\n\t\tif (this.exportable === false) {\n\t\t\tstatus.layer.tainted = true;\n\t\t}\n\t}\n\n\tprotected _ghostOnly(targetGhostLayer: number = 0): boolean {\n\t\treturn targetGhostLayer > 0 ? true : false;\n\t}\n\n\tprotected _drawGhost(status: IStatus, targetGhostLayer: number = 0): boolean {\n\t\tconst interactive = this._isInteractive(status);\n\t\tconst order = status.layer.order || 0;\n\t\treturn interactive && ((order == 0 && !this._ghostOnly(targetGhostLayer)) || order == targetGhostLayer) ? true : false;\n\t}\n\n\thovering(): boolean {\n\t\treturn this._renderer._hovering.has(this);\n\t}\n\n\tdragging(): boolean {\n\t\treturn this._renderer._dragging.some((x) => x.value === this);\n\t}\n\n\n\tpublic shouldCancelTouch(): boolean {\n\t\tconst renderer = this._renderer;\n\t\tif (renderer.tapToActivate && !renderer._touchActive) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.cancelTouch) {\n\t\t\treturn true;\n\t\t}\n\t\telse if (this._parent) {\n\t\t\treturn this._parent.shouldCancelTouch();\n\t\t}\n\t\treturn false;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasContainer extends CanvasDisplayObject implements IContainer {\n\tpublic interactiveChildren: boolean = true;\n\tprivate _childLayers?: CanvasLayer[];\n\n\tprotected _children: Array<CanvasDisplayObject> = [];\n\n\tprotected _isInteractiveMask(status: IStatus): boolean {\n\t\treturn this.interactiveChildren || super._isInteractiveMask(status);\n\t}\n\n\taddChild(child: CanvasDisplayObject): void {\n\t\tchild._parent = this;\n\t\tthis._children.push(child);\n\t\tif (child._layer) {\n\t\t\tthis.registerChildLayer(child._layer);\n\t\t}\n\t}\n\n\taddChildAt(child: CanvasDisplayObject, index: number): void {\n\t\tchild._parent = this;\n\t\tthis._children.splice(index, 0, child);\n\t\tif (child._layer) {\n\t\t\tthis.registerChildLayer(child._layer);\n\t\t}\n\t}\n\n\tremoveChild(child: CanvasDisplayObject): void {\n\t\tchild._parent = undefined;\n\t\t$array.removeFirst(this._children, child);\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number): void {\n\t\tsuper._render(status);\n\n\t\tconst renderer = this._renderer;\n\n\t\tif (this.interactive && this.interactiveChildren) {\n\t\t\t++renderer._forceInteractive;\n\t\t}\n\n\t\t$array.each(this._children, (child) => {\n\t\t\tchild.compoundAlpha = this.compoundAlpha * this.alpha;\n\t\t\tchild.render(status, targetGhostLayer);\n\t\t});\n\n\t\tif (this.interactive && this.interactiveChildren) {\n\t\t\t--renderer._forceInteractive;\n\t\t}\n\t}\n\n\tregisterChildLayer(layer: CanvasLayer): void {\n\t\tif (!this._childLayers) {\n\t\t\tthis._childLayers = [];\n\t\t}\n\t\t$array.pushOne(this._childLayers, layer);\n\t\tif (this._parent) {\n\t\t\tthis._parent.registerChildLayer(layer);\n\t\t}\n\t}\n\n\tpublic markDirtyLayer(deep: boolean = false): void {\n\t\tsuper.markDirtyLayer();\n\t\tif (deep && this._childLayers) {\n\t\t\t$array.each(this._childLayers, (layer) => layer.dirty = true);\n\t\t}\n\t}\n\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\tif (this._childLayers) {\n\t\t\t$array.each(this._childLayers, (layer) => {\n\t\t\t\tlayer.dirty = true;\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nfunction setPoint(bounds: IBounds, point: IPoint): void {\n\tbounds.left = Math.min(bounds.left, point.x);\n\tbounds.top = Math.min(bounds.top, point.y);\n\tbounds.right = Math.max(bounds.right, point.x);\n\tbounds.bottom = Math.max(bounds.bottom, point.y);\n}\n\n/**\n * @ignore\n */\nabstract class Op {\n\tpublic colorize(_context: CanvasRenderingContext2D, _forceColor: string | undefined): void { }\n\n\tpublic colorizeGhost(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tthis.colorize(context, forceColor);\n\t}\n\n\tpublic path(_context: CanvasRenderingContext2D): void { }\n\n\tpublic pathGhost(context: CanvasRenderingContext2D): void {\n\t\tthis.path(context);\n\t}\n\n\tpublic addBounds(_bounds: IBounds): void { }\n}\n\n/**\n * @ignore\n */\nclass BeginPath extends Op {\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.beginPath();\n\t}\n}\n\n/**\n * @ignore\n */\nclass BeginFill extends Op {\n\tconstructor(public color: string | CanvasGradient | CanvasPattern) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tif (forceColor !== undefined) {\n\t\t\tcontext.fillStyle = forceColor;\n\n\t\t} else {\n\t\t\tcontext.fillStyle = this.color;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass EndFill extends Op {\n\tconstructor(public clearShadow: boolean) { super(); }\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.fill();\n\t\tif (this.clearShadow) {\n\t\t\tcontext.shadowColor = \"\";\n\t\t\tcontext.shadowBlur = 0;\n\t\t\tcontext.shadowOffsetX = 0;\n\t\t\tcontext.shadowOffsetY = 0;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass EndStroke extends Op {\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.stroke();\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineStyle extends Op {\n\tconstructor(public width: number, public color: string | CanvasGradient | CanvasPattern, public lineJoin?: \"miter\" | \"round\" | \"bevel\", public lineCap?: \"butt\" | \"round\" | \"square\") { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tif (forceColor !== undefined) {\n\t\t\tcontext.strokeStyle = forceColor;\n\n\t\t} else {\n\t\t\tcontext.strokeStyle = this.color;\n\t\t}\n\n\t\tcontext.lineWidth = this.width;\n\t\tif (this.lineJoin) {\n\t\t\tcontext.lineJoin = this.lineJoin;\n\t\t}\n\n\t\tif (this.lineCap) {\n\t\t\tcontext.lineCap = this.lineCap;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineDash extends Op {\n\tconstructor(public dash: number[]) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.setLineDash(this.dash);\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineDashOffset extends Op {\n\tconstructor(public dashOffset: number) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.lineDashOffset = this.dashOffset;\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawRect extends Op {\n\tconstructor(public x: number, public y: number, public width: number, public height: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.rect(this.x, this.y, this.width, this.height);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tconst l = this.x;\n\t\tconst t = this.y;\n\t\tconst r = l + this.width;\n\t\tconst b = t + this.height;\n\n\t\tsetPoint(bounds, { x: l, y: t });\n\t\tsetPoint(bounds, { x: r, y: t });\n\t\tsetPoint(bounds, { x: l, y: b });\n\t\tsetPoint(bounds, { x: r, y: b });\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawCircle extends Op {\n\tconstructor(public x: number, public y: number, public radius: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.moveTo(this.x + this.radius, this.y);\n\t\tcontext.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\n\t}\n\n\t// TODO handle skewing and rotation\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x - this.radius, y: this.y - this.radius });\n\t\tsetPoint(bounds, { x: this.x + this.radius, y: this.y + this.radius });\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawEllipse extends Op {\n\tconstructor(public x: number, public y: number, public radiusX: number, public radiusY: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.ellipse(0, 0, this.radiusX, this.radiusY, 0, 0, Math.PI * 2);\n\t}\n\n\t// TODO handle skewing and rotation\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x - this.radiusX, y: this.y - this.radiusY });\n\t\tsetPoint(bounds, { x: this.x + this.radiusX, y: this.y + this.radiusY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass Arc extends Op {\n\tconstructor(\n\t\tpublic cx: number,\n\t\tpublic cy: number,\n\t\tpublic radius: number,\n\t\tpublic startAngle: number,\n\t\tpublic endAngle: number,\n\t\tpublic anticlockwise: boolean,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tif (this.radius > 0) {\n\t\t\tcontext.arc(this.cx, this.cy, this.radius, this.startAngle, this.endAngle, this.anticlockwise);\n\t\t}\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tlet arcBounds = $math.getArcBounds(this.cx, this.cy, this.startAngle * $math.DEGREES, this.endAngle * $math.DEGREES, this.radius);\n\t\tsetPoint(bounds, { x: arcBounds.left, y: arcBounds.top });\n\t\tsetPoint(bounds, { x: arcBounds.right, y: arcBounds.bottom });\n\t}\n}\n\n/**\n * @ignore\n */\nclass ArcTo extends Op {\n\tconstructor(\n\t\tpublic x1: number,\n\t\tpublic y1: number,\n\t\tpublic x2: number,\n\t\tpublic y2: number,\n\t\tpublic radius: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tif (this.radius > 0) {\n\t\t\tcontext.arcTo(this.x1, this.y1, this.x2, this.y2, this.radius);\n\t\t}\n\t}\n\n\t// TODO: add points\n\tpublic addBounds(_bounds: IBounds): void {\n\t\t/*\n\t\t// not finished\n\t\thttps://math.stackexchange.com/questions/1781438/finding-the-center-of-a-circle-given-two-points-and-a-radius-algebraically\n\n\t\tif (prevPoint) {\n\t\t\tlet x1 = prevPoint.x;\n\t\t\tlet y1 = prevPoint.y;\n\t\t\tlet x2 = this.x2;\n\t\t\tlet y2 = this.y2;\n\t\t\tlet r = this.radius;\n\n\t\t\tlet xa = (x2 - x1) / 2;\n\t\t\tlet ya = (y2 - y1) / 2;\n\n\t\t\tlet x0 = x1 + xa;\n\t\t\tlet y0 = y1 + ya;\n\n\t\t\tlet a = Math.hypot(xa, ya);\n\t\t\tlet b = Math.sqrt(r * r - a * a);\n\n\t\t\tlet cx = x0 + b * ya / a;\n\t\t\tlet cy = y0 - b * xa / a;\n\n\t\t\tconsole.log(cx, cy);\n\t\t}*/\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineTo extends Op {\n\tconstructor(public x: number, public y: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.lineTo(this.x, this.y);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t}\n}\n\n/**\n * @ignore\n */\nclass MoveTo extends Op {\n\tconstructor(public x: number, public y: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.moveTo(this.x, this.y);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t}\n}\n\n/**\n * @ignore\n */\nclass ClosePath extends Op {\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.closePath();\n\t}\n}\n\n/**\n * @ignore\n */\nclass BezierCurveTo extends Op {\n\tconstructor(\n\t\tpublic cpX: number,\n\t\tpublic cpY: number,\n\t\tpublic cpX2: number,\n\t\tpublic cpY2: number,\n\t\tpublic toX: number,\n\t\tpublic toY: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.bezierCurveTo(this.cpX, this.cpY, this.cpX2, this.cpY2, this.toX, this.toY);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.cpX, y: this.cpY });\n\t\tsetPoint(bounds, { x: this.cpX2, y: this.cpY2 });\n\t\tsetPoint(bounds, { x: this.toX, y: this.toY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass QuadraticCurveTo extends Op {\n\tconstructor(\n\t\tpublic cpX: number,\n\t\tpublic cpY: number,\n\t\tpublic toX: number,\n\t\tpublic toY: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.quadraticCurveTo(this.cpX, this.cpY, this.toX, this.toY);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.cpX, y: this.cpY });\n\t\tsetPoint(bounds, { x: this.toX, y: this.toY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass Shadow extends Op {\n\tconstructor(\n\t\tpublic color: string,\n\t\tpublic blur: number,\n\t\tpublic offsetX: number,\n\t\tpublic offsetY: number,\n\t\tpublic opacity?: number\n\t) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tif (this.opacity) {\n\t\t\tcontext.fillStyle = this.color;\n\t\t}\n\t\tcontext.shadowColor = this.color;\n\t\tcontext.shadowBlur = this.blur;\n\t\tcontext.shadowOffsetX = this.offsetX;\n\t\tcontext.shadowOffsetY = this.offsetY;\n\t}\n\n\tpublic colorizeGhost(_context: CanvasRenderingContext2D, _forceColor: string | undefined): void {}\n}\n\n/**\n * @ignore\n */\nclass GraphicsImage extends Op {\n\tconstructor(\n\t\tpublic image: HTMLImageElement | HTMLCanvasElement,\n\t\tpublic width: number,\n\t\tpublic height: number,\n\t\tpublic x: number,\n\t\tpublic y: number\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.drawImage(this.image, this.x, this.y, this.width, this.height);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t\tsetPoint(bounds, { x: this.width, y: this.height });\n\t}\n}\n\n/**\n * @ignore\n */\nexport class CanvasGraphics extends CanvasDisplayObject implements IGraphics {\n\tprotected _operations: Array<Op> = [];\n\n\tpublic blendMode: BlendMode = BlendMode.NORMAL;\n\n\tprotected _hasShadows: boolean = false;\n\tprotected _fillAlpha?: number;\n\tprotected _strokeAlpha?: number;\n\n\tclear(): void {\n\t\tsuper.clear();\n\t\tthis._operations.length = 0;\n\t}\n\n\tprotected _pushOp(op: Op): void {\n\t\tthis._operations.push(op);\n\t}\n\n\tbeginFill(color?: Color | CanvasGradient | CanvasPattern, alpha: number = 1): void {\n\t\tthis._fillAlpha = alpha;\n\t\tif (color) {\n\t\t\tif (color instanceof Color) {\n\t\t\t\tthis._pushOp(new BeginFill(color.toCSS(alpha)));\n\n\t\t\t} else {\n\t\t\t\tthis.isMeasured = true;\n\t\t\t\tthis._pushOp(new BeginFill(color));\n\t\t\t}\n\t\t} else {\n\t\t\tthis._pushOp(new BeginFill(\"rgba(0, 0, 0, \" + alpha + \")\"));\n\t\t}\n\t}\n\n\tendFill(): void {\n\t\tthis._pushOp(new EndFill(this._hasShadows));\n\t}\n\n\tendStroke(): void {\n\t\tthis._pushOp(new EndStroke());\n\t}\n\n\tbeginPath(): void {\n\t\tthis._pushOp(new BeginPath());\n\t}\n\n\tlineStyle(width: number = 0, color?: Color | CanvasGradient | CanvasPattern, alpha: number = 1, lineJoin?: \"miter\" | \"round\" | \"bevel\", lineCap?: \"butt\" | \"round\" | \"square\"): void {\n\t\tthis._strokeAlpha = alpha;\n\t\tif (color) {\n\t\t\tif (color instanceof Color) {\n\t\t\t\tthis._pushOp(new LineStyle(width, color.toCSS(alpha), lineJoin, lineCap));\n\t\t\t} else {\n\t\t\t\tthis._pushOp(new LineStyle(width, color, lineJoin, lineCap));\n\t\t\t}\n\t\t} else {\n\t\t\tthis._pushOp(new LineStyle(width, \"rgba(0, 0, 0, \" + alpha + \")\", lineJoin, lineCap));\n\t\t}\n\t}\n\n\tsetLineDash(dash?: number[]): void {\n\t\tthis._pushOp(new LineDash(dash ? dash : []));\n\t}\n\n\tsetLineDashOffset(dashOffset: number = 0): void {\n\t\tthis._pushOp(new LineDashOffset(dashOffset));\n\t}\n\n\tdrawRect(x: number, y: number, width: number, height: number): void {\n\t\tthis._pushOp(new DrawRect(x, y, width, height));\n\t}\n\n\tdrawCircle(x: number, y: number, radius: number): void {\n\t\tthis._pushOp(new DrawCircle(x, y, radius));\n\t}\n\n\tdrawEllipse(x: number, y: number, radiusX: number, radiusY: number): void {\n\t\tthis._pushOp(new DrawEllipse(x, y, radiusX, radiusY));\n\t}\n\n\tarc(cx: number, cy: number, radius: number, startAngle: number, endAngle: number, anticlockwise: boolean = false): void {\n\t\tthis._pushOp(new Arc(cx, cy, radius, startAngle, endAngle, anticlockwise));\n\t}\n\n\tarcTo(x1: number, y1: number, x2: number, y2: number, radius: number): void {\n\t\tthis._pushOp(new ArcTo(x1, y1, x2, y2, radius));\n\t}\n\n\tlineTo(x: number, y: number): void {\n\t\tthis._pushOp(new LineTo(x, y));\n\t}\n\n\tmoveTo(x: number, y: number): void {\n\t\tthis._pushOp(new MoveTo(x, y));\n\t}\n\n\tbezierCurveTo(cpX: number, cpY: number, cpX2: number, cpY2: number, toX: number, toY: number): void {\n\t\tthis._pushOp(new BezierCurveTo(cpX, cpY, cpX2, cpY2, toX, toY));\n\t}\n\n\tquadraticCurveTo(cpX: number, cpY: number, toX: number, toY: number): void {\n\t\tthis._pushOp(new QuadraticCurveTo(cpX, cpY, toX, toY));\n\t}\n\n\tclosePath(): void {\n\t\tthis._pushOp(new ClosePath());\n\t}\n\n\tshadow(color: Color, blur: number = 0, offsetX: number = 0, offsetY: number = 0, opacity?: number): void {\n\t\tthis._hasShadows = true;\n\t\tthis._pushOp(new Shadow(opacity ? color.toCSS(opacity) : color.toCSS(this._fillAlpha || this._strokeAlpha), blur, offsetX, offsetY));\n\t}\n\n\timage(image: HTMLImageElement | HTMLCanvasElement, width: number, height: number, x: number, y: number): void {\n\t\tthis._pushOp(new GraphicsImage(image, width, height, x, y));\n\t}\n\n\t// https://svgwg.org/svg2-draft/paths.html#DProperty\n\t// TODO better error checking\n\tsvgPath(path: string): void {\n\t\tlet x = 0;\n\t\tlet y = 0;\n\t\tlet cpx: number | null = null;\n\t\tlet cpy: number | null = null;\n\t\tlet qcpx: number | null = null;\n\t\tlet qcpy: number | null = null;\n\n\t\tconst SEGMENTS_REGEXP = /([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g;\n\t\tconst ARGS_REGEXP = /[\\u0009\\u0020\\u000A\\u000C\\u000D]*([\\+\\-]?[0-9]*\\.?[0-9]+(?:[eE][\\+\\-]?[0-9]+)?)[\\u0009\\u0020\\u000A\\u000C\\u000D]*,?/g;\n\n\t\tlet match;\n\n\t\twhile ((match = SEGMENTS_REGEXP.exec(path)) !== null) {\n\t\t\tconst name = match[1];\n\t\t\tconst rest = match[2];\n\n\t\t\tconst args: Array<string> = [];\n\n\t\t\twhile ((match = ARGS_REGEXP.exec(rest)) !== null) {\n\t\t\t\targs.push(match[1]);\n\t\t\t}\n\n\t\t\t// Reset control point\n\t\t\tif (name !== \"S\" && name !== \"s\" && name !== \"C\" && name !== \"c\") {\n\t\t\t\tcpx = null;\n\t\t\t\tcpy = null;\n\t\t\t}\n\n\t\t\t// Reset control point\n\t\t\tif (name !== \"Q\" && name !== \"q\" && name !== \"T\" && name !== \"t\") {\n\t\t\t\tqcpx = null;\n\t\t\t\tqcpy = null;\n\t\t\t}\n\n\t\t\tswitch (name) {\n\t\t\t\tcase \"M\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tx = +args[0];\n\t\t\t\t\ty = +args[1];\n\t\t\t\t\tthis.moveTo(x, y);\n\n\t\t\t\t\tfor (let i = 2; i < args.length; i += 2) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tx += +args[0];\n\t\t\t\t\ty += +args[1];\n\t\t\t\t\tthis.moveTo(x, y);\n\n\t\t\t\t\tfor (let i = 2; i < args.length; i += 2) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"L\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"l\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"H\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"V\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\ty = +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"v\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\ty += +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"C\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 6);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 6) {\n\t\t\t\t\t\tconst x1 = +args[i];\n\t\t\t\t\t\tconst y1 = +args[i + 1];\n\t\t\t\t\t\tcpx = +args[i + 2];\n\t\t\t\t\t\tcpy = +args[i + 3];\n\t\t\t\t\t\tx = +args[i + 4];\n\t\t\t\t\t\ty = +args[i + 5];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"c\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 6);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 6) {\n\t\t\t\t\t\tconst x1 = +args[i] + x;\n\t\t\t\t\t\tconst y1 = +args[i + 1] + y;\n\t\t\t\t\t\tcpx = +args[i + 2] + x;\n\t\t\t\t\t\tcpy = +args[i + 3] + y;\n\t\t\t\t\t\tx += +args[i + 4];\n\t\t\t\t\t\ty += +args[i + 5];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"S\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tif (cpx === null || cpy === null) {\n\t\t\t\t\t\tcpx = x;\n\t\t\t\t\t\tcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tconst x1 = 2 * x - cpx;\n\t\t\t\t\t\tconst y1 = 2 * y - cpy;\n\t\t\t\t\t\tcpx = +args[i];\n\t\t\t\t\t\tcpy = +args[i + 1];\n\t\t\t\t\t\tx = +args[i + 2];\n\t\t\t\t\t\ty = +args[i + 3];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tif (cpx === null || cpy === null) {\n\t\t\t\t\t\tcpx = x;\n\t\t\t\t\t\tcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tconst x1 = 2 * x - cpx;\n\t\t\t\t\t\tconst y1 = 2 * y - cpy;\n\t\t\t\t\t\tcpx = +args[i] + x;\n\t\t\t\t\t\tcpy = +args[i + 1] + y;\n\t\t\t\t\t\tx += +args[i + 2];\n\t\t\t\t\t\ty += +args[i + 3];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Q\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tqcpx = +args[i];\n\t\t\t\t\t\tqcpy = +args[i + 1];\n\t\t\t\t\t\tx = +args[i + 2];\n\t\t\t\t\t\ty = +args[i + 3];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"q\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tqcpx = +args[i] + x;\n\t\t\t\t\t\tqcpy = +args[i + 1] + y;\n\t\t\t\t\t\tx += +args[i + 2];\n\t\t\t\t\t\ty += +args[i + 3];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"T\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tif (qcpx === null || qcpy === null) {\n\t\t\t\t\t\tqcpx = x;\n\t\t\t\t\t\tqcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tqcpx = 2 * x - qcpx;\n\t\t\t\t\t\tqcpy = 2 * y - qcpy;\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"t\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tif (qcpx === null || qcpy === null) {\n\t\t\t\t\t\tqcpx = x;\n\t\t\t\t\t\tqcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tqcpx = 2 * x - qcpx;\n\t\t\t\t\t\tqcpy = 2 * y - qcpy;\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"A\":\n\t\t\t\tcase \"a\":\n\t\t\t\t\tconst relative = (name === \"a\");\n\n\t\t\t\t\tsplitArcFlags(args);\n\t\t\t\t\tcheckEvenArgs(name, args.length, 7);\n\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 7) {\n\t\t\t\t\t\tlet cx = +args[i + 5];\n\t\t\t\t\t\tlet cy = +args[i + 6];\n\n\t\t\t\t\t\tif (relative) {\n\t\t\t\t\t\t\tcx += x;\n\t\t\t\t\t\t\tcy += y;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst bs = arcToBezier({\n\t\t\t\t\t\t\tpx: x,\n\t\t\t\t\t\t\tpy: y,\n\t\t\t\t\t\t\trx: +args[i],\n\t\t\t\t\t\t\try: +args[i + 1],\n\t\t\t\t\t\t\txAxisRotation: +args[i + 2],\n\t\t\t\t\t\t\tlargeArcFlag: assertBinary(+args[i + 3]),\n\t\t\t\t\t\t\tsweepFlag: assertBinary(+args[i + 4]),\n\t\t\t\t\t\t\tcx,\n\t\t\t\t\t\t\tcy,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$array.each(bs, (b) => {\n\t\t\t\t\t\t\tthis.bezierCurveTo(b.x1, b.y1, b.x2, b.y2, b.x, b.y);\n\t\t\t\t\t\t\tx = b.x;\n\t\t\t\t\t\t\ty = b.y;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Z\":\n\t\t\t\tcase \"z\":\n\t\t\t\t\tcheckArgs(name, args.length, 0);\n\t\t\t\t\tthis.closePath();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tpublic _runPath(context: CanvasRenderingContext2D): void {\n\t\tcontext.beginPath();\n\n\t\t$array.each(this._operations, (op) => {\n\t\t\top.path(context);\n\t\t});\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tsuper._render(status);\n\n\t\tconst layerDirty = status.layer.dirty;\n\t\tconst interactive = this._isInteractive(status);\n\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\tif (layerDirty || interactive || ghostOnly) {\n\n\t\t\tconst context = status.layer.context;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\tcontext.globalCompositeOperation = this.blendMode;\n\t\t\t\tcontext.beginPath();\n\t\t\t}\n\n\t\t\tlet color: string | undefined;\n\n\t\t\tif (drawGhost) {\n\t\t\t\tghostContext.beginPath();\n\t\t\t\tcolor = this._getColorId();\n\t\t\t}\n\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\top.path(context);\n\t\t\t\t\top.colorize(context, undefined);\n\t\t\t\t}\n\n\t\t\t\tif (drawGhost) {\n\t\t\t\t\top.pathGhost(ghostContext);\n\t\t\t\t\top.colorizeGhost(ghostContext, color);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic renderDetached(context: CanvasRenderingContext2D): void {\n\t\tif (this.visible) {\n\t\t\tthis._setMatrix();\n\n\t\t\tcontext.save();\n\n\t\t\t// We must apply the mask before we transform the element\n\t\t\tconst mask = this.mask;\n\t\t\tif (mask) {\n\t\t\t\tmask._setMatrix();\n\t\t\t\tmask._transform(context, 1);\n\t\t\t\tmask._runPath(context);\n\t\t\t\tcontext.clip();\n\t\t\t}\n\n\t\t\t// TODO handle compoundAlpha somehow ?\n\t\t\tcontext.globalAlpha = this.compoundAlpha * this.alpha;\n\n\t\t\tthis._transform(context, 1);\n\n\t\t\tif (this.filter) {\n\t\t\t\tcontext.filter = this.filter;\n\t\t\t}\n\n\t\t\tcontext.globalCompositeOperation = this.blendMode;\n\n\t\t\tcontext.beginPath();\n\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\top.path(context);\n\t\t\t\top.colorize(context, undefined);\n\t\t\t});\n\n\t\t\tcontext.restore();\n\t\t}\n\t}\n\n\tpublic _addBounds(bounds: IBounds): void {\n\t\tif (this.visible && this.isMeasured) {\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\top.addBounds(bounds);\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\ninterface ILineChunk {\n\tstyle: string | undefined,\n\tfill: Color | undefined,\n\ttext: string,\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\tascent: number,\n\toffsetX: number,\n\toffsetY: number,\n\ttextDecoration: string | undefined,\n\tverticalAlign?: \"baseline\" | \"sub\" | \"super\"\n}\n\n/**\n * @ignore\n */\ninterface ILine {\n\toffsetY: number,\n\tascent: number,\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\ttextChunks: Array<ILineChunk>,\n}\n\n/**\n * @ignore\n */\nexport class CanvasText extends CanvasDisplayObject implements IText {\n\tpublic text: string;\n\tpublic style: CanvasTextStyle;\n\tpublic resolution: number = 1;\n\tpublic textVisible: boolean = true;\n\tpublic truncated?: boolean;\n\n\tprotected _textInfo: Array<ILine> | undefined;\n\tprotected _originalScale?: number = 1;\n\n\tconstructor(renderer: CanvasRenderer, text: string, style: CanvasTextStyle) {\n\t\tsuper(renderer);\n\t\tthis.text = text;\n\t\tthis.style = style;\n\t}\n\n\tpublic invalidateBounds(): void {\n\t\tsuper.invalidateBounds();\n\t\tthis._textInfo = undefined;\n\t}\n\n\tpublic invalidateVisibility(): void {\n\t\tthis.textVisible = true;\n\t\tthis.scale = this._originalScale || 1;\n\t}\n\n\tprivate _shared(context: CanvasRenderingContext2D) {\n\t\tif (this.style.textAlign) {\n\t\t\tcontext.textAlign = this.style.textAlign;\n\t\t}\n\n\t\tif (this.style.direction) {\n\t\t\tcontext.direction = this.style.direction;\n\t\t}\n\n\t\tif (this.style.textBaseline) {\n\t\t\tcontext.textBaseline = this.style.textBaseline;\n\t\t}\n\n\t}\n\n\tprotected _prerender(status: IStatus, ignoreGhost = false, ignoreFontWeight = false): void {\n\t\tsuper._render(status);\n\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t// Font style\n\n\t\tconst style = this.style;\n\t\tlet fontStyle = this._getFontStyle(undefined, ignoreFontWeight);\n\n\t\tcontext.font = fontStyle;\n\t\tif (this._isInteractive(status) && !ignoreGhost) {\n\t\t\tghostContext.font = fontStyle;\n\t\t}\n\n\t\t// Other parameters\n\t\tif (style.fill) {\n\t\t\tif (style.fill instanceof Color) {\n\t\t\t\tcontext.fillStyle = style.fill.toCSS(style.fillOpacity != undefined ? style.fillOpacity : 1);\n\t\t\t} else {\n\t\t\t\tcontext.fillStyle = style.fill;\n\t\t\t}\n\t\t}\n\n\t\tif (style.shadowColor) {\n\t\t\tstatus.layer.context.shadowColor = style.shadowColor.toCSS(style.shadowOpacity || 1);\n\t\t}\n\t\tif (style.shadowBlur) {\n\t\t\tstatus.layer.context.shadowBlur = style.shadowBlur;\n\t\t}\n\t\tif (style.shadowOffsetX) {\n\t\t\tstatus.layer.context.shadowOffsetX = style.shadowOffsetX;\n\t\t}\n\t\tif (style.shadowOffsetY) {\n\t\t\tstatus.layer.context.shadowOffsetY = style.shadowOffsetY;\n\t\t}\n\n\t\tthis._shared(context);\n\n\t\tif (this._isInteractive(status) && !ignoreGhost) {\n\t\t\tghostContext.fillStyle = this._getColorId();\n\t\t\tthis._shared(ghostContext);\n\t\t}\n\t}\n\n\tprotected _getFontStyle(style2?: ITextStyle, ignoreFontWeight = false): string {\n\n\t\t// Process defaults\n\t\tconst style = this.style;\n\t\tlet fontStyle: string[] = [];\n\n\t\tif (style2 && style2.fontVariant) {\n\t\t\tfontStyle.push(style2.fontVariant);\n\t\t}\n\t\telse if (style.fontVariant) {\n\t\t\tfontStyle.push(style.fontVariant);\n\t\t}\n\n\t\tif (!ignoreFontWeight) {\n\t\t\tif (style2 && style2.fontWeight) {\n\t\t\t\tfontStyle.push(style2.fontWeight);\n\t\t\t}\n\t\t\telse if (style.fontWeight) {\n\t\t\t\tfontStyle.push(style.fontWeight);\n\t\t\t}\n\t\t}\n\n\t\tif (style2 && style2.fontStyle) {\n\t\t\tfontStyle.push(style2.fontStyle);\n\t\t}\n\t\telse if (style.fontStyle) {\n\t\t\tfontStyle.push(style.fontStyle);\n\t\t}\n\n\t\tif (style2 && style2.fontSize) {\n\t\t\tif ($type.isNumber(style2.fontSize)) {\n\t\t\t\tstyle2.fontSize = style2.fontSize + \"px\";\n\t\t\t}\n\t\t\tfontStyle.push(style2.fontSize);\n\t\t}\n\t\telse if (style.fontSize) {\n\t\t\tif ($type.isNumber(style.fontSize)) {\n\t\t\t\tstyle.fontSize = style.fontSize + \"px\";\n\t\t\t}\n\t\t\tfontStyle.push(style.fontSize);\n\t\t}\n\n\t\tif (style2 && style2.fontFamily) {\n\t\t\tfontStyle.push(style2.fontFamily);\n\t\t}\n\t\telse if (style.fontFamily) {\n\t\t\tfontStyle.push(style.fontFamily);\n\t\t}\n\t\telse if (fontStyle.length) {\n\t\t\tfontStyle.push(\"Arial\");\n\t\t}\n\n\t\treturn fontStyle.join(\" \");\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\t// We need measurements in order to properly position text for alignment\n\t\tif (!this._textInfo) {\n\t\t\tthis._measure(status);\n\t\t}\n\n\t\tif (this.textVisible) {\n\n\t\t\tconst interactive = this._isInteractive(status);\n\t\t\tconst context = status.layer.context;\n\t\t\tconst layerDirty = status.layer.dirty;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\tcontext.save();\n\t\t\tghostContext.save();\n\t\t\tthis._prerender(status);\n\n\t\t\t// const lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\t\t// const x = this._localBounds && (this._localBounds.left < 0) ? Math.abs(this._localBounds.left) : 0;\n\n\t\t\t// Process text info produced by _measure()\n\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\t\t\t\t$array.each(line.textChunks, (chunk, _index) => {\n\n\t\t\t\t\t// Set style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.font = chunk.style;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this._isInteractive(status)) {\n\t\t\t\t\t\t\tghostContext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.fillStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw text\n\t\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\t\tcontext.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw underline\n\t\t\t\t\tif (chunk.textDecoration == \"underline\" || chunk.textDecoration == \"line-through\") {\n\n\t\t\t\t\t\tlet thickness = 1;\n\t\t\t\t\t\tlet offset = 1;\n\t\t\t\t\t\tlet fontSize = chunk.height;\n\n\t\t\t\t\t\tconst oversizedBehavior = this.style.oversizedBehavior || \"\";\n\t\t\t\t\t\tif ([\"truncate\", \"wrap\", \"wrap-no-break\"].indexOf(oversizedBehavior) > -1) {\n\t\t\t\t\t\t\t// Measure actual width of the text so the line fits\n\t\t\t\t\t\t\tconst metrics = this._measureText(chunk.text, context);\n\t\t\t\t\t\t\tchunk.width = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet offsetX = chunk.offsetX;\n\t\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\t\toffsetX -= chunk.width;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\t\toffsetX -= chunk.width / 2;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\t\tconst format = TextFormatter.getTextStyle(chunk.style);\n\t\t\t\t\t\t\tswitch (format.fontWeight) {\n\t\t\t\t\t\t\t\tcase \"bolder\":\n\t\t\t\t\t\t\t\tcase \"bold\":\n\t\t\t\t\t\t\t\tcase \"700\":\n\t\t\t\t\t\t\t\tcase \"800\":\n\t\t\t\t\t\t\t\tcase \"900\":\n\t\t\t\t\t\t\t\t\tthickness = 2;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (fontSize) {\n\t\t\t\t\t\t\toffset = fontSize / 20;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet y: number;\n\n\t\t\t\t\t\tif (chunk.textDecoration == \"line-through\") {\n\t\t\t\t\t\t\ty = thickness + line.offsetY + chunk.offsetY - chunk.height / 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ty = thickness + offset * 1.5 + line.offsetY + chunk.offsetY;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\t\tcontext.beginPath();\n\t\t\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\t\t\tcontext.strokeStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (this.style.fill && this.style.fill instanceof Color) {\n\t\t\t\t\t\t\t\tcontext.strokeStyle = this.style.fill.toCSS();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontext.lineWidth = thickness * offset;\n\t\t\t\t\t\t\tcontext.moveTo(offsetX, y);\n\t\t\t\t\t\t\tcontext.lineTo(offsetX + chunk.width, y);\n\t\t\t\t\t\t\tcontext.stroke();\n\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (interactive && this.interactive && drawGhost) {\n\t\t\t\t\t\t// Draw text in ghost canvas ONLY if it is set as interactive\n\t\t\t\t\t\t// explicitly. This way we avoid hit test anomalies caused by anti\n\t\t\t\t\t\t// aliasing of text.\n\t\t\t\t\t\tghostContext.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reset style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\t}\n\n\tpublic _addBounds(bounds: IBounds): void {\n\t\tif (this.visible && this.isMeasured) {\n\t\t\t//if (this._textVisible) {\n\t\t\tconst x = this._measure({\n\t\t\t\tinactive: this.inactive,\n\t\t\t\tlayer: this.getLayer(),\n\t\t\t});\n\t\t\tsetPoint(bounds, { x: x.left, y: x.top });\n\t\t\tsetPoint(bounds, { x: x.right, y: x.bottom });\n\t\t\t//}\n\t\t}\n\t}\n\n\tprotected _ignoreFontWeight(): boolean {\n\t\treturn /apple/i.test(navigator.vendor);\n\t}\n\n\tpublic _measure(status: IStatus): IBounds {\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\t\tconst rtl = this.style.direction == \"rtl\";\n\n\t\t// Reset text info\n\t\tthis._textInfo = [];\n\n\t\t// Init\n\t\tconst oversizedBehavior = this.style.oversizedBehavior;\n\t\tconst maxWidth = this.style.maxWidth!;\n\n\t\tconst truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\n\t\tconst wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\n\n\t\t// Pre-render\n\t\tcontext.save();\n\t\tghostContext.save();\n\t\tthis._prerender(status, true, this._ignoreFontWeight());\n\n\t\t// Get default font metrix\n\t\tconst refText = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\n\n\t\t// Split up text into lines\n\t\tconst lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\tlet styleRestored = true;\n\t\tlet minX = 0;\n\t\tlet maxX = 0;\n\n\t\t// Iterate through the lines\n\t\tlet offsetY = 0;\n\t\tlet currentStyle: string | undefined;\n\t\t$array.each(lines, (line, _index) => {\n\n\t\t\t// Split up line into format/value chunks\n\t\t\tlet chunks: ITextChunk[];\n\t\t\tif (line == \"\") {\n\t\t\t\tchunks = [{\n\t\t\t\t\ttype: \"value\",\n\t\t\t\t\ttext: \"\"\n\t\t\t\t}];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\n\t\t\t}\n\n\t\t\twhile (chunks.length > 0) {\n\n\t\t\t\t// Init line object\n\t\t\t\tlet lineInfo: ILine = {\n\t\t\t\t\toffsetY: offsetY,\n\t\t\t\t\tascent: 0,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\ttextChunks: []\n\t\t\t\t};\n\n\t\t\t\t// Measure reference text\n\t\t\t\tconst metrics = this._measureText(refText, context);\n\n\t\t\t\tconst height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\tlineInfo.height = height;\n\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\n\t\t\t\tlet currentFormat: string;\n\t\t\t\tlet currentDecoration: string | undefined = this.style.textDecoration;\n\t\t\t\tlet currentFill: Color | undefined;\n\t\t\t\tlet currentChunkWidth: number | undefined;\n\t\t\t\tlet skipFurtherText = false;\n\t\t\t\tlet firstTextChunk = true;\n\t\t\t\tlet leftoverChunks: Array<ITextChunk> = [];\n\t\t\t\tlet currentVerticalAlign: \"baseline\" | \"sub\" | \"super\" | undefined;\n\t\t\t\t//let offsetX = 0;\n\t\t\t\t//let chunk;\n\n\t\t\t\t//while(chunk = chunks.shift()) {\n\t\t\t\t$array.eachContinue(chunks, (chunk, index) => {\n\n\t\t\t\t\t// Format chunk\n\t\t\t\t\tif (chunk.type == \"format\") {\n\t\t\t\t\t\tif (chunk.text == \"[/]\") {\n\t\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\t\tstyleRestored = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrentFill = undefined;\n\t\t\t\t\t\t\tcurrentStyle = undefined;\n\t\t\t\t\t\t\tcurrentChunkWidth = undefined;\n\t\t\t\t\t\t\tcurrentDecoration = this.style.textDecoration;\n\t\t\t\t\t\t\tcurrentVerticalAlign = undefined\n\t\t\t\t\t\t\tcurrentFormat = chunk.text;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\n\t\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet format = TextFormatter.getTextStyle(chunk.text);\n\t\t\t\t\t\t\tconst fontStyle = this._getFontStyle(format);\n\t\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\t\tghostContext.save();\n\t\t\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\t\t\tcurrentStyle = fontStyle;\n\t\t\t\t\t\t\tcurrentFormat = chunk.text;\n\t\t\t\t\t\t\tif (format.textDecoration) {\n\t\t\t\t\t\t\t\tcurrentDecoration = format.textDecoration;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (format.fill) {\n\t\t\t\t\t\t\t\tcurrentFill = <Color>format.fill;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ((<any>format).width) {\n\t\t\t\t\t\t\t\tcurrentChunkWidth = $type.toNumber((<any>format).width);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (format.verticalAlign) {\n\t\t\t\t\t\t\t\tcurrentVerticalAlign = format.verticalAlign;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstyleRestored = false;\n\n\t\t\t\t\t\t\t// Measure reference text after change of format\n\t\t\t\t\t\t\tconst metrics = this._measureText(refText, context);\n\t\t\t\t\t\t\tconst height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\t\t\t\tif (height > lineInfo.height) {\n\t\t\t\t\t\t\t\tlineInfo.height = height;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Text chunk\n\t\t\t\t\telse if (chunk.type == \"value\" && !skipFurtherText) {\n\n\t\t\t\t\t\t// Measure\n\t\t\t\t\t\tconst metrics = this._measureText(chunk.text, context);\n\t\t\t\t\t\tlet chunkWidth = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\n\t\t\t\t\t\t// Check for fit\n\t\t\t\t\t\tif (truncate) {\n\n\t\t\t\t\t\t\tthis.truncated = undefined;\n\n\t\t\t\t\t\t\t// Break words?\n\t\t\t\t\t\t\tlet breakWords = firstTextChunk || this.style.breakWords || false;\n\n\t\t\t\t\t\t\t// Measure ellipsis and check if it fits\n\t\t\t\t\t\t\tconst ellipsis = this.style.ellipsis || \"\";\n\t\t\t\t\t\t\tconst ellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t\t\tconst ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\n\n\t\t\t\t\t\t\t// Check fit\n\t\t\t\t\t\t\tif ((lineInfo.width + chunkWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tconst excessWidth = maxWidth - lineInfo.width - ellipsisWidth;\n\t\t\t\t\t\t\t\tchunk.text = this._truncateText(context, chunk.text, excessWidth, breakWords);\n\t\t\t\t\t\t\t\tchunk.text += ellipsis;\n\t\t\t\t\t\t\t\tskipFurtherText = true;\n\t\t\t\t\t\t\t\tthis.truncated = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (wrap) {\n\t\t\t\t\t\t\t// Check fit\n\t\t\t\t\t\t\tif ((lineInfo.width + chunkWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tconst excessWidth = maxWidth - lineInfo.width;\n\t\t\t\t\t\t\t\tconst tmpText = this._truncateText(\n\t\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t\tchunk.text,\n\t\t\t\t\t\t\t\t\texcessWidth,\n\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t(firstTextChunk && this.style.oversizedBehavior != \"wrap-no-break\")\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (tmpText == \"\") {\n\t\t\t\t\t\t\t\t\t// Unable to fit a single letter - hide the whole label\n\t\t\t\t\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//skipFurtherText = true;\n\n\t\t\t\t\t\t\t\t//Add remaining chunks for the next line\n\t\t\t\t\t\t\t\tleftoverChunks = chunks.slice(index + 1);\n\n\t\t\t\t\t\t\t\t//Add remaining text of current chunk if it was forced-cut\n\t\t\t\t\t\t\t\tif ($utils.trim(tmpText) != $utils.trim(chunk.text)) {\n\t\t\t\t\t\t\t\t\tleftoverChunks.unshift({\n\t\t\t\t\t\t\t\t\t\ttype: \"value\",\n\t\t\t\t\t\t\t\t\t\ttext: chunk.text.substr(tmpText.length)\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (currentFormat) {\n\t\t\t\t\t\t\t\t\t\tleftoverChunks.unshift({\n\t\t\t\t\t\t\t\t\t\t\ttype: \"format\",\n\t\t\t\t\t\t\t\t\t\t\ttext: currentFormat\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Set current chunk (truncated)\n\t\t\t\t\t\t\t\tchunk.text = $utils.trim(tmpText);\n\n\t\t\t\t\t\t\t\tchunks = [];\n\t\t\t\t\t\t\t\tskipFurtherText = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Chunk width?\n\t\t\t\t\t\tlet leftBoundMod = 1;\n\t\t\t\t\t\tlet rightBoundMod = 1;\n\t\t\t\t\t\tif (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\n\t\t\t\t\t\t\t// increase horizontal bounding boxes accordingly\n\t\t\t\t\t\t\tconst boundsMod = chunkWidth / currentChunkWidth\n\t\t\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\t\t\tleftBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\t\t\tleftBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\trightBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\trightBoundMod = boundsMod;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchunkWidth = currentChunkWidth;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\n\t\t\t\t\t\tif (chunkHeight > lineInfo.height) {\n\t\t\t\t\t\t\tlineInfo.height = chunkHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlineInfo.width += chunkWidth;\n\t\t\t\t\t\tlineInfo.left += metrics.actualBoundingBoxLeft / leftBoundMod;\n\t\t\t\t\t\tlineInfo.right += metrics.actualBoundingBoxRight / rightBoundMod;\n\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\ttext: chunk.text,\n\t\t\t\t\t\t\twidth: chunkWidth,\n\t\t\t\t\t\t\theight: chunkHeight,\n\t\t\t\t\t\t\tleft: metrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\tright: metrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\tascent: metrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\toffsetY: 0,\n\t\t\t\t\t\t\ttextDecoration: currentDecoration,\n\t\t\t\t\t\t\tverticalAlign: currentVerticalAlign\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//offsetX += chunkWidth;\n\n\t\t\t\t\t\tfirstTextChunk = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (leftoverChunks) {\n\t\t\t\t\t\t//return false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t\t//}\n\t\t\t\t});\n\n\t\t\t\tif (this.style.lineHeight instanceof Percent) {\n\t\t\t\t\tlineInfo.height *= this.style.lineHeight.value;\n\t\t\t\t\tlineInfo.ascent *= this.style.lineHeight.value;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlineInfo.height *= this.style.lineHeight || 1.2;\n\t\t\t\t\tlineInfo.ascent *= this.style.lineHeight || 1.2;\n\t\t\t\t}\n\n\t\t\t\tif (minX < lineInfo.left) {\n\t\t\t\t\tminX = lineInfo.left;\n\t\t\t\t}\n\n\t\t\t\tif (maxX < lineInfo.right) {\n\t\t\t\t\tmaxX = lineInfo.right;\n\t\t\t\t}\n\n\t\t\t\tthis._textInfo!.push(lineInfo);\n\n\t\t\t\t//lineInfo.offsetY += lineInfo.ascent;\n\t\t\t\toffsetY += lineInfo.height;\n\n\t\t\t\t// Reset chunks so that it can proceed to the next line\n\t\t\t\tchunks = leftoverChunks || [];\n\t\t\t}\n\n\t\t});\n\n\t\tif (!styleRestored) {\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\n\t\t// Adjust chunk internal offsets\n\t\t$array.each(this._textInfo, (lineInfo, _index: number) => {\n\t\t\tlet currentChunkOffset = 0\n\t\t\t$array.each(lineInfo.textChunks, (chunk) => {\n\t\t\t\tchunk.offsetX = currentChunkOffset + chunk.left - lineInfo.left;\n\t\t\t\tchunk.offsetY += lineInfo.height - lineInfo.height * (this.style.baselineRatio || 0.19);\n\t\t\t\tcurrentChunkOffset += chunk.width * (rtl ? -1 : 1);\n\n\t\t\t\tif (chunk.verticalAlign) {\n\t\t\t\t\tswitch (chunk.verticalAlign) {\n\t\t\t\t\t\tcase \"super\":\n\t\t\t\t\t\t\tchunk.offsetY -= lineInfo.height / 2 - chunk.height / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"sub\":\n\t\t\t\t\t\t\tchunk.offsetY += chunk.height / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tconst bounds = {\n\t\t\tleft: rtl ? -maxX : -minX,\n\t\t\ttop: 0,\n\t\t\tright: rtl ? minX : maxX,\n\t\t\tbottom: offsetY,\n\t\t};\n\n\n\t\t// We need to fit?\n\t\tif (oversizedBehavior !== \"none\") {\n\t\t\tconst ratio = this._fitRatio(bounds);\n\t\t\tif (ratio < 1) {\n\t\t\t\tif (oversizedBehavior == \"fit\") {\n\t\t\t\t\tif ($type.isNumber(this.style.minScale) && (ratio < this.style.minScale)) {\n\t\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\t\tbounds.top = 0;\n\t\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\t\tbounds.bottom = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (!this._originalScale) {\n\t\t\t\t\t\t\tthis._originalScale = this.scale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.scale = ratio;\n\t\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (oversizedBehavior == \"hide\") {\n\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\tbounds.top = 0;\n\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\tbounds.bottom = 0;\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\tbounds.left = rtl ? maxWidth : -maxWidth;\n\t\t\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\tbounds.left = -maxWidth / 2;\n\t\t\t\t\t\t\tbounds.right = maxWidth / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\t\t\tbounds.right = rtl ? -maxWidth : maxWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.scale = this._originalScale || 1;\n\t\t\t\t\tthis._originalScale = undefined;\n\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.scale = this._originalScale || 1;\n\t\t\t\tthis._originalScale = undefined;\n\t\t\t\tthis.textVisible = true;\n\t\t\t}\n\t\t}\n\n\t\tcontext.restore();\n\t\tghostContext.restore();\n\n\t\treturn bounds;\n\t}\n\n\tprotected _fitRatio(bounds: IBounds): number {\n\t\tconst maxW = this.style.maxWidth;\n\t\tconst maxH = this.style.maxHeight;\n\t\tif (!$type.isNumber(maxW) && !$type.isNumber(maxH)) {\n\t\t\treturn 1;\n\t\t}\n\t\tconst w = bounds.right - bounds.left;\n\t\tconst h = bounds.bottom - bounds.top;\n\t\treturn Math.min(maxW! / w || 1, maxH! / h || 1);\n\t}\n\n\tprotected _truncateText(context: CanvasRenderingContext2D, text: string, maxWidth: number, breakWords: boolean = false, fallbackBreakWords: boolean = true): string {\n\t\tlet width: number;\n\t\tdo {\n\t\t\tif (breakWords) {\n\t\t\t\ttext = text.slice(0, -1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet tmp = text.replace(/[^,;:!?\\\\\\/\\s]+[,;:!?\\\\\\/\\s]*$/g, \"\");\n\t\t\t\tif ((tmp == \"\" || tmp === text) && fallbackBreakWords) {\n\t\t\t\t\tbreakWords = true;\n\t\t\t\t}\n\t\t\t\telse if (tmp == \"\") {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttext = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst metrics = this._measureText(text, context);\n\t\t\twidth = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\t\t} while ((width > maxWidth) && text != \"\");\n\t\treturn text;\n\t}\n\n\tprotected _measureText(text: string, context: CanvasRenderingContext2D): TextMetrics {\n\t\tlet metrics = context.measureText(text);\n\t\tlet fakeMetrics: any = {};\n\t\tif (metrics.actualBoundingBoxAscent == null) {\n\t\t\tconst div = document.createElement(\"div\");\n\t\t\tdiv.innerText = text;\n\t\t\tdiv.style.visibility = \"hidden\";\n\t\t\tdiv.style.position = \"absolute\";\n\t\t\tdiv.style.top = \"-1000000px;\"\n\t\t\tdiv.style.fontFamily = this.style.fontFamily || \"\";\n\t\t\tdiv.style.fontSize = this.style.fontSize + \"\";\n\t\t\tdocument.body.appendChild(div);\n\t\t\tconst bbox = div.getBoundingClientRect();\n\t\t\tdocument.body.removeChild(div);\n\t\t\tconst h = bbox.height;\n\t\t\tconst w = metrics.width;\n\t\t\tlet left = 0;\n\t\t\tlet right = w;\n\n\t\t\tfakeMetrics = {\n\t\t\t\tactualBoundingBoxAscent: h,\n\t\t\t\tactualBoundingBoxDescent: 0,\n\t\t\t\tactualBoundingBoxLeft: left,\n\t\t\t\tactualBoundingBoxRight: right,\n\t\t\t\tfontBoundingBoxAscent: h,\n\t\t\t\tfontBoundingBoxDescent: 0,\n\t\t\t\twidth: w\n\t\t\t}\n\t\t\t//return fake;\n\t\t}\n\t\telse {\n\t\t\tfakeMetrics = {\n\t\t\t\tactualBoundingBoxAscent: metrics.actualBoundingBoxAscent,\n\t\t\t\tactualBoundingBoxDescent: metrics.actualBoundingBoxDescent,\n\t\t\t\tactualBoundingBoxLeft: metrics.actualBoundingBoxLeft,\n\t\t\t\tactualBoundingBoxRight: metrics.actualBoundingBoxRight,\n\t\t\t\tfontBoundingBoxAscent: metrics.actualBoundingBoxAscent,\n\t\t\t\tfontBoundingBoxDescent: metrics.actualBoundingBoxDescent,\n\t\t\t\twidth: metrics.width\n\t\t\t}\n\t\t}\n\n\t\tconst w = metrics.width;\n\t\tswitch (this.style.textAlign) {\n\t\t\tcase \"right\":\n\t\t\tcase \"end\":\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = w;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = w / 2;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = w / 2;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = 0;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = w;\n\t\t}\n\n\t\treturn fakeMetrics;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasTextStyle implements ITextStyle {\n\t//public wordWrapWidth: number = 100;\n\tpublic fill?: Color | CanvasGradient | CanvasPattern;\n\tpublic fillOpacity?: number;\n\tpublic textAlign?: \"start\" | \"end\" | \"left\" | \"right\" | \"center\";\n\tpublic fontFamily?: string;\n\tpublic fontSize?: string | number;\n\tpublic fontWeight?: 'normal' | 'bold' | 'bolder' | 'lighter' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900'\n\tpublic fontStyle?: 'normal' | 'italic' | 'oblique';\n\tpublic fontVariant?: \"normal\" | \"small-caps\";\n\tpublic textDecoration?: \"underline\" | \"line-through\";\n\tpublic shadowColor?: Color | null;\n\tpublic shadowBlur?: number;\n\tpublic shadowOffsetX?: number;\n\tpublic shadowOffsetY?: number;\n\tpublic shadowOpacity?: number;\n\t// leading?: number;\n\t// letterSpacing?: number;\n\tpublic lineHeight?: number | Percent = percent(120);\n\tpublic baselineRatio?: number = 0.19;\n\t// padding?: number;\n\t// stroke?: number;\n\t// strokeThickness?: number;\n\t// trim?: number;\n\t// wordWrap?: boolean;\n\tpublic direction?: \"ltr\" | \"rtl\";\n\tpublic textBaseline?: \"top\" | \"hanging\" | \"middle\" | \"alphabetic\" | \"ideographic\" | \"bottom\";\n\tpublic oversizedBehavior?: \"none\" | \"hide\" | \"fit\" | \"wrap\" | \"wrap-no-break\" | \"truncate\" = \"none\";\n\tpublic breakWords?: boolean = false;\n\tpublic ellipsis?: string = \"\";\n\tpublic maxWidth?: number;\n\tpublic maxHeight?: number;\n\tpublic minScale?: number;\n\tpublic ignoreFormatting?: boolean = false;\n}\n\n/**\n * @ignore\n */\nexport class CanvasRadialText extends CanvasText implements IRadialText {\n\tpublic textType?: \"regular\" | \"circular\" | \"radial\" | \"aligned\" | \"adjusted\" = \"circular\";\n\tpublic radius?: number;\n\tpublic startAngle?: number;\n\tpublic inside?: boolean = false;\n\tpublic orientation?: \"inward\" | \"outward\" | \"auto\" = \"auto\";\n\tpublic kerning?: number = 0;\n\n\tprivate _textReversed: boolean = false;\n\n\tpublic _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tswitch (this.textType) {\n\t\t\tcase \"circular\":\n\t\t\t\tthis._renderCircular(status, targetGhostLayer);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tsuper._render(status, targetGhostLayer);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic _renderCircular(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tif (this.textVisible) {\n\t\t\tthis._prerender(status);\n\n\t\t\tconst interactive = this._isInteractive(status);\n\t\t\tconst context = status.layer.context;\n\t\t\tconst layerDirty = status.layer.dirty;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\t// Savepoint\n\t\t\tcontext.save();\n\t\t\tif (interactive) {\n\t\t\t\tghostContext.save();\n\t\t\t}\n\n\t\t\t// We need measurements in order to properly position text for alignment\n\t\t\tif (!this._textInfo) {\n\t\t\t\tthis._measure(status);\n\t\t\t}\n\n\t\t\t// Init\n\t\t\tlet radius = (this.radius || 0);\n\t\t\tlet startAngle = (this.startAngle || 0);\n\t\t\tlet deltaAngle = 0;\n\t\t\tlet orientation = this.orientation;\n\t\t\tlet inward = orientation == \"auto\" ? \"auto\" : orientation == \"inward\";\n\t\t\tconst inside = this.inside;\n\t\t\tconst align = this.style.textAlign || \"left\";\n\t\t\tconst kerning = this.kerning || 0;\n\t\t\tlet clockwise = align == \"left\" ? 1 : -1;\n\t\t\tconst shouldReverse = !this._textReversed;\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\t// Check if we need to invert the whole stuff\n\t\t\tif (inward == \"auto\") {\n\t\t\t\t// Calc max angle so we know whether we need to flip it\n\t\t\t\tlet maxAngle = 0;\n\t\t\t\tlet midAngle = 0;\n\t\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\t\t\t\t\tconst deltaAngle = startAngle + (line.width / (radius - line.height)) / 2 * -clockwise;\n\t\t\t\t\tif (deltaAngle > maxAngle) {\n\t\t\t\t\t\tmaxAngle = deltaAngle;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (align == \"left\") {\n\t\t\t\t\tmidAngle = (maxAngle + deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\telse if (align == \"right\") {\n\t\t\t\t\tmidAngle = (maxAngle - deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmidAngle = startAngle * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\tmidAngle = $math.normalizeAngle(midAngle);\n\t\t\t\tinward = (midAngle >= 270) || (midAngle <= 90);\n\t\t\t}\n\n\t\t\tif (inward == true && shouldReverse) {\n\t\t\t\tthis._textInfo!.reverse();\n\t\t\t\tthis._textReversed = true;\n\t\t\t}\n\n\t\t\t// if ((inward == false && align == \"left\") || (inward == true && align == \"right\")) {\n\t\t\t// \tclockwise *= -1;\n\t\t\t// }\n\n\t\t\t// Process text info produced by _measure()\n\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\n\t\t\t\tconst textHeight = line.height;\n\n\t\t\t\t// Adjust radius (for `inside = false`)\n\t\t\t\t// Radius adjustment for `inside = false` is below the line calculation\n\t\t\t\tif (!inside) {\n\t\t\t\t\tradius += textHeight;\n\t\t\t\t}\n\n\t\t\t\t// Reverse letters if we're painting them counter-clockwise\n\t\t\t\tif (((clockwise == -1 && inward) || (clockwise == 1 && !inward)) && shouldReverse) {\n\t\t\t\t\tline.textChunks.reverse();\n\t\t\t\t}\n\n\t\t\t\t// Init angles\n\t\t\t\tlet lineStartAngle = startAngle;\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t\t// Adjust for center-align\n\t\t\t\tif (align == \"center\") {\n\t\t\t\t\tlineStartAngle += (line.width / (radius - textHeight)) / 2 * -clockwise;\n\t\t\t\t\tdeltaAngle = lineStartAngle - startAngle;\n\t\t\t\t}\n\n\t\t\t\t// if (inward == \"auto\") {\n\t\t\t\t// \tlet midAngle;\n\t\t\t\t// \tif (align == \"left\") {\n\t\t\t\t// \t\tmidAngle = (lineStartAngle + deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t// \t}\n\t\t\t\t// \telse if () {\n\t\t\t\t// \t\tmidAngle = (lineStartAngle - deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t// \t}\n\t\t\t\t// \tinward = (midAngle >= 270) || (midAngle <= 90);\n\t\t\t\t// }\n\n\t\t\t\t// Rotate letters if they are facing outward\n\t\t\t\tlineStartAngle += (Math.PI * (inward ? 0 : 1)); // Rotate 180 if outward\n\n\t\t\t\t// Savepoint\n\t\t\t\tcontext.save();\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.save();\n\t\t\t\t}\n\n\t\t\t\t// Assume starting angle\n\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\tcontext.rotate(lineStartAngle);\n\t\t\t\t}\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.rotate(lineStartAngle);\n\t\t\t\t}\n\n\t\t\t\tlet angleShift = 0;\n\t\t\t\t$array.each(line.textChunks, (chunk, _index) => {\n\n\t\t\t\t\t// Draw the letter\n\t\t\t\t\tconst char = chunk.text;\n\t\t\t\t\tconst charWidth = chunk.width;\n\n\t\t\t\t\t// Rotate half a letter\n\t\t\t\t\tangleShift = (charWidth / 2) / (radius - textHeight) * clockwise;\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.rotate(angleShift);\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.rotate(angleShift);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Set style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\t\tghostContext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.fillStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Center letters\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\t\tcontext.textAlign = \"center\";\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.textBaseline = \"middle\";\n\t\t\t\t\t\tghostContext.textAlign = \"center\";\n\t\t\t\t\t}\n\n\t\t\t\t\t// Plop the letter\n\t\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\t\tcontext.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive && drawGhost) {\n\t\t\t\t\t\tghostContext.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reset style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Rotate half a letter and add spacing\n\t\t\t\t\tangleShift = (charWidth / 2 + kerning) / (radius - textHeight) * clockwise;\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.rotate(angleShift);\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.rotate(angleShift);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\t// Restore angle\n\t\t\t\tcontext.restore();\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.restore();\n\t\t\t\t}\n\n\t\t\t\t// Adjust radius (for `inside = true`)\n\t\t\t\tif (inside) {\n\t\t\t\t\tradius -= textHeight;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t// Restore\n\t\t\tcontext.restore();\n\t\t\tif (interactive) {\n\t\t\t\tghostContext.restore();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _measure(status: IStatus): IBounds {\n\t\tswitch (this.textType) {\n\t\t\tcase \"circular\":\n\t\t\t\treturn this._measureCircular(status);\n\t\t\tdefault:\n\t\t\t\treturn super._measure(status);\n\t\t}\n\t}\n\n\tpublic _measureCircular(status: IStatus): IBounds {\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\t\tconst rtl = this.style.direction == \"rtl\";\n\n\t\tconst oversizedBehavior = this.style.oversizedBehavior;\n\t\tconst maxWidth = this.style.maxWidth!;\n\n\t\tconst truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\n\t\tconst ellipsis = this.style.ellipsis || \"\";\n\t\tlet ellipsisMetrics: TextMetrics;\n\t\t//const wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\n\n\n\t\t// Reset text info\n\t\tthis.textVisible = true;\n\t\tthis._textInfo = [];\n\t\tthis._textReversed = false;\n\n\t\t// Pre-render\n\t\tcontext.save();\n\t\tghostContext.save();\n\t\tthis._prerender(status, true);\n\n\t\t// Split up text into lines\n\t\tconst lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\tlet styleRestored = true;\n\t\tlet totalWidth = 0;\n\n\t\t// Iterate through the lines\n\t\tlet offsetY = 0;\n\t\t$array.each(lines, (line, _index) => {\n\n\t\t\t// Split up line into format/value chunks\n\t\t\tlet chunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\n\n\t\t\t// Init line object\n\t\t\tlet lineInfo: ILine = {\n\t\t\t\toffsetY: offsetY,\n\t\t\t\tascent: 0,\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttextChunks: []\n\t\t\t};\n\n\t\t\tlet currentStyle: string | undefined;\n\t\t\tlet currentFill: Color | undefined;\n\t\t\tlet currentChunkWidth: number | undefined;\n\n\t\t\t//while(chunk = chunks.shift()) {\n\t\t\t$array.each(chunks, (chunk, _index) => {\n\n\t\t\t\t// Format chunk\n\t\t\t\tif (chunk.type == \"format\") {\n\t\t\t\t\tif (chunk.text == \"[/]\") {\n\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\tstyleRestored = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentFill = undefined;\n\t\t\t\t\t\tcurrentStyle = undefined;\n\t\t\t\t\t\tcurrentChunkWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet format = TextFormatter.getTextStyle(chunk.text);\n\t\t\t\t\t\tconst fontStyle = this._getFontStyle(format);\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\t\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\t\tcurrentStyle = fontStyle;\n\t\t\t\t\t\tif (format.fill) {\n\t\t\t\t\t\t\tcurrentFill = <Color>format.fill;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((<any>format).width) {\n\t\t\t\t\t\t\tcurrentChunkWidth = $type.toNumber((<any>format).width);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyleRestored = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (truncate) {\n\t\t\t\t\t\tellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Text format\n\t\t\t\telse if (chunk.type == \"value\") {\n\n\t\t\t\t\t// Measure each letter\n\t\t\t\t\tlet chars = chunk.text.match(/./ug) || [];\n\t\t\t\t\tif (rtl) {\n\t\t\t\t\t\tchars = $utils.splitString(chunk.text);\n\t\t\t\t\t\tchars.reverse();\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < chars.length; i++) {\n\n\t\t\t\t\t\tconst char = chars[i];\n\n\t\t\t\t\t\t// Measure\n\t\t\t\t\t\tconst metrics = this._measureText(char, context);\n\t\t\t\t\t\tlet chunkWidth = metrics.width;\n\n\t\t\t\t\t\t// Chunk width?\n\t\t\t\t\t\tif (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\n\t\t\t\t\t\t\tchunkWidth = currentChunkWidth;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\t\t\tif (chunkHeight > lineInfo.height) {\n\t\t\t\t\t\t\tlineInfo.height = chunkHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttotalWidth += chunkWidth;\n\n\t\t\t\t\t\t// Handle oversized behavior\n\t\t\t\t\t\tif (truncate) {\n\t\t\t\t\t\t\t// Measure ellipsis and check if it fits\n\t\t\t\t\t\t\tif (!ellipsisMetrics) {\n\t\t\t\t\t\t\t\tellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\n\t\t\t\t\t\t\t//totalWidth += ellipsisWidth;\n\t\t\t\t\t\t\tif ((totalWidth + ellipsisWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tif (lineInfo.textChunks.length == 1) {\n\t\t\t\t\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tlineInfo.width += ellipsisWidth;\n\t\t\t\t\t\t\t\t\tlineInfo.left += ellipsisMetrics.actualBoundingBoxLeft;\n\t\t\t\t\t\t\t\t\tlineInfo.right += ellipsisMetrics.actualBoundingBoxRight;\n\t\t\t\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\t\t\t\ttext: ellipsis,\n\t\t\t\t\t\t\t\t\t\twidth: ellipsisWidth,\n\t\t\t\t\t\t\t\t\t\theight: chunkHeight + ellipsisMetrics.actualBoundingBoxDescent,\n\t\t\t\t\t\t\t\t\t\tleft: ellipsisMetrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\t\t\t\tright: ellipsisMetrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\t\t\t\tascent: ellipsisMetrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\t\t\t\toffsetY: chunkHeight,\n\t\t\t\t\t\t\t\t\t\ttextDecoration: undefined\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlineInfo.width += chunkWidth;\n\t\t\t\t\t\tlineInfo.left += metrics.actualBoundingBoxLeft;\n\t\t\t\t\t\tlineInfo.right += metrics.actualBoundingBoxRight;\n\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\ttext: char,\n\t\t\t\t\t\t\twidth: chunkWidth,\n\t\t\t\t\t\t\theight: chunkHeight + metrics.actualBoundingBoxDescent,\n\t\t\t\t\t\t\tleft: metrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\tright: metrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\tascent: metrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\toffsetY: chunkHeight,\n\t\t\t\t\t\t\ttextDecoration: undefined\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (rtl) {\n\t\t\t\t\t\t\t// @todo still needed?\n\t\t\t\t\t\t\t//break;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.style.lineHeight instanceof Percent) {\n\t\t\t\tlineInfo.height *= this.style.lineHeight.value;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlineInfo.height *= this.style.lineHeight || 1.2;\n\t\t\t}\n\n\t\t\tthis._textInfo!.push(lineInfo);\n\n\t\t\t//lineInfo.offsetY += lineInfo.ascent;\n\t\t\toffsetY += lineInfo.height;\n\n\n\t\t});\n\n\t\tif (!styleRestored) {\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\n\n\t\tif (oversizedBehavior == \"hide\" && (totalWidth > maxWidth)) {\n\t\t\tthis.textVisible = false;\n\t\t}\n\n\t\t// Adjust chunk internal offsets\n\t\t$array.each(this._textInfo, (lineInfo) => {\n\t\t\t$array.each(lineInfo.textChunks, (chunk) => {\n\t\t\t\tchunk.offsetY += Math.round((lineInfo.height - chunk.height + (lineInfo.ascent - chunk.ascent)) / 2);\n\t\t\t});\n\t\t});\n\n\t\tcontext.restore();\n\t\tghostContext.restore();\n\n\t\treturn {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t};\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasImage extends CanvasDisplayObject implements IPicture {\n\tpublic width: number | undefined;\n\tpublic height: number | undefined;\n\tpublic image: HTMLImageElement | undefined;\n\tpublic tainted?: boolean;\n\n\tpublic shadowColor?: Color;\n\tpublic shadowBlur?: number;\n\tpublic shadowOffsetX?: number;\n\tpublic shadowOffsetY?: number;\n\tpublic shadowOpacity?: number;\n\n\tprotected _imageMask: HTMLCanvasElement | undefined;\n\n\tconstructor(renderer: CanvasRenderer, image: HTMLImageElement | undefined) {\n\t\tsuper(renderer);\n\t\tthis.image = image;\n\t}\n\n\tprotected _dispose(): void {\n\t\tsuper._dispose();\n\n\t\tif (this._imageMask) {\n\t\t\tclearCanvas(this._imageMask);\n\t\t}\n\t}\n\n\tgetLocalBounds(): IBounds {\n\t\tif (!this._localBounds) {\n\n\n\t\t\tlet w = 0;\n\t\t\tlet h = 0;\n\n\t\t\tif (this.width) {\n\t\t\t\tw = this.width;\n\t\t\t}\n\t\t\tif (this.height) {\n\t\t\t\th = this.height;\n\t\t\t}\n\n\t\t\tthis._localBounds = {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tright: w,\n\t\t\t\tbottom: h\n\t\t\t};\n\n\t\t\tthis._addBounds(this._localBounds);\n\t\t}\n\t\treturn this._localBounds;\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tsuper._render(status);\n\n\t\tif (this.image) {\n\t\t\tif (this.tainted === undefined) {\n\t\t\t\tthis.tainted = isTainted(this.image);\n\t\t\t\tstatus.layer.tainted = true;\n\t\t\t}\n\n\t\t\tif (this.tainted && this._renderer._omitTainted) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\tif (status.layer.dirty && !ghostOnly) {\n\n\t\t\t\tif (this.shadowColor) {\n\t\t\t\t\tstatus.layer.context.shadowColor = this.shadowColor.toCSS(this.shadowOpacity || 1);\n\t\t\t\t}\n\t\t\t\tif (this.shadowBlur) {\n\t\t\t\t\tstatus.layer.context.shadowBlur = this.shadowBlur;\n\t\t\t\t}\n\t\t\t\tif (this.shadowOffsetX) {\n\t\t\t\t\tstatus.layer.context.shadowOffsetX = this.shadowOffsetX;\n\t\t\t\t}\n\t\t\t\tif (this.shadowOffsetY) {\n\t\t\t\t\tstatus.layer.context.shadowOffsetY = this.shadowOffsetY;\n\t\t\t\t}\n\n\t\t\t\t// TODO should this round ?\n\t\t\t\tconst width = this.width || this.image.naturalWidth;\n\t\t\t\tconst height = this.height || this.image.naturalHeight;\n\n\t\t\t\tstatus.layer.context.drawImage(this.image, 0, 0, width, height);\n\t\t\t}\n\n\t\t\tif (this.interactive && this._isInteractive(status) && drawGhost) {\n\t\t\t\tconst mask = this._getMask(this.image);\n\n\t\t\t\tthis._renderer._ghostLayer.context.drawImage(mask, 0, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tsuper.clear();\n\t\tthis.image = undefined;\n\t\tthis._imageMask = undefined;\n\t}\n\n\tprotected _getMask(image: HTMLImageElement): HTMLCanvasElement {\n\t\tif (this._imageMask === undefined) {\n\t\t\t// TODO should this round ?\n\t\t\tconst width = this.width || image.naturalWidth;\n\t\t\tconst height = this.height || image.naturalHeight;\n\n\t\t\t// We need to create a second canvas because destination-in clears out the entire canvas\n\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\n\t\t\tconst context = canvas.getContext(\"2d\")!;\n\n\t\t\tcontext.imageSmoothingEnabled = false;\n\n\t\t\tcontext.fillStyle = this._getColorId();\n\t\t\tcontext.fillRect(0, 0, width, height);\n\n\t\t\tif (!isTainted(image)) {\n\t\t\t\tcontext.globalCompositeOperation = \"destination-in\";\n\t\t\t\tcontext.drawImage(image, 0, 0, width, height);\n\t\t\t}\n\n\t\t\tthis._imageMask = canvas;\n\t\t}\n\n\t\treturn this._imageMask;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasRendererEvent<A> implements IRendererEvent<A> {\n\tpublic id: Id;\n\tpublic simulated: boolean = false;\n\tpublic native: boolean = true;\n\n\tconstructor(public event: A, public originalPoint: IPoint, public point: IPoint, public bbox: DOMRect) {\n\t\tif ($utils.supports(\"touchevents\") && event instanceof Touch) {\n\t\t\tthis.id = event.identifier;\n\n\t\t} else {\n\t\t\tthis.id = null;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\ninterface IEvent<Key extends keyof IRendererEvents> {\n\tobject: CanvasDisplayObject;\n\tcontext: unknown;\n\tcallback: (event: IRendererEvents[Key]) => void;\n\tdisposed: boolean;\n}\n\n/**\n * @ignore\n */\ninterface IEvents<Key extends keyof IRendererEvents> {\n\tdisposer: IDisposer;\n\tcallbacks: Array<IEvent<Key>>;\n\tdispatching: boolean;\n\tcleanup: boolean;\n}\n\n/**\n * @ignore\n */\nexport class CanvasRenderer extends ArrayDisposer implements IRenderer, IDisposer {\n\tpublic view: HTMLElement = document.createElement(\"div\");\n\tprotected _layerDom: HTMLElement = document.createElement(\"div\");\n\n\tpublic layers: Array<CanvasLayer> = [];\n\tpublic _dirtyLayers: Array<CanvasLayer> = [];\n\tpublic defaultLayer: CanvasLayer = this.getLayer(0);\n\n\tpublic _ghostLayer: GhostLayer = new GhostLayer();\n\n\tpublic _deferredGhostLayers: Array<number> = [];\n\n\tprotected _patternCanvas: HTMLCanvasElement = document.createElement(\"canvas\");\n\tprotected _patternContext: CanvasRenderingContext2D = this._patternCanvas.getContext(\"2d\")!;\n\n\tprotected _realWidth: number = 0;\n\tprotected _realHeight: number = 0;\n\n\tprotected _calculatedWidth: number = 0;\n\tprotected _calculatedHeight: number = 0;\n\n\tpublic resolution: number;\n\tpublic interactionsEnabled: boolean = true;\n\n\tprotected _listeners: { [key: string]: CounterDisposer } = {};\n\tprotected _events: { [Key in keyof IRendererEvents]?: IEvents<Key> } = {};\n\n\tprotected _colorId: number = 0;\n\tprotected _colorMap: { [color: string]: CanvasDisplayObject } = {};\n\n\tpublic _forceInteractive: number = 0;\n\tpublic _omitTainted: boolean = false;\n\n\t// TODO this should store the Id as well\n\tpublic _hovering: Set<CanvasDisplayObject> = new Set();\n\tpublic _dragging: Array<{ id: Id, value: CanvasDisplayObject }> = [];\n\tpublic _mousedown: Array<{ id: Id, value: CanvasDisplayObject }> = [];\n\n\tprotected _lastPointerMoveEvent: { events: Array<IPointerEvent>, target: Node | null, native: boolean } | undefined;\n\n\tpublic tapToActivate: boolean = false;\n\tpublic tapToActivateTimeout: number = 3000;\n\tpublic _touchActive: boolean = false;\n\tprotected _touchActiveTimeout?: number;\n\n\t/*protected _mouseMoveThrottler: Throttler = new Throttler(() => {\n\t\tthis._dispatchGlobalMousemove(this._lastPointerMoveEvent.event, this._lastPointerMoveEvent.native);\n\t});\n\t*/\n\n\tpublic resetImageArray() {\n\t\tthis._ghostLayer.imageArray = undefined;\n\t}\n\n\tconstructor(resolution?: number) {\n\t\tsuper();\n\n\t\tif (resolution == null) {\n\t\t\tthis.resolution = window.devicePixelRatio;\n\t\t} else {\n\t\t\tthis.resolution = resolution;\n\t\t}\n\n\t\tthis.view.style.position = \"absolute\";\n\t\tthis.view.setAttribute(\"aria-hidden\", \"true\");\n\t\tthis.view.appendChild(this._layerDom);\n\n\t\tthis._disposers.push(new Disposer(() => {\n\t\t\t$object.each(this._events, (_key, events) => {\n\t\t\t\tevents.disposer.dispose();\n\t\t\t});\n\n\t\t\t$array.each(this.layers, (layer) => {\n\t\t\t\tclearCanvas(layer.view);\n\n\t\t\t\tif (layer.exportableView) {\n\t\t\t\t\tclearCanvas(layer.exportableView);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tclearCanvas(this._ghostLayer.view);\n\t\t\tclearCanvas(this._patternCanvas);\n\t\t}));\n\n\t\t/*\n\t\tthis._disposers.push($utils.addEventListener(this._ghostLayer.view, \"click\", (originalEvent: MouseEvent) => {\n\t\t\tconst event = this.getEvent(originalEvent);\n\t\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox);\n\t\t\tconsole.debug(target);\n\t\t}));\n\t\t*/\n\n\t\t// Monitor for possible pixel ratio changes (when page is zoomed)\n\t\tthis._disposers.push($utils.onZoom(() => {\n\t\t\tif (resolution == null) {\n\t\t\t\tthis.resolution = window.devicePixelRatio;\n\t\t\t}\n\t\t}));\n\n\t\t// We need this in order top prevent default touch gestures when dragging\n\t\t// draggable elements\n\t\tif ($utils.supports(\"touchevents\")) {\n\t\t\tconst listener = (ev: any) => {\n\t\t\t\tif (this._dragging.length !== 0) {\n\t\t\t\t\t$array.eachContinue(this._dragging, (item) => {\n\t\t\t\t\t\tif (item.value.shouldCancelTouch()) {\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// If touch down happends, delay touch out\n\t\t\t\tif (this._touchActiveTimeout) {\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"touchstart\", listener, { passive: false }));\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"touchstart\", listener, { passive: false }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"touchmove\", () => {\n\t\t\t\t// If touch is moving, delay touch out\n\t\t\t\tif (this._touchActiveTimeout) {\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}\n\t\t\t}, { passive: true }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"click\", (_ev: any) => {\n\t\t\t\tthis._touchActive = false;\n\t\t\t}, { passive: true }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"click\", (_ev: any) => {\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tthis._touchActive = true;\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}, 100);\n\t\t\t}, { passive: true }));\n\n\t\t}\n\n\t\t// Prevent scrolling of the window when hovering on \"wheelable\" object\n\t\tif ($utils.supports(\"wheelevents\")) {\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"wheel\", (ev) => {\n\t\t\t\tlet prevent = false;\n\t\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\t\tif (obj.wheelable) {\n\t\t\t\t\t\tprevent = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (prevent) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t}\n\t\t\t}, { passive: false }));\n\t\t}\n\n\t}\n\n\tprotected _delayTouchDeactivate(): void {\n\t\tif (this._touchActiveTimeout) {\n\t\t\tclearTimeout(this._touchActiveTimeout);\n\t\t}\n\t\tif (this.tapToActivateTimeout > 0) {\n\t\t\tthis._touchActiveTimeout = window.setTimeout(() => {\n\t\t\t\tthis._touchActive = false;\n\t\t\t}, this.tapToActivateTimeout);\n\t\t}\n\t}\n\n\tpublic get debugGhostView(): boolean {\n\t\treturn !!this._ghostLayer.view.parentNode;\n\t}\n\n\tpublic set debugGhostView(value: boolean) {\n\t\tif (value) {\n\t\t\tif (!this._ghostLayer.view.parentNode) {\n\t\t\t\tthis.view.appendChild(this._ghostLayer.view);\n\t\t\t}\n\n\t\t} else {\n\t\t\tif (this._ghostLayer.view.parentNode) {\n\t\t\t\tthis._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateLinearGradient(x1: number, y1: number, x2: number, y2: number): CanvasGradient {\n\t\treturn this.defaultLayer.context.createLinearGradient(x1, y1, x2, y2);\n\t}\n\n\tcreateRadialGradient(x1: number, y1: number, radius1: number, x2: number, y2: number, radius2: number): CanvasGradient {\n\t\treturn this.defaultLayer.context.createRadialGradient(x1, y1, radius1, x2, y2, radius2);\n\t}\n\n\tcreatePattern(graphics: CanvasGraphics, background: CanvasGraphics, repetition: string, width: number, height: number): CanvasPattern {\n\t\t// const patternCanvas = document.createElement(\"canvas\");\n\t\t// const patternContext = patternCanvas.getContext(\"2d\")!;\n\t\t// patternCanvas.width = width;\n\t\t// patternCanvas.height = height;\n\t\t// if (fill) {\n\t\t// \tpatternContext.fillStyle = fill.toCSS();\n\t\t// \tpatternContext.fillRect(0, 0, patternCanvas.width, patternCanvas.height);\n\t\t// }\n\n\t\t// const layer = {\n\t\t// \tview: patternCanvas,\n\t\t// \tcontext: patternContext,\n\t\t// \tvisible: true,\n\t\t// \torder: 0,\n\t\t// \twidth: width,\n\t\t// \theight: height,\n\t\t// \tdirty: true\n\t\t// };\n\n\t\t// // patternContext.arc(0, 0, 50, 0, .5 * Math.PI);\n\t\t// // patternContext.stroke();\n\n\t\t// image.targetLayer = layer;\n\t\t// image.render(layer);\n\n\t\t//this._layerDom.appendChild(patternCanvas);\n\n\t\tthis._patternCanvas.width = width;\n\t\tthis._patternCanvas.height = height;\n\n\t\tthis._patternContext.clearRect(0, 0, width, height);\n\n\t\t// patternCanvas.style.width = width * this.resolution + \"px\";\n\t\t// patternCanvas.style.height = height * this.resolution + \"px\";\n\n\t\tbackground.renderDetached(this._patternContext);\n\t\tgraphics.renderDetached(this._patternContext);\n\n\t\treturn this._patternContext.createPattern(this._patternCanvas, repetition)!;\n\t}\n\n\n\n\tmakeContainer(): CanvasContainer {\n\t\treturn new CanvasContainer(this);\n\t}\n\n\tmakeGraphics(): CanvasGraphics {\n\t\treturn new CanvasGraphics(this);\n\t}\n\n\tmakeText(text: string, style: CanvasTextStyle): CanvasText {\n\t\treturn new CanvasText(this, text, style);\n\t}\n\n\tmakeTextStyle(): CanvasTextStyle {\n\t\treturn new CanvasTextStyle();\n\t}\n\n\tmakeRadialText(text: string, style: CanvasTextStyle): CanvasRadialText {\n\t\treturn new CanvasRadialText(this, text, style);\n\t}\n\n\tmakePicture(image: HTMLImageElement | undefined): CanvasImage {\n\t\treturn new CanvasImage(this, image);\n\t}\n\n\tresizeLayer(layer: CanvasLayer) {\n\t\tlayer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\n\t}\n\n\tresizeGhost() {\n\t\tthis._ghostLayer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\n\t}\n\n\tresize(realWidth: number, realHeight: number, calculatedWidth: number, calculatedHeight: number): void {\n\t\tthis._realWidth = realWidth;\n\t\tthis._realHeight = realHeight;\n\n\t\tthis._calculatedWidth = calculatedWidth;\n\t\tthis._calculatedHeight = calculatedHeight;\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tlayer.dirty = true;\n\t\t\t\tthis.resizeLayer(layer);\n\t\t\t}\n\t\t});\n\n\t\tthis.resizeGhost();\n\n\t\tthis.view.style.width = calculatedWidth + \"px\";\n\t\tthis.view.style.height = calculatedHeight + \"px\";\n\t}\n\n\tprivate createDetachedLayer(willReadFrequently: boolean = false): CanvasLayer {\n\t\tconst view = document.createElement(\"canvas\");\n\t\tconst context = view.getContext(\"2d\", { willReadFrequently: willReadFrequently })! as CanvasRenderingContext2D;\n\n\t\tconst layer = new CanvasLayer(view, context);\n\n\t\tview.style.position = \"absolute\";\n\t\tview.style.top = \"0px\";\n\t\tview.style.left = \"0px\";\n\n\t\treturn layer;\n\t}\n\n\tgetLayerByOrder(order: number): CanvasLayer | undefined {\n\t\tconst layers = this.layers;\n\t\tconst length = layers.length;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst layer = layers[i];\n\t\t\tif (layer.order == order) {\n\t\t\t\treturn layer;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLayer(order: number, visible: boolean = true): CanvasLayer {\n\t\tlet existingLayer = this.getLayerByOrder(order);\n\t\tif (existingLayer) {\n\t\t\treturn existingLayer;\n\t\t}\n\n\t\tconst layer = this.createDetachedLayer(order == 99);\n\t\tlayer.order = order;\n\t\tlayer.visible = visible;\n\n\t\tlayer.view.className = \"am5-layer-\" + order;\n\n\t\tif (layer.visible) {\n\t\t\tthis.resizeLayer(layer);\n\t\t}\n\n\t\tconst layers = this.layers;\n\n\t\tlayers.push(layer);\n\n\t\tlayers.sort((a, b) => {\n\t\t\tif (a.order > b.order) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (a.order < b.order) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tconst length = layers.length;\n\t\tconst layerIndex = $array.indexOf(layers, layer);\n\t\tlet next;\n\n\t\tfor (let i = layerIndex + 1; i < length; i++) {\n\t\t\tif (layers[i].visible) {\n\t\t\t\tnext = layers[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (layer.visible) {\n\t\t\tif (next === undefined) {\n\t\t\t\tthis._layerDom.appendChild(layer.view);\n\n\t\t\t} else {\n\t\t\t\tthis._layerDom.insertBefore(layer.view, next.view);\n\t\t\t}\n\t\t}\n\n\t\treturn layer;\n\t}\n\n\trender(root: CanvasDisplayObject): void {\n\n\t\tthis._dirtyLayers.length = 0;\n\t\tthis._deferredGhostLayers = [];\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tif (layer.dirty && layer.visible) {\n\t\t\t\t\tthis._dirtyLayers.push(layer);\n\t\t\t\t\tlayer.clear();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._ghostLayer.clear();\n\n\t\troot.render({\n\t\t\tinactive: null,\n\t\t\tlayer: this.defaultLayer,\n\t\t});\n\n\t\tconst deferredGhostLayers = this._deferredGhostLayers;\n\t\tif (deferredGhostLayers.length) {\n\t\t\tdeferredGhostLayers.sort((a, b) => a - b);\n\t\t\t$array.each(deferredGhostLayers, (layerx) => {\n\t\t\t\troot.render({\n\t\t\t\t\tinactive: null,\n\t\t\t\t\tlayer: this.defaultLayer\n\t\t\t\t}, layerx);\n\t\t\t});\n\t\t}\n\n\t\tthis._ghostLayer.context.restore();\n\n\t\t//setTimeout(() => {\n\n\t\t// Remove this after the Chrome bug is fixed:\n\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=1279394\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tconst context = layer.context;\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(0, 0);\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t});\n\n\t\t$array.each(this._dirtyLayers, (layer) => {\n\t\t\tlayer.context.restore();\n\t\t\tlayer.dirty = false;\n\t\t});\n\t\t//}, 100)\n\n\t\tif (this._hovering.size && this._lastPointerMoveEvent) {\n\t\t\tconst { events, target, native } = this._lastPointerMoveEvent;\n\n\t\t\t//this._mouseMoveThrottler.run();\n\n\t\t\t$array.each(events, (event) => {\n\t\t\t\tthis._dispatchGlobalMousemove(event, target, native);\n\t\t\t});\n\t\t}\n\t}\n\n\tpaintId(obj: CanvasDisplayObject): string {\n\t\tconst id = distributeId(++this._colorId);\n\t\tconst color = Color.fromHex(id).toCSS();\n\t\tthis._colorMap[color] = obj;\n\t\treturn color;\n\t}\n\n\t_removeObject(obj: CanvasDisplayObject): void {\n\t\tif (obj._colorId !== undefined) {\n\t\t\tdelete this._colorMap[obj._colorId];\n\t\t}\n\t}\n\n\t// protected _identifyObjectByColor(colorId: number): CanvasDisplayObject | undefined {\n\t// \treturn this._colorMap[colorId];\n\t// }\n\n\tprotected _adjustBoundingBox(bbox: DOMRect): DOMRect {\n\t\tconst margin = this._ghostLayer.margin;\n\n\t\treturn new DOMRect(\n\t\t\t-margin.left,\n\t\t\t-margin.top,\n\t\t\tbbox.width + margin.left + margin.right,\n\t\t\tbbox.height + margin.top + margin.bottom,\n\t\t);\n\t}\n\n\tpublic getEvent<A extends IPointerEvent>(originalEvent: A, adjustPoint: boolean = true): CanvasRendererEvent<A> {\n\t\tconst bbox = this.view.getBoundingClientRect();\n\n\t\tconst x = originalEvent.clientX || 0;\n\t\tconst y = originalEvent.clientY || 0;\n\n\t\tconst widthScale = this._calculatedWidth / this._realWidth;\n\t\tconst heightScale = this._calculatedHeight / this._realHeight;\n\n\t\tconst originalPoint: IPoint = {\n\t\t\tx: x - bbox.left,\n\t\t\ty: y - bbox.top,\n\t\t};\n\n\t\tconst point: IPoint = {\n\t\t\tx: (x - (adjustPoint ? bbox.left : 0)) * widthScale,\n\t\t\ty: (y - (adjustPoint ? bbox.top : 0)) * heightScale,\n\t\t};\n\n\t\treturn new CanvasRendererEvent(\n\t\t\toriginalEvent,\n\t\t\toriginalPoint,\n\t\t\tpoint,\n\t\t\tthis._adjustBoundingBox(bbox),\n\t\t);\n\t}\n\n\t_getHitTarget(point: IPoint, bbox: DOMRect, target: Node | null): CanvasDisplayObject | undefined | false {\n\t\tif (bbox.width === 0 || bbox.height === 0 || point.x < bbox.left || point.x > bbox.right || point.y < bbox.top || point.y > bbox.bottom) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!target || !this._layerDom.contains(target)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pixel = this._ghostLayer.getImageData(point, bbox);\n\n\t\tif (pixel.data[0] === 0 && pixel.data[1] === 0 && pixel.data[2] === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tconst colorId = Color.fromRGB(pixel.data[0], pixel.data[1], pixel.data[2]).toCSS();\n\t\tconst hit = this._colorMap[colorId];\n\n\t\treturn hit;\n\t}\n\n\tgetObjectAtPoint(point: IPoint): CanvasDisplayObject | undefined {\n\t\tconst data = this._ghostLayer.getImageArray(point);\n\n\t\tif (data[0] === 0 && data[1] === 0 && data[2] === 0) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst colorId = Color.fromRGB(data[0], data[1], data[2]).toCSS();\n\t\tconst hit = this._colorMap[colorId];\n\n\t\treturn hit;\n\t}\n\n\t_withEvents<Key extends keyof IRendererEvents>(key: Key, f: (events: IEvents<Key>) => void): void {\n\t\tconst events = this._events[key] as IEvents<Key> | undefined;\n\n\t\tif (events !== undefined) {\n\t\t\tevents.dispatching = true;\n\n\t\t\ttry {\n\t\t\t\tf(events);\n\n\t\t\t} finally {\n\t\t\t\tevents.dispatching = false;\n\n\t\t\t\tif (events.cleanup) {\n\t\t\t\t\tevents.cleanup = false;\n\n\t\t\t\t\t$array.keepIf(events.callbacks, (callback) => {\n\t\t\t\t\t\treturn !callback.disposed;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (events.callbacks.length === 0) {\n\t\t\t\t\t\tevents.disposer.dispose();\n\t\t\t\t\t\tdelete this._events[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t_dispatchEventAll<Key extends keyof IRendererEvents>(key: Key, event: IRendererEvents[Key]): void {\n\t\tif (!this.interactionsEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._withEvents(key, (events) => {\n\t\t\t$array.each(events.callbacks, (callback) => {\n\t\t\t\tif (!callback.disposed) {\n\t\t\t\t\tcallback.callback.call(callback.context, event);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t_dispatchEvent<Key extends keyof IRendererEvents>(key: Key, target: CanvasDisplayObject, event: IRendererEvents[Key]): boolean {\n\t\tif (!this.interactionsEnabled) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet dispatched = false;\n\n\t\tthis._withEvents(key, (events) => {\n\t\t\t$array.each(events.callbacks, (callback) => {\n\t\t\t\tif (!callback.disposed && callback.object === target) {\n\t\t\t\t\tcallback.callback.call(callback.context, event);\n\t\t\t\t\tdispatched = true;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn dispatched;\n\t}\n\n\t_dispatchMousedown(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst button = (<PointerEvent>originalEvent).button;\n\t\tif (button != 0 && button != 2 && button != 1 && button !== undefined) {\n\t\t\t// Ignore non-primary mouse buttons\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\n\t\tif (target) {\n\t\t\tconst id = event.id;\n\n\t\t\tlet dragged = false;\n\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tconst info = { id: id, value: obj };\n\n\t\t\t\tthis._mousedown.push(info);\n\n\t\t\t\tif (!dragged && this._dispatchEvent(\"pointerdown\", obj, event)) {\n\t\t\t\t\t// Only dispatch the first element which matches\n\t\t\t\t\tdragged = true;\n\n\t\t\t\t\tconst has = this._dragging.some((x) => {\n\t\t\t\t\t\treturn x.value === obj && x.id === id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!has) {\n\t\t\t\t\t\tthis._dragging.push(info);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchGlobalMousemove(originalEvent: IPointerEvent, originalTarget: Node | null, native: boolean): void {\n\t\tconst event = this.getEvent(originalEvent);\n\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\t\tevent.native = native;\n\n\t\tif (target) {\n\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\tif (!obj.contains(target)) {\n\t\t\t\t\tthis._hovering.delete(obj);\n\t\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle!);\n\t\t\t\t\t}\n\t\t\t\t\tthis._dispatchEvent(\"pointerout\", obj, event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (event.native) {\n\t\t\t\teachTargets(target, (obj) => {\n\t\t\t\t\tif (!this._hovering.has(obj)) {\n\t\t\t\t\t\tthis._hovering.add(obj);\n\t\t\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t\t\tobj._replacedCursorStyle = $utils.getStyle(document.body, \"cursor\");\n\t\t\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj.cursorOverStyle);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._dispatchEvent(\"pointerover\", obj, event);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//} else if (target === false) {\n\t\t} else {\n\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle!);\n\t\t\t\t}\n\t\t\t\tthis._dispatchEvent(\"pointerout\", obj, event);\n\t\t\t});\n\n\t\t\tthis._hovering.clear();\n\t\t}\n\t\tthis._dispatchEventAll(\"globalpointermove\", event);\n\t}\n\n\tremoveHovering(graphics: CanvasGraphics) {\n\t\tthis._hovering.delete(graphics);\n\t\tif (graphics.cursorOverStyle) {\n\t\t\t$utils.setStyle(document.body, \"cursor\", graphics._replacedCursorStyle!);\n\t\t}\n\t}\n\n\t_dispatchGlobalMouseup(originalEvent: IPointerEvent, native: boolean): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tevent.native = native;\n\t\t//const target = this._getHitTarget(event.originalPoint);\n\t\tthis._dispatchEventAll(\"globalpointerup\", event);\n\t}\n\n\t_dispatchDragMove(originalEvent: IPointerEvent): void {\n\t\tif (this._dragging.length !== 0) {\n\t\t\tconst event = this.getEvent(originalEvent);\n\t\t\tconst id = event.id;\n\n\t\t\tthis._dragging.forEach((obj) => {\n\t\t\t\tif (obj.id === id) {\n\t\t\t\t\tthis._dispatchEvent(\"pointermove\", obj.value, event);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchDragEnd(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst button = (<PointerEvent>originalEvent).button;\n\t\tlet clickevent: \"click\" | \"rightclick\" | \"middleclick\";\n\t\tif (button == 0 || button === undefined) {\n\t\t\tclickevent = \"click\";\n\t\t}\n\t\telse if (button == 2) {\n\t\t\tclickevent = \"rightclick\";\n\t\t}\n\t\telse if (button == 1) {\n\t\t\tclickevent = \"middleclick\";\n\t\t}\n\t\telse {\n\t\t\t// Ignore non-primary mouse buttons\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst id = event.id;\n\n\t\tif (this._mousedown.length !== 0) {\n\t\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\t\tif (target) {\n\t\t\t\tthis._mousedown.forEach((obj) => {\n\t\t\t\t\tif (obj.id === id && obj.value.contains(target)) {\n\t\t\t\t\t\tthis._dispatchEvent(clickevent, obj.value, event);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._mousedown.length = 0;\n\t\t}\n\n\t\tif (this._dragging.length !== 0) {\n\t\t\tthis._dragging.forEach((obj) => {\n\t\t\t\tif (obj.id === id) {\n\t\t\t\t\tthis._dispatchEvent(\"pointerup\", obj.value, event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._dragging.length = 0;\n\t\t}\n\t}\n\n\t_dispatchDoubleClick(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\tif (target) {\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tif (this._dispatchEvent(\"dblclick\", obj, event)) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchWheel(originalEvent: WheelEvent, originalTarget: Node | null): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\tif (target) {\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tif (this._dispatchEvent(\"wheel\", obj, event)) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_makeSharedEvent(key: string, f: () => IDisposer): IDisposer {\n\t\tif (this._listeners[key] === undefined) {\n\t\t\tconst listener = f();\n\n\t\t\tthis._listeners[key] = new CounterDisposer(() => {\n\t\t\t\tdelete this._listeners[key];\n\t\t\t\tlistener.dispose();\n\t\t\t});\n\t\t}\n\n\t\treturn this._listeners[key].increment();\n\t}\n\n\t_onPointerEvent(name: string, f: (event: Array<IPointerEvent>, target: Node | null, native: boolean) => void): IDisposer {\n\t\tlet native = false;\n\t\tlet timer: number | null = null;\n\n\t\tfunction clear() {\n\t\t\ttimer = null;\n\t\t\tnative = false;\n\t\t}\n\n\t\treturn new MultiDisposer([\n\t\t\tnew Disposer(() => {\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\n\t\t\t\tclear();\n\t\t\t}),\n\n\t\t\t$utils.addEventListener(this.view, $utils.getRendererEvent(name), (_) => {\n\t\t\t\tnative = true;\n\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\n\t\t\t\ttimer = window.setTimeout(clear, 0);\n\t\t\t}),\n\n\t\t\tonPointerEvent(window, name, (ev, target) => {\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = null;\n\t\t\t\t}\n\n\t\t\t\tf(ev, target, native);\n\n\t\t\t\tnative = false;\n\t\t\t}),\n\t\t]);\n\t}\n\n\t// This ensures that only a single DOM event is added (e.g. only a single mousemove event listener)\n\t_initEvent(key: keyof IRendererEvents): IDisposer | undefined {\n\t\tswitch (key) {\n\t\t\tcase \"globalpointermove\":\n\t\t\tcase \"pointerover\":\n\t\t\tcase \"pointerout\":\n\t\t\t\treturn this._makeSharedEvent(\"pointermove\", () => {\n\t\t\t\t\tconst listener = (events: Array<IPointerEvent>, target: Node | null, native: boolean) => {\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMousemove(event, target, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\n\t\t\t\t\treturn new MultiDisposer([\n\t\t\t\t\t\tthis._onPointerEvent(\"pointerdown\", listener),\n\t\t\t\t\t\tthis._onPointerEvent(\"pointermove\", listener),\n\t\t\t\t\t]);\n\t\t\t\t});\n\t\t\tcase \"globalpointerup\":\n\t\t\t\treturn this._makeSharedEvent(\"pointerup\", () => {\n\t\t\t\t\tconst mouseup = this._onPointerEvent(\"pointerup\", (events, target, native) => {\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMouseup(event, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\t\t\t\t\t});\n\n\t\t\t\t\tconst pointercancel = this._onPointerEvent(\"pointercancel\", (events, target, native) => {\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMouseup(event, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\t\t\t\t\t});\n\n\t\t\t\t\treturn new Disposer(() => {\n\t\t\t\t\t\tmouseup.dispose();\n\t\t\t\t\t\tpointercancel.dispose();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"click\":\n\t\t\tcase \"rightclick\":\n\t\t\tcase \"middleclick\":\n\t\t\tcase \"pointerdown\":\n\t\t\t/*\n\t\t\t\treturn this._makeSharedEvent(\"pointerdown\", () => {\n\t\t\t\t\treturn this._onPointerEvent(\"pointerdown\", (event, target, native) => {\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { event, target, native };\n\t\t\t\t\t\tthis._dispatchMousedown(event)\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t*/\n\t\t\tcase \"pointermove\":\n\t\t\tcase \"pointerup\":\n\t\t\t\treturn this._makeSharedEvent(\"pointerdown\", () => {\n\t\t\t\t\t//const throttler = new Throttler();\n\n\t\t\t\t\tconst mousedown = this._onPointerEvent(\"pointerdown\", (events, target) => {\n\t\t\t\t\t\t$array.each(events, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchMousedown(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// TODO handle throttling properly for multitouch\n\t\t\t\t\tconst mousemove = this._onPointerEvent(\"pointermove\", (ev: Array<IPointerEvent>) => {\n\t\t\t\t\t\t//throttler.throttle(() => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragMove(ev);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst mouseup = this._onPointerEvent(\"pointerup\", (ev: Array<IPointerEvent>, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragEnd(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst pointercancel = this._onPointerEvent(\"pointercancel\", (ev: Array<IPointerEvent>, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragEnd(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\treturn new Disposer(() => {\n\t\t\t\t\t\tmousedown.dispose();\n\t\t\t\t\t\tmousemove.dispose();\n\t\t\t\t\t\tmouseup.dispose();\n\t\t\t\t\t\tpointercancel.dispose();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"dblclick\":\n\t\t\t\treturn this._makeSharedEvent(\"dblclick\", () => {\n\t\t\t\t\treturn this._onPointerEvent(\"dblclick\", (ev, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDoubleClick(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"wheel\":\n\t\t\t\treturn this._makeSharedEvent(\"wheel\", () => {\n\t\t\t\t\treturn $utils.addEventListener(this.view, $utils.getRendererEvent(\"wheel\"), (event: WheelEvent) => {\n\t\t\t\t\t\tthis._dispatchWheel(event, $utils.getEventTarget(event));\n\t\t\t\t\t}, { passive: false });\n\t\t\t\t});\n\t\t}\n\t}\n\n\t_addEvent<C, Key extends keyof IRendererEvents>(object: CanvasDisplayObject, key: Key, callback: (this: C, event: IRendererEvents[Key]) => void, context?: C): IDisposer {\n\t\tlet events: IEvents<Key> | undefined = this._events[key] as any;\n\n\t\tif (events === undefined) {\n\t\t\tevents = this._events[key] = {\n\t\t\t\tdisposer: this._initEvent(key)!,\n\t\t\t\tcallbacks: [],\n\t\t\t\tdispatching: false,\n\t\t\t\tcleanup: false,\n\t\t\t};\n\t\t}\n\n\t\tconst listener = { object, context, callback, disposed: false };\n\n\t\tevents!.callbacks.push(listener);\n\n\t\treturn new Disposer(() => {\n\t\t\tlistener.disposed = true;\n\n\t\t\tif (events!.dispatching) {\n\t\t\t\tevents!.cleanup = true;\n\n\t\t\t} else {\n\t\t\t\t$array.removeFirst(events!.callbacks, listener);\n\n\t\t\t\tif (events!.callbacks.length === 0) {\n\t\t\t\t\tevents!.disposer.dispose();\n\t\t\t\t\tdelete this._events[key];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic getCanvas(root: CanvasDisplayObject, options?: ICanvasOptions): HTMLCanvasElement {\n\n\t\t// Make sure everything is rendered\n\t\tthis.render(root);\n\n\t\tif (!options) {\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet scale: number = this.resolution;\n\n\t\tlet canvasWidth = Math.floor(this._calculatedWidth * this.resolution);\n\t\tlet canvasHeight = Math.floor(this._calculatedHeight * this.resolution);\n\n\t\t// Check if we need to scale\n\t\tif (options.minWidth && (options.minWidth > canvasWidth)) {\n\t\t\tlet minScale = options.minWidth / canvasWidth;\n\t\t\tif (minScale > scale) {\n\t\t\t\tscale = minScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.minHeight && (options.minHeight > canvasHeight)) {\n\t\t\tlet minScale = options.minHeight / canvasHeight;\n\t\t\tif (minScale > scale) {\n\t\t\t\tscale = minScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxWidth && (options.maxWidth < canvasWidth)) {\n\t\t\tlet maxScale = options.maxWidth / canvasWidth;\n\t\t\tif (maxScale < scale) {\n\t\t\t\tscale = maxScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxHeight && (options.maxHeight > canvasHeight)) {\n\t\t\tlet maxScale = options.maxHeight / canvasHeight;\n\t\t\tif (maxScale < scale) {\n\t\t\t\tscale = maxScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\t// Check if we need to compensate for pixel ratio\n\t\tif (options.maintainPixelRatio) {\n\t\t\tscale /= this.resolution;\n\t\t}\n\n\t\t// Init list canvases to remove from DOM after export\n\t\tconst canvases: HTMLCanvasElement[] = [];\n\n\t\t// Set up new canvas for export\n\t\tlet forceRender = false;\n\t\tconst canvas = document.createElement(\"canvas\");\n\t\tif (scale != this.resolution) {\n\t\t\tforceRender = true;\n\t\t\tcanvasWidth = canvasWidth * scale / this.resolution;\n\t\t\tcanvasHeight = canvasHeight * scale / this.resolution;\n\t\t}\n\n\t\tcanvas.width = canvasWidth;\n\t\tcanvas.height = canvasHeight;\n\n\t\t// Add to DOM so it inherits CSS\n\t\tcanvas.style.position = \"fixed\";\n\t\tcanvas.style.top = \"-10000px\";\n\t\tthis.view.appendChild(canvas);\n\t\tcanvases.push(canvas);\n\n\t\t// Context\n\t\tconst context = canvas.getContext(\"2d\")!;\n\n\t\tlet width = 0;\n\t\tlet height = 0;\n\t\tlet needRerender = false;\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer && layer.visible) {\n\t\t\t\tif (layer.tainted || forceRender) {\n\t\t\t\t\tneedRerender = true;\n\n\t\t\t\t\tlayer.exportableView = layer.view;\n\t\t\t\t\tlayer.exportableContext = layer.context;\n\n\t\t\t\t\tlayer.view = document.createElement(\"canvas\");\n\n\t\t\t\t\t// Add to DOM so it inherits CSS\n\t\t\t\t\tlayer.view.style.position = \"fixed\";\n\t\t\t\t\tlayer.view.style.top = \"-10000px\";\n\t\t\t\t\tthis.view.appendChild(layer.view);\n\t\t\t\t\tcanvases.push(layer.view);\n\n\t\t\t\t\tlet extraX = 0;\n\t\t\t\t\tlet extraY = 0;\n\t\t\t\t\tif (layer.margin) {\n\t\t\t\t\t\textraX += layer.margin.left || 0 + layer.margin.right || 0;\n\t\t\t\t\t\textraY += layer.margin.top || 0 + layer.margin.bottom || 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer.view.width = canvasWidth + extraX;\n\t\t\t\t\tlayer.view.height = canvasHeight + extraY;\n\n\t\t\t\t\tlayer.context = layer.view.getContext(\"2d\")!;\n\n\t\t\t\t\tlayer.dirty = true;\n\t\t\t\t\tlayer.scale = scale;\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (needRerender) {\n\t\t\tthis._omitTainted = true;\n\t\t\tthis.render(root);\n\t\t\tthis._omitTainted = false;\n\t\t}\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer && layer.visible) {\n\n\t\t\t\t// Layer is fine. Just plop it into our target canvas\n\t\t\t\tlet x = 0;\n\t\t\t\tlet y = 0;\n\t\t\t\tif (layer.margin) {\n\t\t\t\t\tx = -(layer.margin.left || 0) * this.resolution;\n\t\t\t\t\ty = -(layer.margin.top || 0) * this.resolution;\n\t\t\t\t}\n\t\t\t\tcontext.drawImage(layer.view, x, y);\n\n\t\t\t\t// Restore layer original canvas\n\t\t\t\tif (layer.exportableView) {\n\t\t\t\t\tlayer.view = layer.exportableView;\n\t\t\t\t\tlayer.exportableView = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (layer.exportableContext) {\n\t\t\t\t\tlayer.context = layer.exportableContext;\n\t\t\t\t\tlayer.exportableContext = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (width < layer.view.clientWidth) {\n\t\t\t\t\twidth = layer.view.clientWidth;\n\t\t\t\t}\n\t\t\t\tif (height < layer.view.clientHeight) {\n\t\t\t\t\theight = layer.view.clientHeight;\n\t\t\t\t}\n\n\t\t\t\tlayer.scale = undefined;\n\t\t\t}\n\t\t});\n\n\t\tcanvas.style.width = width + \"px\";\n\t\tcanvas.style.height = height + \"px\";\n\n\t\t$array.each(canvases, (canvas) => {\n\t\t\tcanvas.style.position = \"\";\n\t\t\tcanvas.style.top = \"\";\n\t\t\tthis.view.removeChild(canvas);\n\t\t})\n\t\treturn canvas;\n\t}\n}\n\n\nclass GhostLayer {\n\tpublic view: HTMLCanvasElement;\n\tpublic context: CanvasRenderingContext2D;\n\tpublic margin: IMargin = {\n\t\tleft: 0,\n\t\tright: 0,\n\t\ttop: 0,\n\t\tbottom: 0,\n\t};\n\n\tprivate _resolution: number = 1;\n\tprivate _width: number = 0;\n\tprivate _height: number = 0;\n\n\tpublic imageArray?: Uint8ClampedArray;\n\n\tconstructor() {\n\t\tthis.view = document.createElement(\"canvas\");\n\t\tthis.context = this.view.getContext(\"2d\", { alpha: false, willReadFrequently: true })! as CanvasRenderingContext2D;\n\t\tthis.context.imageSmoothingEnabled = false;\n\n\t\tthis.view.style.position = \"absolute\";\n\t\tthis.view.style.top = \"0px\";\n\t\tthis.view.style.left = \"0px\";\n\t}\n\n\tresize(canvasWidth: number, canvasHeight: number, domWidth: number, domHeight: number, resolution: number) {\n\t\tthis._resolution = resolution;\n\n\t\tcanvasWidth += (this.margin.left + this.margin.right);\n\t\tcanvasHeight += (this.margin.top + this.margin.bottom);\n\n\t\t// TODO this should take into account calculateSize\n\t\tdomWidth += (this.margin.left + this.margin.right);\n\t\tdomHeight += (this.margin.top + this.margin.bottom);\n\n\t\tthis.view.style.left = -this.margin.left + \"px\";\n\t\tthis.view.style.top = -this.margin.top + \"px\";\n\n\t\tthis._width = Math.floor(canvasWidth * resolution);\n\t\tthis._height = Math.floor(canvasHeight * resolution);\n\n\t\tthis.view.width = this._width;\n\t\tthis.view.style.width = domWidth + \"px\";\n\n\t\tthis.view.height = this._height;\n\t\tthis.view.style.height = domHeight + \"px\";\n\t}\n\n\tgetImageData(point: IPoint, bbox: DOMRect): ImageData {\n\t\treturn this.context.getImageData(\n\t\t\t// TODO should this round ?\n\t\t\tMath.round(((point.x - bbox.left) / bbox.width) * this._width),\n\t\t\tMath.round(((point.y - bbox.top) / bbox.height) * this._height),\n\t\t\t1,\n\t\t\t1,\n\t\t);\n\t}\n\n\tgetImageArray(point: IPoint): Array<number> {\n\n\t\tif (!this.imageArray) {\n\t\t\tthis.imageArray = this.context.getImageData(0, 0, this._width, this._height).data;\n\t\t}\n\n\t\tconst data = this.imageArray;\n\n\t\tconst x = Math.round(point.x * this._resolution);\n\t\tconst y = Math.round(point.y * this._resolution);\n\n\t\tconst i = (y * this._width + x) * 4;\n\t\treturn [data[i], data[i + 1], data[i + 2], data[i + 3]];\n\t}\n\n\tsetMargin(layers: Array<CanvasLayer>): void {\n\t\tthis.margin.left = 0;\n\t\tthis.margin.right = 0;\n\t\tthis.margin.top = 0;\n\t\tthis.margin.bottom = 0;\n\n\t\t$array.each(layers, (layer) => {\n\t\t\tif (layer.margin) {\n\t\t\t\tthis.margin.left = Math.max(this.margin.left, layer.margin.left);\n\t\t\t\tthis.margin.right = Math.max(this.margin.right, layer.margin.right);\n\t\t\t\tthis.margin.top = Math.max(this.margin.top, layer.margin.top);\n\t\t\t\tthis.margin.bottom = Math.max(this.margin.bottom, layer.margin.bottom);\n\t\t\t}\n\t\t});\n\t}\n\n\tclear() {\n\t\tthis.context.save();\n\t\tthis.context.fillStyle = '#000';\n\t\tthis.context.fillRect(0, 0, this._width, this._height);\n\t}\n}\n\n\n/**\n * @ignore\n */\nexport class CanvasLayer implements ILayer {\n\tpublic view: HTMLCanvasElement;\n\tpublic context: CanvasRenderingContext2D;\n\tpublic tainted: boolean = true;\n\tpublic margin: IMargin | undefined;\n\tpublic order: number = 0;\n\tpublic visible: boolean = true;\n\tpublic width: number | undefined;\n\tpublic height: number | undefined;\n\tpublic scale: number | undefined;\n\tpublic dirty: boolean = true;\n\tpublic exportableView: HTMLCanvasElement | undefined;\n\tpublic exportableContext: CanvasRenderingContext2D | undefined;\n\n\tprivate _width: number = 0;\n\tprivate _height: number = 0;\n\n\tconstructor(view: HTMLCanvasElement, context: CanvasRenderingContext2D) {\n\t\tthis.view = view;\n\t\tthis.context = context;\n\t}\n\n\tresize(canvasWidth: number, canvasHeight: number, domWidth: number, domHeight: number, resolution: number) {\n\t\t// TODO should this take into account calculateSize ?\n\t\tif (this.width != null) {\n\t\t\tcanvasWidth = this.width;\n\t\t\tdomWidth = this.width;\n\t\t}\n\n\t\t// TODO should this take into account calculateSize ?\n\t\tif (this.height != null) {\n\t\t\tcanvasHeight = this.height;\n\t\t\tdomHeight = this.height;\n\t\t}\n\n\t\tif (this.margin) {\n\t\t\tcanvasWidth += (this.margin.left + this.margin.right);\n\t\t\tcanvasHeight += (this.margin.top + this.margin.bottom);\n\n\t\t\t// TODO this should take into account calculateSize\n\t\t\tdomWidth += (this.margin.left + this.margin.right);\n\t\t\tdomHeight += (this.margin.top + this.margin.bottom);\n\n\t\t\tthis.view.style.left = -this.margin.left + \"px\";\n\t\t\tthis.view.style.top = -this.margin.top + \"px\";\n\n\t\t} else {\n\t\t\tthis.view.style.left = \"0px\";\n\t\t\tthis.view.style.top = \"0px\";\n\t\t}\n\n\t\tthis._width = Math.floor(canvasWidth * resolution);\n\t\tthis._height = Math.floor(canvasHeight * resolution);\n\n\t\tthis.view.width = this._width;\n\t\tthis.view.style.width = domWidth + \"px\";\n\n\t\tthis.view.height = this._height;\n\t\tthis.view.style.height = domHeight + \"px\";\n\t}\n\n\tclear() {\n\t\tthis.context.save();\n\t\tthis.context.clearRect(0, 0, this._width, this._height);\n\t}\n}\n","import type { IAnimation } from \"./util/Animation\";\nimport type { Entity } from \"./util/Entity\";\nimport type { Sprite } from \"./render/Sprite\";\nimport type { Theme } from \"./Theme\";\nimport type { IPoint } from \"./util/IPoint\";\nimport type { IRenderer, IPointerEvent } from \"./render/backend/Renderer\";\nimport type { Timezone } from \"./util/Timezone\";\n\nimport { AnimationState } from \"./util/Animation\";\nimport { Container } from \"./render/Container\";\nimport { Text } from \"./render/Text\";\nimport { HorizontalLayout } from \"./render/HorizontalLayout\";\nimport { VerticalLayout } from \"./render/VerticalLayout\";\nimport { GridLayout } from \"./render/GridLayout\";\nimport { IDisposer, Disposer } from \"./util/Disposer\";\nimport { ResizeSensor } from \"./util/ResizeSensor\";\nimport { InterfaceColors } from \"./util/InterfaceColors\";\nimport { Graphics } from \"./render/Graphics\";\nimport { Rectangle } from \"./render/Rectangle\";\nimport { Tooltip } from \"./render/Tooltip\";\nimport { NumberFormatter } from \"./util/NumberFormatter\";\nimport { DateFormatter } from \"./util/DateFormatter\";\nimport { DurationFormatter } from \"./util/DurationFormatter\";\nimport { ILocale, Language } from \"./util/Language\";\nimport { Events, EventDispatcher } from \"./util/EventDispatcher\";\nimport { DefaultTheme } from \"../themes/DefaultTheme\";\nimport { CanvasRenderer } from \"./render/backend/CanvasRenderer\";\nimport { p100, percent, isPercent, Percent } from \"./util/Percent\";\nimport { color } from \"./util/Color\";\nimport { populateString } from \"./util/PopulateString\";\nimport { registry } from \"./Registry\";\n\nimport * as $order from \"./util/Order\";\nimport * as $array from \"./util/Array\";\nimport * as $object from \"./util/Object\";\nimport * as $utils from \"./util/Utils\";\nimport * as $type from \"./util/Type\";\n\n\nimport en from \"../../locales/en\";\n\n\nfunction rAF(fps: number | undefined, callback: (currentTime: number) => void): void {\n\tif (fps == null) {\n\t\trequestAnimationFrame(callback);\n\n\t} else {\n\t\tsetTimeout(() => {\n\t\t\trequestAnimationFrame(callback);\n\t\t}, 1000 / fps);\n\t}\n}\n\n\n/**\n * @ignore\n */\ninterface IParent extends Entity {\n\t_prepareChildren(): void;\n\t_updateChildren(): void;\n\t_childrenUpdt: boolean;\n\t_childrenPrep: boolean;\n}\n\ninterface IBounds extends Entity {\n\tdepth(): number;\n\t_updateBounds(): void;\n}\n\n\nexport interface ISize {\n\twidth: number,\n\theight: number,\n}\n\n\nexport interface IRootEvents {\n\tframestarted: {\n\t\ttimestamp: number;\n\t};\n\tframeended: {\n\t\ttimestamp: number;\n\t};\n}\n\n\nexport interface IRootSettings {\n\n\t/**\n\t * Indicates whether chart should use \"safe\" resolution on some memory-limiting\n\t * platforms such as Safari.\n\t *\n\t * @default true\n\t */\n\tuseSafeResolution?: boolean;\n\n\t/**\n\t * Allows defining margins around chart area for tooltips to go outside the\n\t * chart itself.\n\t *\n\t * @since 5.2.24\n\t */\n\ttooltipContainerBounds?: { top: number, left: number, right: number, bottom: number };\n\n\t/**\n\t * Set to `false` to disable all accessibility features.\n\t *\n\t * NOTE: once disabled, accessibility cannot be re-enabled on a live `Root` object.\n\t *\n\t * @default true\n\t * @since 5.3.0\n\t */\n\taccessible?: boolean;\n\n\t/**\n\t * If set to `true`, the parent inner `<div>` element will become a focusable\n\t * element.\n\t *\n\t * @since 5.3.17\n\t * @default false\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\tfocusable?: boolean;\n\n\t/**\n\t * Distance between focused element and its highlight square in pixels.\n\t *\n\t * @since 5.6.0\n\t * @default 2\n\t */\n\tfocusPadding?: number;\n\n\t/**\n\t * If set to some string, it will be used as inner `<div>` ARIA-LABEL.\n\t *\n\t * Should be used in conjuction with `focusable`.\n\t *\n\t * @since 5.3.17\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\tariaLabel?: string;\n\n\t/**\n\t * Allows setting a \"role\" for the inner `<div>`.\n\t *\n\t * @since 5.3.17\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\trole?: string;\n\n\t/**\n\t * Allows for specifying a custom width / height for the chart.\n\t *\n\t * This function will be called automatically when the chart is resized.\n\t */\n\tcalculateSize?: (dimensions: DOMRect) => ISize;\n}\n\n\n// TODO implement Disposer\n/**\n * Root element of the chart.\n *\n * @see {@link https://www.amcharts.com/docs/v5/getting-started/#Root_element} for more info\n */\nexport class Root implements IDisposer {\n\n\t/**\n\t * A reference to original chart container (div element).\n\t */\n\tpublic dom: HTMLElement;\n\tpublic _inner: HTMLElement;\n\n\tprotected _settings: IRootSettings;\n\tprotected _isDirty: boolean = false;\n\tprotected _isDirtyParents: boolean = false;\n\tprotected _isDirtyAnimation: boolean = false;\n\tprotected _dirty: { [id: number]: Entity } = {};\n\tprotected _dirtyParents: { [id: number]: IParent } = {};\n\tprotected _dirtyBounds: { [id: number]: IBounds } = {};\n\tprotected _dirtyPositions: { [id: number]: Sprite } = {};\n\n\tprotected _ticker: ((currentTime: number) => void) | null = null;\n\tprotected _tickers: Array<(currentTime: number) => void> = [];\n\n\tprotected _updateTick: boolean = true;\n\n\t/**\n\t * Root's event dispatcher.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\n\t */\n\tpublic events: EventDispatcher<Events<this, IRootEvents>> = new EventDispatcher();\n\n\t/**\n\t * @ignore\n\t * @todo needs description\n\t */\n\tpublic animationTime: number | null = null;\n\n\tprivate _animations: Array<IAnimation> = [];\n\n\tpublic _renderer: IRenderer;\n\n\tpublic _rootContainer!: Container;\n\n\t/**\n\t * Main content container.\n\t */\n\tpublic container!: Container;\n\n\t/**\n\t * A [[Container]] used to display tooltips in.\n\t */\n\tpublic tooltipContainer!: Container\n\tprotected _tooltipContainerSettings!: { top: number, left: number, right: number, bottom: number };\n\n\tpublic _tooltip!: Tooltip;\n\n\t// Locale-related\n\n\t/**\n\t * @ignore\n\t */\n\tpublic language: Language = Language.new(this, {});\n\n\t/**\n\t * Locale used by the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/}\n\t */\n\tpublic locale: ILocale = en;\n\n\t// Date-time related\n\n\t/**\n\t * Use UTC when formatting date/time.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#utc-and-time-zones} for more info\n\t */\n\tpublic utc: boolean = false;\n\n\t/**\n\t * If set, will format date/time in specific time zone.\n\t *\n\t * The value should be named time zone, e.g.:\n\t * `\"America/Vancouver\"`, `\"Australia/Sydney\"`, `\"UTC\"`.\n\t *\n\t * NOTE: Using time zone feature may noticeable affect performance of the\n\t * chart, especially with large data sets, since every single date will need\n\t * to be recalculated.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#time-zone} for more info\n\t * @since 5.1.0\n\t */\n\tpublic timezone?: Timezone;\n\n\t/**\n\t * The maximum FPS that the Root will run at.\n\t *\n\t * If `undefined` it will run at the highest FPS.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Performance} for more info\n\t */\n\tpublic fps: number | undefined;\n\n\t/**\n\t * Number formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\n\t */\n\tpublic numberFormatter: NumberFormatter = NumberFormatter.new(this, {});\n\n\t/**\n\t * Date/time formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic dateFormatter: DateFormatter = DateFormatter.new(this, {});\n\n\t/**\n\t * Duration formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic durationFormatter: DurationFormatter = DurationFormatter.new(this, {});\n\n\n\t// Accessibility\n\n\t/**\n\t * Global tab index for using for the whole chart\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t */\n\tpublic tabindex: number = 0;\n\n\t//@todo maybe make this better\n\tprotected _tabindexes: Sprite[] = [];\n\n\tprotected _a11yD: boolean = false;\n\tprotected _focusElementDirty: boolean = false;\n\tprotected _focusElementContainer: HTMLDivElement | undefined;\n\tprotected _focusedSprite: Sprite | undefined;\n\tprotected _isShift: boolean | undefined;\n\tprotected _keyboardDragPoint: IPoint | undefined;\n\tprotected _tooltipElementContainer: HTMLDivElement | undefined;\n\tprotected _readerAlertElement: HTMLDivElement | undefined;\n\tprotected _skipNextGroupJump: boolean = true;\n\n\tpublic _logo?: Container;\n\n\tpublic _tooltipDiv: HTMLDivElement | undefined;\n\n\t/**\n\t * Used for dynamically-created CSS and JavaScript with strict source policies.\n\t */\n\tpublic nonce?: string;\n\n\t/**\n\t * Special color set to be used for various controls.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/#Interface_colors} for more info\n\t */\n\tpublic interfaceColors: InterfaceColors;\n\n\t/**\n\t * An instance of vertical layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic verticalLayout: VerticalLayout = VerticalLayout.new(this, {});\n\n\t/**\n\t * An instance of horizontal layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default HorizontalLayout.new()\n\t */\n\tpublic horizontalLayout: VerticalLayout = HorizontalLayout.new(this, {});\n\n\t/**\n\t * An instance of grid layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic gridLayout: VerticalLayout = GridLayout.new(this, {});\n\n\tpublic _paused: boolean = false;\n\n\t/**\n\t * Indicates whether chart should resized automatically when parent container\n\t * width and/or height changes.\n\t *\n\t * If disabled (`autoResize = false`) you can make the chart resize manually\n\t * by calling root element's `resize()` method.\n\t */\n\tpublic autoResize: boolean = true;\n\n\tprotected _fontHash: string = \"\";\n\n\tprotected _isDisposed: boolean = false;\n\tprotected _disposers: Array<IDisposer> = [];\n\n\tprotected _resizeSensorDisposer?: IDisposer;\n\n\tpublic _tooltips: Array<Tooltip> = [];\n\n\tprotected _htmlElementContainer: HTMLDivElement | undefined;\n\tprotected _htmlEnabledContainers: Container[] = [];\n\n\t/**\n\t * Entities that have their `id` setting set.\n\t *\n\t * @since 5.11.0\n\t */\n\tpublic entitiesById: { [index: string]: any } = {};\n\n\tprotected _systemTooltip!: Tooltip;\n\n\tprotected constructor(id: string | HTMLElement, settings: IRootSettings = {}, isReal: boolean) {\n\n\t\tif (!isReal) {\n\t\t\tthrow new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n\t\t}\n\n\t\tthis._settings = settings;\n\n\t\tif (settings.accessible == false) {\n\t\t\tthis._a11yD = true;\n\t\t}\n\n\t\tif (settings.useSafeResolution == null) {\n\t\t\tsettings.useSafeResolution = true;\n\t\t}\n\n\t\tlet resolution;\n\n\t\tif (settings.useSafeResolution) {\n\t\t\tresolution = $utils.getSafeResolution();\n\t\t}\n\n\t\tthis._renderer = new CanvasRenderer(resolution);\n\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\t$array.each(registry.rootElements, (root) => {\n\t\t\tif (root.dom === dom) {\n\t\t\t\tthrow new Error(\"You cannot have multiple Roots on the same DOM node\");\n\t\t\t}\n\t\t});\n\n\t\tthis.interfaceColors = InterfaceColors.new(this, {});\n\n\t\tif (dom === null) {\n\t\t\tthrow new Error(\"Could not find HTML element with id `\" + id + \"`\");\n\t\t}\n\n\t\tthis.dom = dom;\n\n\t\tlet inner: HTMLDivElement = document.createElement(\"div\");\n\t\tinner.style.position = \"relative\";\n\t\tinner.style.width = \"100%\";\n\t\tinner.style.height = \"100%\";\n\t\tdom.appendChild(inner);\n\n\t\tconst tooltipContainerBounds = settings.tooltipContainerBounds;\n\t\tif (tooltipContainerBounds) {\n\t\t\tthis._tooltipContainerSettings = tooltipContainerBounds;\n\t\t}\n\n\t\tthis._inner = inner;\n\n\t\tthis._updateComputedStyles();\n\n\t\tregistry.rootElements.push(this);\n\t}\n\n\n\tpublic static new(id: string | HTMLElement, settings?: IRootSettings): Root {\n\t\tconst root = new Root(id, settings, true);\n\t\troot._init();\n\t\treturn root;\n\t}\n\n\tpublic moveDOM(id: string | HTMLElement): void {\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\tif (dom) {\n\t\t\twhile (this.dom.childNodes.length > 0) {\n\t\t\t\tdom.appendChild(this.dom.childNodes[0]);\n\t\t\t}\n\t\t\tthis.dom = dom;\n\t\t\tthis._initResizeSensor();\n\t\t\tthis.resize();\n\t\t}\n\n\t}\n\n\n\tprotected _handleLogo(): void {\n\t\tif (this._logo) {\n\t\t\tconst w = this.dom.offsetWidth;\n\t\t\tconst h = this.dom.offsetHeight;\n\t\t\tif ((w <= 150) || (h <= 60)) {\n\t\t\t\tthis._logo.hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._logo.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _showBranding(): void {\n\t\tif (!this._logo) {\n\t\t\tconst logo = this.tooltipContainer.children.push(Container.new(this, {\n\t\t\t\tinteractive: true,\n\t\t\t\tinteractiveChildren: false,\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tsetStateOnChildren: true,\n\t\t\t\tpaddingTop: 9,\n\t\t\t\tpaddingRight: 9,\n\t\t\t\tpaddingBottom: 9,\n\t\t\t\tpaddingLeft: 9,\n\t\t\t\tscale: .6,\n\t\t\t\ty: percent(100),\n\t\t\t\tcenterY: p100,\n\t\t\t\ttooltipY: 10,\n\t\t\t\ttooltipText: \"Created using amCharts 5\",\n\t\t\t\ttooltipX: p100,\n\t\t\t\tcursorOverStyle: \"pointer\",\n\t\t\t\tbackground: Rectangle.new(this, {\n\t\t\t\t\tfill: color(0x474758),\n\t\t\t\t\tfillOpacity: 0,\n\t\t\t\t\ttooltipY: 5\n\t\t\t\t})\n\t\t\t}));\n\n\n\t\t\tlogo.set(\"tooltip\", this.systemTooltip);\n\n\t\t\tlogo.events.on(\"click\", () => {\n\t\t\t\twindow.open(\"https://www.amcharts.com/\", \"_blank\");\n\t\t\t});\n\n\t\t\tlogo.states.create(\"hover\", {});\n\n\t\t\tconst m = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0xcccccc),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6\"\n\t\t\t}));\n\n\t\t\tm.states.create(\"hover\", { stroke: color(0x3CABFF) });\n\n\t\t\tconst a = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0x888888),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0\"\n\t\t\t}));\n\n\t\t\ta.states.create(\"hover\", { stroke: color(0x474758) });\n\n\t\t\tthis._logo = logo;\n\n\t\t\tthis._handleLogo();\n\n\t\t}\n\t}\n\n\tprotected _getRealSize(): DOMRect {\n\t\treturn this.dom.getBoundingClientRect();\n\t}\n\n\tprotected _getCalculatedSize(rect: DOMRect): ISize {\n\t\tif (this._settings.calculateSize) {\n\t\t\treturn this._settings.calculateSize(rect);\n\n\t\t} else {\n\t\t\treturn {\n\t\t\t\twidth: rect.width,\n\t\t\t\theight: rect.height,\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected _init(): void {\n\n\t\tconst settings = this._settings;\n\t\tif (settings.accessible !== false) {\n\t\t\tif (settings.focusable) {\n\t\t\t\tthis._inner.setAttribute(\"focusable\", \"true\");\n\t\t\t\tthis._inner.setAttribute(\"tabindex\", this.tabindex + \"\");\n\t\t\t}\n\n\t\t\tif (settings.ariaLabel) {\n\t\t\t\tthis._inner.setAttribute(\"aria-label\", settings.ariaLabel);\n\t\t\t}\n\n\t\t\tif (settings.role) {\n\t\t\t\tthis._inner.setAttribute(\"role\", settings.role);\n\t\t\t}\n\t\t}\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst width = Math.floor(size.width);\n\t\tconst height = Math.floor(size.height);\n\n\t\tconst realWidth = Math.floor(rect.width);\n\t\tconst realHeight = Math.floor(rect.height);\n\n\t\tconst rootContainer = Container.new(this, {\n\t\t\tvisible: true,\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t});\n\t\tthis._rootContainer = rootContainer;\n\t\tthis._rootContainer._defaultThemes.push(DefaultTheme.new(this));\n\n\t\tconst container = rootContainer.children.push(Container.new(this, { visible: true, width: p100, height: p100 }));\n\t\tthis.container = container;\n\n\t\trenderer.resize(realWidth, realHeight, width, height);\n\n\t\t//@todo: better appendChild - refer\n\t\tthis._inner.appendChild(renderer.view);\n\n\t\t// TODO: TMP TMP TMP for testing only, remove\n\t\t//renderer.debugGhostView = true;\n\n\t\tthis._initResizeSensor();\n\n\t\t// HTML content holder\n\t\tconst htmlElementContainer = document.createElement(\"div\");\n\t\tthis._htmlElementContainer = htmlElementContainer;\n\t\thtmlElementContainer.className = \"am5-html-container\";\n\t\thtmlElementContainer.style.position = \"absolute\";\n\t\thtmlElementContainer.style.pointerEvents = \"none\";\n\t\tif (!this._tooltipContainerSettings) {\n\t\t\thtmlElementContainer.style.overflow = \"hidden\";\n\t\t}\n\t\tthis._inner.appendChild(htmlElementContainer);\n\n\t\tif (this._a11yD !== true) {\n\n\t\t\t// Create element which is used to make announcements to screen reader\n\t\t\tconst readerAlertElement = document.createElement(\"div\");\n\t\t\treaderAlertElement.className = \"am5-reader-container\";\n\t\t\treaderAlertElement.setAttribute(\"role\", \"alert\");\n\t\t\t// readerAlertElement.style.zIndex = \"-100000\";\n\t\t\t// readerAlertElement.style.opacity = \"0\";\n\t\t\t// readerAlertElement.style.top = \"0\";\n\t\t\treaderAlertElement.style.position = \"absolute\";\n\t\t\treaderAlertElement.style.width = \"1px\";\n\t\t\treaderAlertElement.style.height = \"1px\";\n\t\t\treaderAlertElement.style.overflow = \"hidden\";\n\t\t\treaderAlertElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\n\t\t\tthis._readerAlertElement = readerAlertElement;\n\t\t\tthis._inner.appendChild(this._readerAlertElement);\n\n\t\t\tconst focusElementContainer = document.createElement(\"div\");\n\t\t\tfocusElementContainer.className = \"am5-focus-container\";\n\t\t\tfocusElementContainer.style.position = \"absolute\";\n\t\t\tfocusElementContainer.style.pointerEvents = \"none\";\n\t\t\tfocusElementContainer.style.top = \"0px\";\n\t\t\tfocusElementContainer.style.left = \"0px\";\n\t\t\tfocusElementContainer.style.overflow = \"hidden\";\n\t\t\tfocusElementContainer.style.width = width + \"px\";\n\t\t\tfocusElementContainer.style.height = height + \"px\";\n\n\t\t\tfocusElementContainer.setAttribute(\"role\", \"graphics-document\");\n\n\t\t\t$utils.setInteractive(focusElementContainer, false);\n\t\t\tthis._focusElementContainer = focusElementContainer;\n\t\t\tthis._inner.appendChild(this._focusElementContainer);\n\n\t\t\tconst tooltipElementContainer = document.createElement(\"div\");\n\t\t\tthis._tooltipElementContainer = tooltipElementContainer;\n\t\t\ttooltipElementContainer.className = \"am5-tooltip-container\";\n\t\t\tthis._inner.appendChild(tooltipElementContainer);\n\n\t\t\t// Add keyboard events for accessibility, e.g. simulating drag with arrow\n\t\t\t// keys and click with ENTER\n\t\t\tif ($utils.supports(\"keyboardevents\")) {\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(window, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\tif (eventKey == \"Shift\") {\n\t\t\t\t\t\tthis._isShift = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (eventKey == \"Tab\") {\n\t\t\t\t\t\tthis._isShift = ev.shiftKey;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(window, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\tif (eventKey == \"Shift\") {\n\t\t\t\t\t\tthis._isShift = false;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"click\", () => {\n\t\t\t\t\t// Some screen readers convert ENTER (and some SPACE) press whil on\n\t\t\t\t\t// focused element to a \"click\" event, preventing actual \"keydown\"\n\t\t\t\t\t// event from firing. We're using this \"click\" event to still\n\t\t\t\t\t// generate internal click events.\n\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\tif (focusedSprite) {\n\t\t\t\t\t\tconst announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\n\t\t\t\t\t\tif (announceText !== \"\") {\n\t\t\t\t\t\t\tthis.readerAlert(announceText);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"click\"));\n\t\t\t\t\t\tfocusedSprite.events.dispatch(\"click\", {\n\t\t\t\t\t\t\ttype: \"click\",\n\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\tif (focusedSprite) {\n\t\t\t\t\t\tif (ev.key == \"Escape\") {\n\t\t\t\t\t\t\t// ESC pressed - lose current focus\n\t\t\t\t\t\t\t$utils.blur();\n\t\t\t\t\t\t\tthis._focusedSprite = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet dragOffsetX = 0;\n\t\t\t\t\t\tlet dragOffsetY = 0;\n\t\t\t\t\t\t// TODO: figure out if using bogus MouseEvent is fine, or it will\n\t\t\t\t\t\t// fail on some platforms\n\t\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\t\tswitch (eventKey) {\n\t\t\t\t\t\t\tcase \"Enter\":\n\t\t\t\t\t\t\tcase \" \":\n\t\t\t\t\t\t\t\tconst announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\n\t\t\t\t\t\t\t\tif (announceText !== \"\") {\n\t\t\t\t\t\t\t\t\tthis.readerAlert(announceText);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (eventKey == \" \" && focusedSprite.get(\"role\") != \"checkbox\") {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"mouse\"));\n\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"click\", {\n\t\t\t\t\t\t\t\t\ttype: \"click\",\n\t\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\t\t\tdragOffsetX = -6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\t\t\tdragOffsetX = 6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\t\t\tdragOffsetY = -6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\t\t\tdragOffsetY = 6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (dragOffsetX != 0 || dragOffsetY != 0) {\n\t\t\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\t\t\tif (!focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t\t// Start dragging\n\t\t\t\t\t\t\t\tthis._keyboardDragPoint = {\n\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"mousedown\", {\n\t\t\t\t\t\t\t\t\tclientX: 0,\n\t\t\t\t\t\t\t\t\tclientY: 0\n\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\tdownEvent.point = {\n\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"pointerdown\")) {\n\t\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"pointerdown\", {\n\t\t\t\t\t\t\t\t\t\ttype: \"pointerdown\",\n\t\t\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Move focus marker\n\t\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Move incrementally\n\t\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\t\tdragPoint.x += dragOffsetX;\n\t\t\t\t\t\t\tdragPoint.y += dragOffsetY;\n\t\t\t\t\t\t\tconst moveEvent = renderer.getEvent(new MouseEvent(\"mousemove\", {\n\t\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t\t}), false);\n\n\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointermove\")) {\n\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointermove\", {\n\t\t\t\t\t\t\t\t\ttype: \"globalpointermove\",\n\t\t\t\t\t\t\t\t\toriginalEvent: moveEvent.event,\n\t\t\t\t\t\t\t\t\tpoint: moveEvent.point,\n\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\t\tif (this._focusedSprite) {\n\t\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\t\tswitch (eventKey) {\n\t\t\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\t\t\tif (focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t\t\t// Simulate drag stop\n\t\t\t\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\t\t\t\tconst upEvent = renderer.getEvent(new MouseEvent(\"mouseup\", {\n\t\t\t\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointerup\")) {\n\t\t\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointerup\", {\n\t\t\t\t\t\t\t\t\t\t\ttype: \"globalpointerup\",\n\t\t\t\t\t\t\t\t\t\t\toriginalEvent: upEvent.event,\n\t\t\t\t\t\t\t\t\t\t\tpoint: upEvent.point,\n\t\t\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t\t\t\tthis._keyboardDragPoint = undefined;\n\t\t\t\t\t\t\t\t\t// @todo dispatch mouseup event instead of calling dragStop?\n\t\t\t\t\t\t\t\t\t// this._dispatchEvent(\"globalpointerup\", target, upEvent);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (focusedSprite.get(\"focusableGroup\")) {\n\t\t\t\t\t\t\t\t\t// Find next item in focusable group\n\t\t\t\t\t\t\t\t\tconst group = focusedSprite.get(\"focusableGroup\");\n\t\t\t\t\t\t\t\t\tconst items = this._tabindexes.filter((item) => {\n\t\t\t\t\t\t\t\t\t\treturn item.get(\"focusableGroup\") == group && item.getPrivate(\"focusable\") !== false && item.isVisibleDeep() ? true : false;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tlet index = items.indexOf(focusedSprite);\n\t\t\t\t\t\t\t\t\tconst lastIndex = items.length - 1;\n\t\t\t\t\t\t\t\t\tindex += (eventKey == \"ArrowRight\" || eventKey == \"ArrowDown\") ? 1 : -1;\n\t\t\t\t\t\t\t\t\tif (index < 0) {\n\t\t\t\t\t\t\t\t\t\tindex = lastIndex;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse if (index > lastIndex) {\n\t\t\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$utils.focus(items[index].getPrivate(\"focusElement\")!.dom);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"Tab\":\n\t\t\t\t\t\t\t\tconst group = focusedSprite.get(\"focusableGroup\");\n\t\t\t\t\t\t\t\tif (group && this._isShift) {\n\t\t\t\t\t\t\t\t\tif (!this._skipNextGroupJump) {\n\t\t\t\t\t\t\t\t\t\tthis._focusNext(focusedSprite.getPrivate(\"focusElement\")!.dom, -1, group);\n\t\t\t\t\t\t\t\t\t\tthis._skipNextGroupJump = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tthis._startTicker();\n\t\tthis.setThemes([]);\n\n\t\tthis._addTooltip();\n\n\t\tif (!this._hasLicense()) {\n\t\t\tthis._showBranding();\n\t\t}\n\t}\n\n\t/**\n\t * Returns an instance of a universal [[Tooltip]] instance.\n\t * @since 5.14.0\n\t */\n\tpublic get systemTooltip() {\n\t\tif (!this._systemTooltip) {\n\t\t\tconst tooltip = Tooltip.new(this, {\n\t\t\t\tthemeTags: [\"system\"]\n\t\t\t});\n\n\t\t\tthis._systemTooltip = tooltip;\n\t\t}\n\t\treturn this._systemTooltip;\n\t}\n\n\tprivate _initResizeSensor(): void {\n\t\tif (this._resizeSensorDisposer) {\n\t\t\tthis._resizeSensorDisposer.dispose();\n\t\t}\n\t\tthis._resizeSensorDisposer = new ResizeSensor(this.dom, () => {\n\t\t\tif (this.autoResize) {\n\t\t\t\tthis.resize();\n\t\t\t}\n\t\t});\n\t\tthis._disposers.push(this._resizeSensorDisposer);\n\t}\n\n\t/**\n\t * If automatic resizing of char is disabled (`root.autoResize = false`), it\n\t * can be resized manually by calling this method.\n\t */\n\tpublic resize(): void {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\t\tconst w = Math.floor(size.width);\n\t\tconst h = Math.floor(size.height);\n\n\t\tif (w > 0 && h > 0) {\n\t\t\tconst realWidth = Math.floor(rect.width);\n\t\t\tconst realHeight = Math.floor(rect.height);\n\n\t\t\tconst htmlElementContainer = this._htmlElementContainer!;\n\t\t\thtmlElementContainer.style.width = w + \"px\";\n\t\t\thtmlElementContainer.style.height = h + \"px\";\n\n\t\t\tif (this._a11yD !== true) {\n\t\t\t\tconst focusElementContainer = this._focusElementContainer!;\n\t\t\t\tfocusElementContainer.style.width = w + \"px\";\n\t\t\t\tfocusElementContainer.style.height = h + \"px\";\n\t\t\t}\n\n\t\t\tthis._renderer.resize(realWidth, realHeight, w, h);\n\n\t\t\tconst rootContainer = this._rootContainer;\n\n\t\t\trootContainer.setPrivate(\"width\", w);\n\t\t\trootContainer.setPrivate(\"height\", h);\n\t\t\tthis._render();\n\t\t\tthis._handleLogo();\n\t\t}\n\t}\n\n\tprivate _render() {\n\t\tthis._renderer.render(this._rootContainer._display);\n\n\t\tif (this._focusElementDirty) {\n\t\t\tthis._updateCurrentFocus();\n\t\t\tthis._focusElementDirty = false;\n\t\t}\n\t}\n\n\tprivate _runTickers(currentTime: number) {\n\t\t$array.each(this._tickers, (f) => {\n\t\t\tf(currentTime);\n\t\t});\n\t}\n\n\tprivate _runAnimations(currentTime: number): boolean {\n\t\tlet running = 0;\n\n\t\t$array.keepIf(this._animations, (animation) => {\n\t\t\tconst state = animation._runAnimation(currentTime);\n\n\t\t\tif (state === AnimationState.Stopped) {\n\t\t\t\treturn false;\n\n\t\t\t} else if (state === AnimationState.Playing) {\n\t\t\t\t++running;\n\t\t\t\treturn true;\n\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\tthis._isDirtyAnimation = false;\n\n\t\treturn running === 0;\n\t}\n\n\tprivate _runDirties() {\n\t\t//console.log(\"tick **************************************************************\");\t\t\n\t\tlet allParents: { [id: number]: IParent } = {};\n\n\t\twhile (this._isDirtyParents) {\n\t\t\t// This must be before calling _prepareChildren\n\t\t\tthis._isDirtyParents = false;\n\n\t\t\t$object.keys(this._dirtyParents).forEach((key) => {\n\t\t\t\tconst parent = this._dirtyParents[key];\n\n\t\t\t\tdelete this._dirtyParents[key];\n\n\t\t\t\tif (!parent.isDisposed()) {\n\t\t\t\t\tallParents[parent.uid] = parent;\n\t\t\t\t\tparent._prepareChildren();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$object.keys(allParents).forEach((key) => {\n\t\t\tallParents[key]._updateChildren();\n\t\t});\n\n\n\t\tconst objects: Array<Entity> = [];\n\n\t\t//\t\tconsole.log(\"_beforeChanged\")\n\t\t$object.keys(this._dirty).forEach((key) => {\n\t\t\tconst entity = this._dirty[key];\n\n\t\t\tif (entity.isDisposed()) {\n\t\t\t\tdelete this._dirty[entity.uid];\n\n\t\t\t} else {\n\t\t\t\tobjects.push(entity);\n\t\t\t\tentity._beforeChanged();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_changed\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._changed();\n\t\t\tdelete this._dirty[entity.uid];\n\t\t\tentity._clearDirty();\n\t\t});\n\n\t\tthis._isDirty = false;\n\n\t\tconst depths: { [id: number]: number } = {};\n\t\tconst bounds: Array<IBounds> = [];\n\n\t\t$object.keys(this._dirtyBounds).forEach((key) => {\n\t\t\tconst entity = this._dirtyBounds[key];\n\n\t\t\tdelete this._dirtyBounds[key];\n\n\t\t\tif (!entity.isDisposed()) {\n\t\t\t\tdepths[entity.uid] = entity.depth();\n\t\t\t\tbounds.push(entity);\n\t\t\t}\n\t\t});\n\n\t\tthis._positionHTMLElements();\n\n\t\t// High depth -> low depth\n\t\tbounds.sort((x, y) => {\n\t\t\treturn $order.compare(depths[y.uid], depths[x.uid]);\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updateBounds\")\n\t\tbounds.forEach((entity) => {\n\t\t\tentity._updateBounds();\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updatePosition\")\n\t\tconst dirtyPositions = this._dirtyPositions;\n\t\t$object.keys(dirtyPositions).forEach((key) => {\n\t\t\tconst sprite = dirtyPositions[key];\n\n\t\t\tdelete dirtyPositions[key];\n\n\t\t\tif (!sprite.isDisposed()) {\n\t\t\t\tsprite._updatePosition();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_afterChanged\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._afterChanged();\n\t\t});\n\n\t\t$object.keys(allParents).forEach((key) => {\n\t\t\tallParents[key]._childrenPrep = false;\n\t\t\tallParents[key]._childrenUpdt = false;\n\t\t});\n\t}\n\n\tprivate _renderFrame(currentTime: number): boolean {\n\t\tif (this._updateTick) {\n\t\t\tif (this.events.isEnabled(\"framestarted\")) {\n\t\t\t\tthis.events.dispatch(\"framestarted\", {\n\t\t\t\t\ttype: \"framestarted\",\n\t\t\t\t\ttarget: this,\n\t\t\t\t\ttimestamp: currentTime,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._checkComputedStyles();\n\t\t\tthis._runTickers(currentTime);\n\n\t\t\tconst animationDone = this._runAnimations(currentTime);\n\n\t\t\tthis._runDirties();\n\t\t\tthis._render();\n\t\t\tthis._renderer.resetImageArray();\n\t\t\tthis._positionHTMLElements();\n\n\t\t\tif (this.events.isEnabled(\"frameended\")) {\n\t\t\t\tthis.events.dispatch(\"frameended\", {\n\t\t\t\t\ttype: \"frameended\",\n\t\t\t\t\ttarget: this,\n\t\t\t\t\ttimestamp: currentTime,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this._tickers.length === 0 &&\n\t\t\t\tanimationDone &&\n\t\t\t\t!this._isDirtyAnimation &&\n\t\t\t\t!this._isDirty;\n\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic _runTicker(currentTime: number, now?: boolean) {\n\t\tif (!this.isDisposed()) {\n\t\t\tthis.animationTime = currentTime;\n\n\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t// No more work to do\n\t\t\tif (done) {\n\t\t\t\tthis._ticker = null;\n\t\t\t\tthis.animationTime = null;\n\n\t\t\t} else {\n\t\t\t\tif (!this._paused) {\n\t\t\t\t\tif (now) {\n\t\t\t\t\t\tthis._ticker!\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\trAF(this.fps, this._ticker!);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _runTickerNow(timeout: number = 10000) {\n\t\tif (!this.isDisposed()) {\n\t\t\tconst endTime = performance.now() + timeout;\n\n\t\t\tfor (; ;) {\n\t\t\t\tconst currentTime = performance.now();\n\n\t\t\t\tif (currentTime >= endTime) {\n\t\t\t\t\tthis.animationTime = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis.animationTime = currentTime;\n\n\t\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t\tif (done) {\n\t\t\t\t\tthis.animationTime = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _startTicker() {\n\t\tif (this._ticker === null) {\n\t\t\tthis.animationTime = null;\n\n\t\t\tthis._ticker = (currentTime) => {\n\t\t\t\tthis._runTicker(currentTime);\n\t\t\t};\n\n\t\t\trAF(this.fps, this._ticker!);\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether the root is updating or not.\n\t */\n\tpublic get updateTick(): boolean {\n\t\treturn this._updateTick;\n\t}\n\n\t/**\n\t * Enables or disables the root updating.\n\t */\n\tpublic set updateTick(value: boolean) {\n\t\tthis._updateTick = value;\n\n\t\tif (value) {\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addDirtyEntity(entity: Entity) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirty[entity.uid] === undefined) {\n\t\t\tthis._dirty[entity.uid] = entity;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyParent(parent: IParent) {\n\t\tthis._isDirty = true;\n\t\tthis._isDirtyParents = true;\n\n\t\tif (this._dirtyParents[parent.uid] === undefined) {\n\t\t\tthis._dirtyParents[parent.uid] = parent;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyBounds(entity: IBounds) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirtyBounds[entity.uid] === undefined) {\n\t\t\tthis._dirtyBounds[entity.uid] = entity;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyPosition(sprite: Sprite) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirtyPositions[sprite.uid] === undefined) {\n\t\t\tthis._dirtyPositions[sprite.uid] = sprite;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addAnimation(animation: IAnimation) {\n\t\tthis._isDirtyAnimation = true;\n\n\t\t// TODO use numeric id instead\n\t\tif (this._animations.indexOf(animation) === -1) {\n\t\t\tthis._animations.push(animation);\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _markDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tpublic _markDirtyRedraw() {\n\t\tthis.events.once(\"frameended\", () => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._startTicker();\n\t\t})\n\t}\n\n\tpublic eachFrame(f: (currentTime: number) => void): IDisposer {\n\t\tthis._tickers.push(f);\n\t\tthis._startTicker();\n\n\t\treturn new Disposer(() => {\n\t\t\t$array.removeFirst(this._tickers, f);\n\t\t});\n\t}\n\n\tpublic markDirtyGlobal(container?: Container): void {\n\t\tif (!container) {\n\t\t\tcontainer = this.container;\n\t\t}\n\t\tcontainer.walkChildren((child) => {\n\t\t\tif (child instanceof Container) {\n\t\t\t\tthis.markDirtyGlobal(child);\n\t\t\t}\n\t\t\tchild.markDirty();\n\t\t\tchild.markDirtyBounds();\n\t\t});\n\t}\n\n\t/**\n\t * Returns width of the target container, in pixels.\n\t *\n\t * @return Width\n\t */\n\tpublic width(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's width ?\n\t\treturn Math.floor(this._getCalculatedSize(this._getRealSize()).width);\n\t}\n\n\t/**\n\t * Returns height of the target container, in pixels.\n\t *\n\t * @return Height\n\t */\n\tpublic height(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's height ?\n\t\treturn Math.floor(this._getCalculatedSize(this._getRealSize()).height);\n\t}\n\n\t/**\n\t * Disposes root and all the content in it.\n\t */\n\tpublic dispose(): void {\n\t\tif (!this._isDisposed) {\n\t\t\tthis._isDisposed = true;\n\n\t\t\tthis._rootContainer.dispose();\n\t\t\tthis._renderer.dispose();\n\t\t\tthis.horizontalLayout.dispose();\n\t\t\tthis.verticalLayout.dispose();\n\t\t\tthis.interfaceColors.dispose();\n\n\t\t\t$array.each(this._disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\n\t\t\tif (this._inner) {\n\t\t\t\t$utils.removeElement(this._inner);\n\t\t\t}\n\n\t\t\t$array.remove(registry.rootElements, this);\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if root element is disposed.\n\t *\n\t * @return Disposed?\n\t */\n\tpublic isDisposed(): boolean {\n\t\treturn this._isDisposed;\n\t}\n\n\t/**\n\t * Triggers screen reader read out a message.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t * @param  text  Alert text\n\t */\n\tpublic readerAlert(text: string): void {\n\t\tif (this._a11yD !== true) {\n\t\t\tconst element = this._readerAlertElement!;\n\t\t\ttext = $utils.stripTags(text);\n\t\t\tif (element.innerHTML == text) {\n\t\t\t\telement.innerHTML = \"\";\n\t\t\t}\n\t\t\telement.innerHTML = text;\n\t\t}\n\t}\n\n\t/**\n\t * Sets themes to be used for the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/themes/} for more info\n\t * @param  themes  A list of themes\n\t */\n\tpublic setThemes(themes: Array<Theme>): void {\n\t\tthis._rootContainer.set(\"themes\", themes);\n\n\t\t// otherwise new themes are not applied\n\t\tconst tooltipContainer = this.tooltipContainer;\n\t\tif (tooltipContainer) {\n\t\t\ttooltipContainer._applyThemes();\n\t\t}\n\n\t\t// @todo review this\n\t\tconst interfaceColors = this.interfaceColors;\n\t\tif (interfaceColors) {\n\t\t\tinterfaceColors._applyThemes();\n\t\t}\n\n\n\t}\n\n\tprotected _addTooltip() {\n\t\tif (!this.tooltipContainer) {\n\t\t\tconst tooltipContainerSettings = this._tooltipContainerSettings;\n\t\t\tconst tooltipContainer = this._rootContainer.children.push(Container.new(this, {\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tisMeasured: false,\n\t\t\t\twidth: p100,\n\t\t\t\theight: p100,\n\t\t\t\tlayer: tooltipContainerSettings ? 35 : 30,\n\t\t\t\tlayerMargin: tooltipContainerSettings ? tooltipContainerSettings : undefined\n\t\t\t}));\n\t\t\tthis.tooltipContainer = tooltipContainer;\n\n\t\t\tconst tooltip = Tooltip.new(this, {});\n\t\t\tthis.container.set(\"tooltip\", tooltip);\n\t\t\ttooltip.hide(0);\n\t\t\tthis._tooltip = tooltip;\n\t\t}\n\t}\n\n\t/**\n\t * Accesibility\n\t */\n\n\tpublic _registerTabindexOrder(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (target.get(\"focusable\")) {\n\t\t\t$array.pushOne(this._tabindexes, target);\n\t\t}\n\t\telse {\n\t\t\t$array.remove(this._tabindexes, target);\n\t\t}\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _unregisterTabindexOrder(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t$array.remove(this._tabindexes, target);\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _invalidateTabindexes(): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tabindexes.sort((a: Sprite, b: Sprite) => {\n\t\t\tconst aindex = a.get(\"tabindexOrder\", 0);\n\t\t\tconst bindex = b.get(\"tabindexOrder\", 0);\n\t\t\tif (aindex == bindex) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if (aindex > bindex) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\tconst groups: Array<string | number> = [];\n\t\t$array.each(this._tabindexes, (item, index) => {\n\t\t\tif (!item.getPrivate(\"focusElement\")) {\n\t\t\t\tthis._makeFocusElement(index, item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._moveFocusElement(index, item);\n\t\t\t}\n\t\t\tconst group = item.get(\"focusableGroup\");\n\t\t\tif (group && item.getPrivate(\"focusable\") !== false) {\n\t\t\t\tif (groups.indexOf(group) !== -1) {\n\t\t\t\t\t// Non-first element in the group, make it not directly focusable\n\t\t\t\t\titem.getPrivate(\"focusElement\")!.dom.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tgroups.push(group);\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tpublic _updateCurrentFocus(): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._focusedSprite) {\n\t\t\tthis._decorateFocusElement(this._focusedSprite);\n\t\t\tthis._positionFocusElement(this._focusedSprite);\n\t\t}\n\t}\n\n\tpublic _decorateFocusElement(target: Sprite, focusElement?: HTMLDivElement): void {\n\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Decorate with proper accessibility attributes\n\t\tif (!focusElement) {\n\t\t\tfocusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\t}\n\n\t\tif (!focusElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst role = target.get(\"role\");\n\t\tif (role) {\n\t\t\tfocusElement.setAttribute(\"role\", role);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"role\");\n\t\t}\n\n\t\tconst ariaLabel = target.get(\"ariaLabel\");\n\t\tif (ariaLabel) {\n\t\t\tconst label = populateString(target, ariaLabel);\n\t\t\tfocusElement.setAttribute(\"aria-label\", label);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-label\");\n\t\t}\n\n\t\tconst ariaLive = target.get(\"ariaLive\");\n\t\tif (ariaLive) {\n\t\t\tfocusElement.setAttribute(\"aria-live\", ariaLive);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-live\");\n\t\t}\n\n\t\tconst ariaChecked = target.get(\"ariaChecked\");\n\t\tif (ariaChecked != null && role && [\"checkbox\", \"option\", \"radio\", \"menuitemcheckbox\", \"menuitemradio\", \"treeitem\"].indexOf(role) !== -1) {\n\t\t\tfocusElement.setAttribute(\"aria-checked\", ariaChecked ? \"true\" : \"false\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-checked\");\n\t\t}\n\n\t\tconst ariaCurrent = target.get(\"ariaCurrent\");\n\t\tif (ariaCurrent != null) {\n\t\t\tfocusElement.setAttribute(\"aria-current\", ariaCurrent);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-current\");\n\t\t}\n\n\t\tconst ariaSelected = target.get(\"ariaSelected\");\n\t\tif (ariaSelected != null && role && [\"gridcell\", \"option\", \"row\", \"tab\", \"columnheader\", \"rowheader\", \"treeitem\"].indexOf(role) !== -1) {\n\t\t\tfocusElement.setAttribute(\"aria-selected\", ariaSelected ? \"true\" : \"false\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-selected\");\n\t\t}\n\n\t\tif (target.get(\"ariaHidden\")) {\n\t\t\tfocusElement.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-hidden\");\n\t\t}\n\n\t\tconst ariaOrientation = target.get(\"ariaOrientation\");\n\t\tif (ariaOrientation) {\n\t\t\tfocusElement.setAttribute(\"aria-orientation\", ariaOrientation);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-orientation\");\n\t\t}\n\n\t\tconst ariaValueNow = target.get(\"ariaValueNow\");\n\t\tif (ariaValueNow) {\n\t\t\tfocusElement.setAttribute(\"aria-valuenow\", ariaValueNow);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuenow\");\n\t\t}\n\n\t\tconst ariaValueMin = target.get(\"ariaValueMin\");\n\t\tif (ariaValueMin) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemin\", ariaValueMin);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemin\");\n\t\t}\n\n\t\tconst ariaValueMax = target.get(\"ariaValueMax\");\n\t\tif (ariaValueMax) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemax\", ariaValueMax);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemax\");\n\t\t}\n\n\t\tconst ariaValueText = target.get(\"ariaValueText\");\n\t\tif (ariaValueText) {\n\t\t\tfocusElement.setAttribute(\"aria-valuetext\", ariaValueText);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuetext\");\n\t\t}\n\n\t\tconst ariaControls = target.get(\"ariaControls\");\n\t\tif (ariaControls) {\n\t\t\tfocusElement.setAttribute(\"aria-controls\", ariaControls);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-controls\");\n\t\t}\n\n\t\tif (target.get(\"visible\") && target.get(\"opacity\") !== 0 && target.get(\"role\") != \"tooltip\" && !target.isHidden() && target.getPrivate(\"focusable\") !== false && (target.height() || target.width())) {\n\t\t\tif (focusElement.getAttribute(\"tabindex\") != \"-1\") {\n\t\t\t\tfocusElement.setAttribute(\"tabindex\", \"\" + this.tabindex);\n\t\t\t}\n\t\t\tfocusElement.removeAttribute(\"aria-hidden\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"tabindex\");\n\t\t\tfocusElement.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t}\n\n\tpublic _makeFocusElement(index: number, target: Sprite): void {\n\n\t\tif (target.getPrivate(\"focusElement\") || this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Init\n\t\tconst focusElement = document.createElement(\"div\");\n\t\tif (target.get(\"role\") != \"tooltip\") {\n\t\t\tfocusElement.tabIndex = this.tabindex;\n\t\t}\n\t\tfocusElement.style.position = \"absolute\";\n\t\t$utils.setInteractive(focusElement, false);\n\n\t\tconst disposers: Array<IDisposer> = [];\n\n\t\ttarget.setPrivate(\"focusElement\", {\n\t\t\tdom: focusElement,\n\t\t\tdisposers,\n\t\t});\n\n\t\tthis._decorateFocusElement(target);\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"focus\", (ev: FocusEvent) => {\n\t\t\tthis._handleFocus(ev);\n\t\t}));\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"blur\", (ev: FocusEvent) => {\n\t\t\tthis._handleBlur(ev);\n\t\t}));\n\n\t\tthis._moveFocusElement(index, target);\n\n\t}\n\n\tpublic _removeFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t$array.remove(this._tabindexes, target);\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (focusElement) {\n\t\t\tconst container = this._focusElementContainer!;\n\t\t\tcontainer.removeChild(focusElement.dom);\n\t\t\t$array.each(focusElement.disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic _hideFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!;\n\t\tfocusElement.dom.style.display = \"none\";\n\t}\n\n\tprotected _moveFocusElement(index: number, target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get container\n\t\tconst container = this._focusElementContainer!;\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\n\t\tif (focusElement === this._focusElementContainer!.children[index]) {\n\t\t\t// Nothing to do\n\t\t\treturn;\n\t\t}\n\n\t\tconst next = this._focusElementContainer!.children[index + 1];\n\t\tif (next) {\n\t\t\tcontainer.insertBefore(focusElement, next);\n\t\t}\n\t\telse {\n\t\t\tcontainer.append(focusElement);\n\t\t}\n\t}\n\n\tprotected _positionFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true || target == undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst bounds = target.globalBounds();\n\n\t\tlet width = bounds.right == bounds.left ? target.width() : bounds.right - bounds.left;\n\t\tlet height = bounds.top == bounds.bottom ? target.height() : bounds.bottom - bounds.top;\n\n\t\tconst padding = this._settings.focusPadding !== undefined ? this._settings.focusPadding : 2;\n\n\t\tlet x = bounds.left - padding;\n\t\tlet y = bounds.top - padding;\n\n\t\tif (width < 0) {\n\t\t\tx += width;\n\t\t\twidth = Math.abs(width);\n\t\t}\n\n\t\tif (height < 0) {\n\t\t\ty += height;\n\t\t\theight = Math.abs(height);\n\t\t}\n\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\tfocusElement.style.top = y + \"px\";\n\t\tfocusElement.style.left = x + \"px\";\n\t\tfocusElement.style.width = (width + padding * 2) + \"px\";\n\t\tfocusElement.style.height = (height + padding * 2) + \"px\";\n\n\t}\n\n\tprotected _getSpriteByFocusElement(target: any): Sprite | undefined {\n\t\tlet found: Sprite | undefined;\n\t\t$array.eachContinue(this._tabindexes, (item, _index) => {\n\t\t\tif (item.getPrivate(\"focusElement\")!.dom === target) {\n\t\t\t\tfound = item;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\treturn found;\n\t}\n\n\tprotected _handleFocus(ev: FocusEvent): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get element\n\t\t//const focused = this._tabindexes[index];\n\t\tconst focused = this._getSpriteByFocusElement(ev.target);\n\n\t\tif (!focused) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Jump over hidden elements\n\t\tif (!focused.isVisibleDeep()) {\n\t\t\tthis._focusNext(<HTMLDivElement>ev.target, this._isShift ? -1 : 1);\n\t\t\treturn;\n\t\t}\n\n\t\t// Size and position\n\t\tthis._positionFocusElement(focused);\n\t\t//this._decorateFocusElement(focused);\n\n\t\tthis._focusedSprite = focused;\n\n\t\tif (focused.events.isEnabled(\"focus\")) {\n\t\t\tfocused.events.dispatch(\"focus\", {\n\t\t\t\ttype: \"focus\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\n\t\tif (focused.getPrivate(\"focusElement\")!.dom.tabIndex == -1) {\n\t\t\tthis._skipNextGroupJump = false;\n\t\t}\n\t}\n\n\tprotected _focusNext(el: HTMLDivElement, direction: 1 | -1, group?: string | number): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusableElements = Array.from(document.querySelectorAll([\n\t\t\t'a[href]',\n\t\t\t'area[href]',\n\t\t\t'button:not([disabled])',\n\t\t\t'details',\n\t\t\t'input:not([disabled])',\n\t\t\t'iframe:not([disabled])',\n\t\t\t'select:not([disabled])',\n\t\t\t'textarea:not([disabled])',\n\t\t\t'[contentEditable=\"\"]',\n\t\t\t'[contentEditable=\"true\"]',\n\t\t\t'[contentEditable=\"TRUE\"]',\n\t\t\t'[tabindex]:not([tabindex^=\"-\"])',\n\t\t\t//':not([disabled])'\n\t\t].join(',')));\n\n\t\tlet index = focusableElements.indexOf(el) + direction;\n\n\t\tif (index < 0) {\n\t\t\tindex = focusableElements.length - 1;\n\t\t}\n\t\telse if (index >= focusableElements.length) {\n\t\t\tindex = 0;\n\t\t}\n\n\t\tconst targetElement = (<HTMLDivElement>focusableElements[index]);\n\n\t\tif (group && direction == -1) {\n\t\t\tconst target = this._getSpriteByFocusElement(targetElement);\n\t\t\tif (target && target.get(\"focusableGroup\") == group) {\n\t\t\t\tthis._focusNext(targetElement, direction);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttargetElement.focus();\n\t}\n\n\tprotected _handleBlur(ev: FocusEvent): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focused = this._focusedSprite;\n\t\tif (focused && !focused.isDisposed() && focused.events.isEnabled(\"blur\")) {\n\t\t\tfocused.events.dispatch(\"blur\", {\n\t\t\t\ttype: \"blur\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\n\t\tthis._focusedSprite = undefined;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic updateTooltip(target: Text): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst text = $utils.stripTags(target._getText());\n\t\tlet tooltipElement = target.getPrivate(\"tooltipElement\");\n\t\tif (target.get(\"role\") == \"tooltip\" && text != \"\") {\n\t\t\tif (!tooltipElement) {\n\t\t\t\ttooltipElement = this._makeTooltipElement(target);\n\t\t\t}\n\t\t\tif (tooltipElement.innerHTML != text) {\n\t\t\t\ttooltipElement.innerHTML = text!;\n\t\t\t}\n\t\t\ttooltipElement.setAttribute(\"aria-hidden\", target.isVisibleDeep() ? \"false\" : \"true\");\n\t\t}\n\t\telse if (tooltipElement) {\n\t\t\ttooltipElement.remove();\n\t\t\ttarget.removePrivate(\"tooltipElement\");\n\t\t}\n\t}\n\n\tpublic _makeTooltipElement(target: Text): HTMLDivElement {\n\t\tconst container = this._tooltipElementContainer!;\n\t\tconst tooltipElement = document.createElement(\"div\");\n\t\ttooltipElement.style.position = \"absolute\";\n\t\ttooltipElement.style.width = \"1px\";\n\t\ttooltipElement.style.height = \"1px\";\n\t\ttooltipElement.style.overflow = \"hidden\";\n\t\ttooltipElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\n\n\t\t$utils.setInteractive(tooltipElement, false);\n\n\t\tthis._decorateFocusElement(target, tooltipElement);\n\t\tcontainer.append(tooltipElement);\n\t\ttarget.setPrivate(\"tooltipElement\", tooltipElement);\n\n\t\treturn tooltipElement;\n\t}\n\n\tpublic _removeTooltipElement(target: Text): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\t\tconst tooltipElement = target.getPrivate(\"tooltipElement\");\n\t\tif (tooltipElement) {\n\t\t\tconst parent = tooltipElement.parentElement;\n\t\t\tif (parent) {\n\t\t\t\tparent.removeChild(tooltipElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _invalidateAccessibility(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\t\tthis._focusElementDirty = true;\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (target.get(\"focusable\")) {\n\t\t\tif (focusElement) {\n\t\t\t\tthis._decorateFocusElement(target);\n\t\t\t\tthis._positionFocusElement(target);\n\t\t\t}\n\t\t\t// else {\n\t\t\t// \tthis._renderer._makeFocusElement(0, this);\n\t\t\t// }\n\t\t}\n\t\telse if (focusElement) {\n\t\t\tthis._removeFocusElement(target);\n\t\t}\n\t\t//this.updateCurrentFocus();\n\t}\n\n\t/**\n\t * Returns `true` if `target` is currently focused.\n\t *\n\t * @param   target  Target\n\t * @return          Focused?\n\t */\n\tpublic focused(target: Sprite): boolean {\n\t\treturn this._focusedSprite === target;\n\t}\n\n\t/**\n\t * Converts document coordinates to coordinates withing root element.\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic documentPointToRoot(point: IPoint): IPoint {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst scaleWidth = size.width / rect.width;\n\t\tconst scaleHeight = size.height / rect.height;\n\n\t\treturn {\n\t\t\tx: (point.x - rect.left) * scaleWidth,\n\t\t\ty: (point.y - rect.top) * scaleHeight,\n\t\t};\n\t}\n\n\t/**\n\t * Converts root coordinates to document\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic rootPointToDocument(point: IPoint): IPoint {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst scaleWidth = size.width / rect.width;\n\t\tconst scaleHeight = size.height / rect.height;\n\n\t\treturn {\n\t\t\tx: (point.x / scaleWidth) + rect.left,\n\t\t\ty: (point.y / scaleHeight) + rect.top\n\t\t};\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic addDisposer<T extends IDisposer>(disposer: T): T {\n\t\tthis._disposers.push(disposer);\n\t\treturn disposer;\n\t}\n\n\tprotected _updateComputedStyles(): boolean {\n\t\tconst styles = window.getComputedStyle(this.dom);\n\t\tlet fontHash = \"\";\n\t\t$object.each(styles, (key, val) => {\n\t\t\tif ($type.isString(key) && key.match(/^font/)) {\n\t\t\t\tfontHash += val;\n\t\t\t}\n\t\t})\n\t\tconst changed = fontHash != this._fontHash;\n\t\tif (changed) {\n\t\t\tthis._fontHash = fontHash;\n\t\t}\n\t\treturn changed;\n\t}\n\n\tprotected _checkComputedStyles(): void {\n\t\tif (this._updateComputedStyles()) {\n\t\t\tthis._invalidateLabelBounds(this.container);\n\t\t}\n\t}\n\n\tprotected _invalidateLabelBounds(target: Sprite): void {\n\t\tif (target instanceof Container) {\n\t\t\ttarget.children.each((child) => {\n\t\t\t\tthis._invalidateLabelBounds(child);\n\t\t\t});\n\t\t}\n\t\telse if (target instanceof Text) {\n\t\t\ttarget.markDirtyBounds();\n\t\t}\n\t}\n\n\t/**\n\t * To all the clever heads out there. Yes, we did not make any attempts to\n\t * scramble this.\n\t *\n\t * This is a part of a tool meant for our users to manage their commercial\n\t * licenses for removal of amCharts branding from charts.\n\t *\n\t * The only legit way to do so is to purchase a commercial license for amCharts:\n\t * https://www.amcharts.com/online-store/\n\t *\n\t * Removing or altering this code, or disabling amCharts branding in any other\n\t * way is against the license and thus illegal.\n\t */\n\tprotected _hasLicense(): boolean {\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\n\t\t\tif (registry.licenses[i].match(/^AM5C.{5,}/i)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic _licenseApplied(): void {\n\t\tif (this._logo) {\n\t\t\tthis._logo.set(\"forceHidden\", true);\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic get debugGhostView(): boolean {\n\t\treturn this._renderer.debugGhostView;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic set debugGhostView(value: boolean) {\n\t\tthis._renderer.debugGhostView = value;\n\t}\n\n\t/**\n\t * Set this to `true` if you need chart to require first a tap onto it before\n\t * touch gesture related functionality like zoom/pan is turned on.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default false\n\t * @since 5.2.9\n\t * @param  value  Needs a tap to activate touch functions\n\t */\n\tpublic set tapToActivate(value: boolean) {\n\t\tthis._renderer.tapToActivate = value;\n\t}\n\n\t/**\n\t * @return Needs a tap to activate touch functions\n\t */\n\tpublic get tapToActivate(): boolean {\n\t\treturn this._renderer.tapToActivate;\n\t}\n\n\t/**\n\t * If `tapToActivate` is set to `true`, this setting will determine number\n\t * of milliseconds the chart will stay \"active\", before releasing the\n\t * controls back to the page.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default 3000\n\t * @since 5.2.9\n\t * @param  value  Timeout\n\t */\n\tpublic set tapToActivateTimeout(value: number) {\n\t\tthis._renderer.tapToActivateTimeout = value;\n\t}\n\n\t/**\n\t * @return Timeout\n\t */\n\tpublic get tapToActivateTimeout(): number {\n\t\treturn this._renderer.tapToActivateTimeout;\n\t}\n\n\tpublic _makeHTMLElement(target: Container): HTMLDivElement {\n\n\t\t// Get container\n\t\tconst container = this._htmlElementContainer!;\n\n\t\t// Init\n\t\tconst htmlElement = document.createElement(\"div\");\n\t\ttarget.setPrivate(\"htmlElement\", htmlElement);\n\n\t\t// Should we put this into a wrapper?\n\t\tlet needWrapper: Boolean = false;\n\t\tlet wrapperTarget: Container;\n\t\ttarget._walkParents((parent) => {\n\t\t\tif ((parent as Container).get(\"verticalScrollbar\")) {\n\t\t\t\tneedWrapper = true;\n\t\t\t\twrapperTarget = parent as Container;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tlet htmlElementWrapper: HTMLDivElement;\n\n\t\tif (needWrapper) {\n\t\t\thtmlElementWrapper = document.createElement(\"div\");\n\t\t\ttarget.setPrivate(\"htmlElementWrapper\", htmlElementWrapper);\n\t\t\ttarget.setPrivate(\"wrapperContainer\", wrapperTarget!);\n\n\t\t\thtmlElementWrapper.style.position = \"absolute\";\n\t\t\thtmlElementWrapper.style.overflow = \"hidden\";\n\t\t\thtmlElementWrapper.style.boxSizing = \"border-box\";\n\t\t\thtmlElementWrapper.style.top = \"0px\";\n\t\t\thtmlElementWrapper.style.left = \"0px\";\n\t\t\thtmlElementWrapper.style.width = \"100%\";\n\t\t\thtmlElementWrapper.style.height = \"100%\";\n\n\t\t\twrapperTarget!.events.on(\"boundschanged\", () => {\n\t\t\t\tthis._positionHTMLElement(target);\n\t\t\t});\n\t\t}\n\n\t\t//htmlElement.tabIndex = this.tabindex;\n\t\thtmlElement.style.position = \"absolute\";\n\t\thtmlElement.style.overflow = \"auto\";\n\t\thtmlElement.style.boxSizing = \"border-box\";\n\t\t$utils.setInteractive(htmlElement, target.get(\"interactive\", false));\n\n\t\t// Translate events\n\t\tif (target.events.isEnabled(\"click\")) {\n\t\t\t$utils.setInteractive(htmlElement, true);\n\t\t\tthis._disposers.push($utils.addEventListener<PointerEvent | MouseEvent>(htmlElement, \"click\", (ev: IPointerEvent) => {\n\t\t\t\tconst downEvent = this._renderer.getEvent(ev);\n\t\t\t\ttarget.events.dispatch(\"click\", {\n\t\t\t\t\ttype: \"click\",\n\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\tsimulated: false,\n\t\t\t\t\ttarget: target\n\t\t\t\t});\n\t\t\t}));\n\t\t}\n\n\t\tthis._positionHTMLElement(target);\n\n\t\tif (needWrapper) {\n\t\t\thtmlElementWrapper!.append(htmlElement);\n\t\t\tcontainer.append(htmlElementWrapper!);\n\t\t}\n\t\telse {\n\t\t\tcontainer.append(htmlElement);\n\t\t}\n\n\t\t$array.pushOne(this._htmlEnabledContainers, target);\n\n\t\treturn htmlElement;\n\t}\n\n\tpublic _positionHTMLElements(): void {\n\t\t$array.each(this._htmlEnabledContainers, (target) => {\n\t\t\tthis._positionHTMLElement(target);\n\t\t});\n\t}\n\n\tpublic _positionHTMLElement(target: Container): void {\n\t\tconst htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\n\t\tif (htmlElementWrapper) {\n\t\t\tconst wrapperTarget = target.getPrivate(\"wrapperContainer\");\n\t\t\tif (wrapperTarget) {\n\t\t\t\tconst bounds = wrapperTarget.globalBounds();\n\t\t\t\thtmlElementWrapper.style.clipPath = \"rect(\" + bounds.top + \"px \" + bounds.right + \"px \" + bounds.bottom + \"px \" + bounds.left + \"px)\";\n\t\t\t}\n\t\t}\n\n\t\tconst htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElement) {\n\n\t\t\t// Translate settings\n\t\t\tconst visualSettings = [\n\t\t\t\t\"paddingTop\",\n\t\t\t\t\"paddingRight\",\n\t\t\t\t\"paddingBottom\",\n\t\t\t\t\"paddingLeft\",\n\t\t\t\t\"minWidth\",\n\t\t\t\t\"minHeight\",\n\t\t\t\t\"maxWidth\",\n\t\t\t\t\"maxHeight\"\n\t\t\t];\n\t\t\t$array.each(visualSettings, (setting: any) => {\n\t\t\t\tconst value = target.get(setting);\n\t\t\t\tif (value) {\n\t\t\t\t\thtmlElement.style[setting] = value + \"px\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thtmlElement.style[setting] = \"\";\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst strtingSettings = [\n\t\t\t\t\"fontFamily\",\n\t\t\t\t\"fontSize\",\n\t\t\t\t\"fontStyle\",\n\t\t\t\t\"fontWeight\",\n\t\t\t\t\"fontStyle\",\n\t\t\t\t\"fontVariant\",\n\t\t\t\t\"textDecoration\"\n\t\t\t];\n\t\t\t$array.each(strtingSettings, (setting: any) => {\n\t\t\t\tconst value = target.get(setting);\n\t\t\t\tif (value) {\n\t\t\t\t\tif (setting == \"fontSize\" && !$type.isString(value)) {\n\t\t\t\t\t\thtmlElement.style[setting] = value + \"px\";\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\thtmlElement.style[setting] = value + \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thtmlElement.style[setting] = \"\";\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Init and reset scale / rotation\n\t\t\tconst scale = target.compositeScale() || 1;\n\t\t\tconst rotation = target.compositeRotation() || 0;\n\t\t\thtmlElement.style.transform = \"\";\n\t\t\thtmlElement.style.transformOrigin = \"\";\n\n\t\t\t// Deal with opacity\n\t\t\tconst opacity = target.compositeOpacity();\n\t\t\tsetTimeout(() => {\n\t\t\t\thtmlElement.style.opacity = opacity + \"\";\n\t\t\t}, 10);\n\n\t\t\tconst visible = target.isVisibleDeep();\n\t\t\tif (visible) {\n\t\t\t\thtmlElement.style.display = \"block\";\n\t\t\t}\n\n\t\t\t// Deal with position\n\t\t\t// const bounds = target.globalBounds();\n\t\t\t// htmlElement.style.top = (bounds.top) + \"px\";\n\t\t\t// htmlElement.style.left = (bounds.left) + \"px\";\n\t\t\tlet pos = {\n\t\t\t\tx: target.x() + target.get(\"dx\", 0),\n\t\t\t\ty: target.y() + target.get(\"dy\", 0)\n\t\t\t}\n\t\t\tif (target.parent) {\n\t\t\t\tpos = target.parent.toGlobal(pos)\n\t\t\t}\n\t\t\thtmlElement.style.top = pos.y + \"px\";\n\t\t\thtmlElement.style.left = pos.x + \"px\";\n\n\t\t\t// Use width/height if those are set\n\t\t\tconst width = target.get(\"width\");\n\t\t\tconst height = target.get(\"height\");\n\n\t\t\tlet w: number = 0;\n\t\t\tlet h: number = 0;\n\n\t\t\tif (width) {\n\t\t\t\tw = target.width();\n\t\t\t}\n\n\t\t\tif (height) {\n\t\t\t\th = target.height();\n\t\t\t}\n\n\n\t\t\tif (!width || !height) {\n\t\t\t\thtmlElement.style.position = \"fixed\";\n\t\t\t\thtmlElement.style.width = \"\";\n\t\t\t\thtmlElement.style.height = \"\";\n\t\t\t\tconst bbox = htmlElement.getBoundingClientRect();\n\t\t\t\thtmlElement.style.position = \"absolute\";\n\t\t\t\tif (!width) w = bbox.width;\n\t\t\t\tif (!height) h = bbox.height;\n\n\t\t\t\tlet lw = w / scale;\n\t\t\t\tlet lh = h / scale;\n\n\t\t\t\tlet cx = target.get(\"centerX\", 0);\n\t\t\t\tlet cy = target.get(\"centerY\", 0);\n\n\t\t\t\tlet ll = 0;\n\t\t\t\tlet lr = 0;\n\t\t\t\tlet lt = 0;\n\t\t\t\tlet lb = 0;\n\n\t\t\t\tif (cx instanceof Percent) {\n\t\t\t\t\tll = -cx.value * lw;\n\t\t\t\t\tlr = (1 - cx.value) * lw;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tll = -cx;\n\t\t\t\t\tlr = lw - cx;\n\t\t\t\t}\n\n\t\t\t\tif (cy instanceof Percent) {\n\t\t\t\t\tlt = -cy.value * lh;\n\t\t\t\t\tlb = (1 - cy.value) * lh;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlt = -cy;\n\t\t\t\t\tlb = lh - cy;\n\t\t\t\t}\n\n\t\t\t\ttarget._localBounds = { left: ll, right: lr, top: lt, bottom: lb };\n\n\t\t\t\tlet previousBounds = target._adjustedLocalBounds;\n\t\t\t\tlet newBounds = target._display.getAdjustedBounds(target._localBounds);\n\t\t\t\ttarget._adjustedLocalBounds = newBounds;\n\n\t\t\t\t// compare each value of the bounds\n\t\t\t\tif (previousBounds.left !== newBounds.left || previousBounds.right !== newBounds.right || previousBounds.top !== newBounds.top || previousBounds.bottom !== newBounds.bottom) {\n\t\t\t\t\ttarget.markDirtyBounds();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (w > 0) {\n\t\t\t\thtmlElement.style.minWidth = (w) + \"px\";\n\t\t\t}\n\t\t\tif (h > 0) {\n\t\t\t\thtmlElement.style.minHeight = (h) + \"px\";\n\t\t\t}\n\n\t\t\t// Hide or show\n\t\t\tif (!visible || opacity == 0) {\n\t\t\t\thtmlElement.style.display = \"none\";\n\t\t\t}\n\n\t\t\t// Center position\n\t\t\tconst x = target.get(\"centerX\", 0);\n\t\t\tconst originX = isPercent(x) ? (x as Percent).percent + \"%\" : x + \"px\";\n\t\t\tconst y = target.get(\"centerY\", 0);\n\t\t\tconst originY = isPercent(y) ? (y as Percent).percent + \"%\" : y + \"px\";\n\n\t\t\tif (x || y) {\n\t\t\t\thtmlElement.style.transform = \"translate(-\" + originX + \", -\" + originY + \")\" + htmlElement.style.transform;\n\t\t\t}\n\n\t\t\t// Deal with scale\n\t\t\tif (scale != 1) {\n\t\t\t\thtmlElement.style.transform += \"scale(\" + scale + \")\";\n\t\t\t}\n\n\t\t\tif (rotation != 0) {\n\t\t\t\thtmlElement.style.transform += \" rotate(\" + rotation + \"deg)\";\n\t\t\t}\n\n\t\t\tif (htmlElement.style.transform != \"\") {\n\t\t\t\thtmlElement.style.transformOrigin = originX + \" \" + originY;\n\t\t\t\t//htmlElement.style.transformOrigin = \"0% 0%\";\n\t\t\t}\n\n\n\t\t}\n\t}\n\n\tpublic _setHTMLContent(target: Container, html: string): void {\n\t\tlet htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (!htmlElement) {\n\t\t\thtmlElement = this._makeHTMLElement(target);\n\t\t\tif (!this.autoResize) {\n\t\t\t\tthis.resize();\n\t\t\t}\n\t\t}\n\t\tif (htmlElement.innerHTML != html) {\n\t\t\thtmlElement.innerHTML = html;\n\t\t}\n\t}\n\n\tpublic _removeHTMLContent(target: Container): void {\n\t\tconst htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\n\t\tconst htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElementWrapper) {\n\t\t\tthis._htmlElementContainer!.removeChild(htmlElementWrapper);\n\t\t\ttarget.removePrivate(\"htmlElement\");\n\t\t\ttarget.removePrivate(\"htmlElementWrapper\");\n\t\t\ttarget.removePrivate(\"wrapperContainer\");\n\t\t}\n\t\telse if (htmlElement) {\n\t\t\tthis._htmlElementContainer!.removeChild(htmlElement);\n\t\t\ttarget.removePrivate(\"htmlElement\");\n\t\t\ttarget.removePrivate(\"wrapperContainer\");\n\t\t}\n\t\t$array.remove(this._htmlEnabledContainers, target);\n\t}\n}\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{Root as a,addLicense as s}from\"@amcharts/amcharts5/index.js\";import\"../../intl.js\";import{getLocale as t,getLocaleLanguage as r}from\"../../intl/locale.js\";s(\"AM5C241025748\");const c=\"en-US\",m=new Map([[\"ar\",()=>import(\"@amcharts/amcharts5/locales/ar.js\")],[\"bg-BG\",()=>import(\"@amcharts/amcharts5/locales/bg_BG.js\")],[\"bs-BA\",()=>import(\"@amcharts/amcharts5/locales/bs_BA.js\")],[\"ca-ES\",()=>import(\"@amcharts/amcharts5/locales/ca_ES.js\")],[\"cs-CZ\",()=>import(\"@amcharts/amcharts5/locales/cs_CZ.js\")],[\"da-DK\",()=>import(\"@amcharts/amcharts5/locales/da_DK.js\")],[\"de-DE\",()=>import(\"@amcharts/amcharts5/locales/de_DE.js\")],[\"de-CH\",()=>import(\"@amcharts/amcharts5/locales/de_CH.js\")],[\"el-GR\",()=>import(\"@amcharts/amcharts5/locales/el_GR.js\")],[\"en-US\",()=>import(\"@amcharts/amcharts5/locales/en_US.js\")],[\"en-CA\",()=>import(\"@amcharts/amcharts5/locales/en_CA.js\")],[\"es-ES\",()=>import(\"@amcharts/amcharts5/locales/es_ES.js\")],[\"et-EE\",()=>import(\"@amcharts/amcharts5/locales/et_EE.js\")],[\"fi-FI\",()=>import(\"@amcharts/amcharts5/locales/fi_FI.js\")],[\"fr-FR\",()=>import(\"@amcharts/amcharts5/locales/fr_FR.js\")],[\"he-IL\",()=>import(\"@amcharts/amcharts5/locales/he_IL.js\")],[\"hr-HR\",()=>import(\"@amcharts/amcharts5/locales/hr_HR.js\")],[\"hu-HU\",()=>import(\"@amcharts/amcharts5/locales/hu_HU.js\")],[\"id-ID\",()=>import(\"@amcharts/amcharts5/locales/id_ID.js\")],[\"it-IT\",()=>import(\"@amcharts/amcharts5/locales/it_IT.js\")],[\"ja-JP\",()=>import(\"@amcharts/amcharts5/locales/ja_JP.js\")],[\"ko-KR\",()=>import(\"@amcharts/amcharts5/locales/ko_KR.js\")],[\"lt-LT\",()=>import(\"@amcharts/amcharts5/locales/lt_LT.js\")],[\"lv-LV\",()=>import(\"@amcharts/amcharts5/locales/lv_LV.js\")],[\"no-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nb-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nl-NL\",()=>import(\"@amcharts/amcharts5/locales/nl_NL.js\")],[\"pl-PL\",()=>import(\"@amcharts/amcharts5/locales/pl_PL.js\")],[\"pt-BR\",()=>import(\"@amcharts/amcharts5/locales/pt_BR.js\")],[\"pt-PT\",()=>import(\"@amcharts/amcharts5/locales/pt_PT.js\")],[\"ro-RO\",()=>import(\"@amcharts/amcharts5/locales/ro_RO.js\")],[\"ru-RU\",()=>import(\"@amcharts/amcharts5/locales/ru_RU.js\")],[\"sk-SK\",()=>import(\"@amcharts/amcharts5/locales/sk_SK.js\")],[\"sl-SL\",()=>import(\"@amcharts/amcharts5/locales/sl_SL.js\")],[\"sr-RS\",()=>import(\"@amcharts/amcharts5/locales/sr_RS.js\")],[\"sv-SE\",()=>import(\"@amcharts/amcharts5/locales/sv_SE.js\")],[\"th-TH\",()=>import(\"@amcharts/amcharts5/locales/th_TH.js\")],[\"tr-TR\",()=>import(\"@amcharts/amcharts5/locales/tr_TR.js\")],[\"uk-UA\",()=>import(\"@amcharts/amcharts5/locales/uk_UA.js\")],[\"vi-VN\",()=>import(\"@amcharts/amcharts5/locales/vi_VN.js\")],[\"zh-CN\",()=>import(\"@amcharts/amcharts5/locales/zh_Hans.js\")],[\"zh-HK\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")],[\"zh-TW\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")]]);function l(a){const s=r(a);if(!s)return null;for(const t of m.keys()){if(r(t)===s)return t}return null}function o(a){return a?m.has(a)?a:l(a)??c:c}async function h(s,r=t()){const c=a.new(s);return c.locale=(await m.get(o(r))()).default,c}export{h as createRoot};\n","import { Graphics, IGraphicsSettings, IGraphicsPrivate } from \"./Graphics\";\nimport * as $math from \"../util/Math\";\n\nexport interface IPointedRectangleSettings extends IGraphicsSettings {\n\n\t/**\n\t * A width of the pinter's (stem's) thick end (base) in pixels.\n\t */\n\tpointerBaseWidth?: number;\n\n\t/**\n\t * A length of the pinter (stem) in pixels.\n\t */\n\tpointerLength?: number;\n\n\t/**\n\t * X coordinate the shape is pointing to.\n\t */\n\tpointerX?: number;\n\n\t/**\n\t * Y coordinate the shape is pointing to.\n\t */\n\tpointerY?: number;\n\n\t/**\n\t * Corner radius in pixels.\n\t */\n\tcornerRadius?: number;\n}\n\nexport interface IPointedRectanglePrivate extends IGraphicsPrivate {\n}\n\n/**\n * Draws a rectangle with a pointer.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/graphics/} for more info\n * @important\n */\nexport class PointedRectangle extends Graphics {\n\n\tdeclare public _settings: IPointedRectangleSettings;\n\tdeclare public _privateSettings: IPointedRectanglePrivate;\n\n\tpublic static className: string = \"PointedRectangle\";\n\tpublic static classNames: Array<string> = Graphics.classNames.concat([PointedRectangle.className]);\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\n\t\tif (this.isDirty(\"pointerBaseWidth\") || this.isDirty(\"cornerRadius\") || this.isDirty(\"pointerLength\") || this.isDirty(\"pointerX\") || this.isDirty(\"pointerY\") || this.isDirty(\"width\") || this.isDirty(\"height\")) {\n\t\t\tthis._clear = true;\n\t\t}\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tif (this._clear) {\n\n\t\t\tthis.markDirtyBounds();\n\n\t\t\tlet w = this.width();\n\t\t\tlet h = this.height();\n\n\t\t\tif (w > 0 && h > 0) {\n\t\t\t\tlet cr = this.get(\"cornerRadius\", 8);\n\t\t\t\tcr = $math.fitToRange(cr, 0, Math.min(w / 2, h / 2));\n\n\t\t\t\tlet x = this.get(\"pointerX\", 0);\n\t\t\t\tlet y = this.get(\"pointerY\", 0);\n\t\t\t\tlet bwh = this.get(\"pointerBaseWidth\", 15) / 2;\n\n\t\t\t\t// corner coordinates\n\t\t\t\t// top left\n\t\t\t\tlet xtl = 0;\n\t\t\t\tlet ytl = 0;\n\t\t\t\t// top right\n\t\t\t\tlet xtr = w;\n\t\t\t\tlet ytr = 0;\n\t\t\t\t// bottom right\n\t\t\t\tlet xbr = w;\n\t\t\t\tlet ybr = h;\n\t\t\t\t// bottom left\n\t\t\t\tlet xbl = 0;\n\t\t\t\tlet ybl = h;\n\n\t\t\t\t// find stem base side: http://$math.stackexchange.com/questions/274712/calculate-on-which-side-of-straign-line-is-dot-located\n\t\t\t\t// d=(xx1)(y2y1)(yy1)(x2x1)\n\t\t\t\tlet d1 = (x - xtl) * (ybr - ytl) - (y - ytl) * (xbr - xtl);\n\t\t\t\tlet d2 = (x - xbl) * (ytr - ybl) - (y - ybl) * (xtr - xbl);\n\n\t\t\t\tconst display = this._display;\n\t\t\t\t// top\n\t\t\t\tdisplay.moveTo(cr, 0);\n\n\t\t\t\tif (d1 > 0 && d2 > 0) {\n\t\t\t\t\tlet stemX = Math.round($math.fitToRange(x, cr + bwh, w - bwh - cr));\n\t\t\t\t\ty = $math.fitToRange(y, -Infinity, 0);\n\n\t\t\t\t\tdisplay.lineTo(stemX - bwh, 0);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(stemX + bwh, 0);\n\t\t\t\t}\n\n\t\t\t\tdisplay.lineTo(w - cr, 0);\n\t\t\t\tdisplay.arcTo(w, 0, w, cr, cr);\n\n\t\t\t\t// right\n\t\t\t\tif (d1 > 0 && d2 < 0) {\n\t\t\t\t\tlet stemY = Math.round($math.fitToRange(y, cr + bwh, h - bwh - cr));\n\t\t\t\t\tx = $math.fitToRange(x, w, Infinity);\n\t\t\t\t\tdisplay.lineTo(w, cr);\n\t\t\t\t\tdisplay.lineTo(w, Math.max(stemY - bwh, cr));\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(w, stemY + bwh);\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(w, h - cr);\n\t\t\t\tdisplay.arcTo(w, h, w - cr, h, cr);\n\n\t\t\t\t// bottom\n\t\t\t\tif (d1 < 0 && d2 < 0) {\n\t\t\t\t\tlet stemX = Math.round($math.fitToRange(x, cr + bwh, w - bwh - cr));\n\t\t\t\t\ty = $math.fitToRange(y, h, Infinity);\n\n\t\t\t\t\tdisplay.lineTo(w - cr, h);\n\t\t\t\t\tdisplay.lineTo(stemX + bwh, h);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(stemX - bwh, h);\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(cr, h)\n\t\t\t\tdisplay.arcTo(0, h, 0, h - cr, cr);\n\n\n\t\t\t\t// left\n\t\t\t\tif (d1 < 0 && d2 > 0) {\n\t\t\t\t\tlet stemY = Math.round($math.fitToRange(y, cr + bwh, h - cr - bwh));\n\t\t\t\t\tx = $math.fitToRange(x, -Infinity, 0);\n\t\t\t\t\tdisplay.lineTo(0, h - cr);\n\t\t\t\t\tdisplay.lineTo(0, stemY + bwh);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(0, Math.max(stemY - bwh, cr));\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(0, cr);\n\t\t\t\tdisplay.arcTo(0, 0, cr, 0, cr);\n\t\t\t\tdisplay.closePath();\n\t\t\t}\n\t\t}\n\t}\n}\n","import type { IBounds } from \"../util/IBounds\";\nimport type { IPoint } from \"../util/IPoint\";\nimport type { Pattern } from \"../render/patterns/Pattern\";\nimport type { Time } from \"../util/Animation\";\nimport type { Sprite } from \"../render/Sprite\";\nimport type { Graphics } from \"../render/Graphics\";\nimport type { IPointerEvent } from \"../render/backend/Renderer\";\nimport type { DataItem, IComponentDataItem } from \"./Component\";\nimport type { Root } from \"../Root\";\nimport type { Template } from \"../util/Template\";\nimport type { Entity } from \"../util/Entity\";\n\nimport { MultiDisposer, IDisposer } from \"../util/Disposer\";\nimport { Label } from \"../render/Label\";\nimport { PointedRectangle } from \"../render/PointedRectangle\";\nimport { Container, IContainerPrivate, IContainerSettings } from \"./Container\";\nimport { Percent } from \"../util/Percent\";\nimport { Color } from \"../util/Color\";\n\nimport * as $math from \"../util/Math\";\nimport * as $array from \"../util/Array\";\nimport * as $utils from \"../util/Utils\";\n\n\nexport interface ITooltipSettings extends IContainerSettings {\n\n\t/**\n\t * Text to use for tooltip's label.\n\t */\n\tlabelText?: string;\n\n\t/**\n\t * HTML content to use for tooltip's label.\n\t *\n\t * @since 5.2.11\n\t */\n\tlabelHTML?: string;\n\n\t/**\n\t * A screen reader content for the label.\n\t *\n\t * Used in conjuction with `readerAnnounce`. If it is set to `true`, and\n\t * `labelAriaLabel` is set, its contents will be read out by a screen reader\n\t * when tooltip is shown or its data item changes.\n\t *\n\t * Otherwise, regular `labelText` (or `text` set directly on tooltip label) will\n\t * be used for scree reader announcement.\n\t *\n\t * @since 5.9.2\n\t */\n\tlabelAriaLabel?: string;\n\n\t/**\n\t * A direction of the tooltip pointer.\n\t *\n\t * https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Orientation\n\t */\n\tpointerOrientation?: \"left\" | \"right\" | \"up\" | \"down\" | \"vertical\" | \"horizontal\";\n\n\t/**\n\t * If set to `true` will use the same `fill` color for its background as\n\t * its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default true\n\t */\n\tgetFillFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `filGradientl` for its background as\n\t * its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetFillGradientFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `fill` color as its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetLabelFillFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `stroke` color as its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetStrokeFromSprite?: boolean;\n\n\t/**\n\t * Screen bounds to constrain the tooltip within.\n\t */\n\tbounds?: IBounds;\n\n\t/**\n\t * If set to `true` tooltip will adjust its text color for better visibility\n\t * on its background.\n\t *\n\t * @default true\n\t */\n\tautoTextColor?: boolean;\n\n\t/**\n\t * Screen coordinates the tooltip show point to.\n\t */\n\tpointTo?: IPoint;\n\n\t/**\n\t * Duration in milliseconds for tooltip position change, e.g. when tooltip\n\t * is jumping from one target to another.\n\t */\n\tanimationDuration?: number;\n\n\t/**\n\t * Easing function for tooltip animation.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/animations/#Easing_functions} for more info\n\t */\n\tanimationEasing?: (t: Time) => Time;\n\n\t/**\n\t * A target element tooltip is shown fow.\n\t */\n\ttooltipTarget?: Sprite;\n\n\t/**\n\t * If set to `true`, tooltip's target element will considered to be hovered\n\t * when mouse pointer is over tooltip itself.\n\t *\n\t * @since 5.2.14\n\t */\n\tkeepTargetHover?: boolean;\n\n\t/**\n\t * If set to `true` the tooltip contents will be read out by a screen reader\n\t * when displayed or changed.\n\t *\n\t * @default false\n\t * @since 5.9.2\n\t */\n\treaderAnnounce?: boolean;\n\n}\n\nexport interface ITooltipPrivate extends IContainerPrivate {\n}\n\n/**\n * Creates a tooltip.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/} for more info\n * @important\n */\nexport class Tooltip extends Container {\n\n\tpublic _fx: number = 0;\n\tpublic _fy: number = 0;\n\n\tdeclare public _settings: ITooltipSettings;\n\tdeclare public _privateSettings: ITooltipPrivate;\n\n\tprotected _label!: Label;\n\tpublic static className: string = \"Tooltip\";\n\tpublic static classNames: Array<string> = Container.classNames.concat([Tooltip.className]);\n\n\tprotected _fillDp: IDisposer | undefined;\n\tprotected _fillGrDp: IDisposer | undefined;\n\tprotected _strokeDp: IDisposer | undefined;\n\tprotected _labelDp: IDisposer | undefined;\n\n\tprotected _w: number = 0;\n\tprotected _h: number = 0;\n\n\tprotected _keepHoverDp: MultiDisposer | undefined;\n\tprotected _htmlContentHovered: boolean = false;\n\n\tconstructor(root: Root, settings: Entity[\"_settings\"], isReal: boolean, templates: Array<Template<Entity>> = []) {\n\t\tsuper(root, settings, isReal, templates);\n\t}\n\n\tprotected _afterNew() {\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"tooltip\"]);\n\n\t\tsuper._afterNew();\n\n\t\tconst background: Graphics = this._setDefaultFn(\"background\", () => {\n\t\t\treturn PointedRectangle.new(this._root, {});\n\t\t});\n\n\t\tbackground.set(\"themeTags\", [\"tooltip\", \"background\"]);\n\n\t\tthis._label = this.children.push(Label.new(this._root, {}));\n\n\t\tthis._disposers.push(this._label.events.on(\"boundschanged\", () => {\n\t\t\tthis._updateBackground();\n\t\t}))\n\n\t\tthis._disposers.push(this.on(\"bounds\", () => {\n\t\t\tthis._updateBackground();\n\t\t}))\n\n\t\tthis._updateTextColor();\n\n\t\tthis._root.tooltipContainer.children.push(this);\n\t\tthis.hide(0);\n\n\t\tthis._disposers.push(this.label.onPrivate(\"htmlElement\", (htmlElement) => {\n\t\t\tif (htmlElement) {\n\t\t\t\tthis._disposers.push($utils.addEventListener(htmlElement, \"pointerover\", (_ev) => {\n\t\t\t\t\tthis._htmlContentHovered = true;\n\t\t\t\t}));\n\t\t\t\tthis._disposers.push($utils.addEventListener(htmlElement, \"pointerout\", (_ev) => {\n\t\t\t\t\tthis._htmlContentHovered = false;\n\t\t\t\t}));\n\t\t\t}\n\t\t}))\n\n\t\tthis.on(\"visible\", (_ev) => {\n\t\t\tthis._handleReaderAnnouncement();\n\t\t});\n\n\t\tthis.label.events.on(\"dataitemchanged\", (_ev) => {\n\t\t\tthis._handleReaderAnnouncement();\n\t\t});\n\n\t\tthis._root._tooltips.push(this);\n\t}\n\n\tprotected _handleReaderAnnouncement() {\n\t\tif (this.get(\"readerAnnounce\") && this.isVisibleDeep()) {\n\t\t\tthis._root.readerAlert(this.label.getAccessibleText());\n\t\t}\n\t}\n\n\t/**\n\t * A [[Label]] element for the tooltip.\n\t *\n\t * @readonly\n\t * @return Label\n\t */\n\tpublic get label(): Label {\n\t\treturn this._label;\n\t}\n\n\t/**\n\t * Permanently disposes the tooltip.\n\t */\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\t$array.remove(this._root._tooltips, this);\n\t}\n\n\tpublic _updateChildren() {\n\t\tsuper._updateChildren();\n\n\t\tif (this.isDirty(\"pointerOrientation\") || this.isPrivateDirty(\"minWidth\") || this.isPrivateDirty(\"minHeight\")) {\n\t\t\tthis.get(\"background\")!._markDirtyKey(\"width\");\n\t\t}\n\n\t\tconst labelText = this.get(\"labelText\");\n\t\tif (labelText != null) {\n\t\t\tthis.label.set(\"text\", this.get(\"labelText\"));\n\t\t}\n\t\tconst labelHTML = this.get(\"labelHTML\");\n\t\tif (labelHTML != null) {\n\t\t\tthis.label.set(\"html\", this.get(\"labelHTML\"));\n\t\t}\n\t\tconst labelAriaLabel = this.get(\"labelAriaLabel\");\n\t\tif (labelAriaLabel != null) {\n\t\t\tthis.label.set(\"ariaLabel\", this.get(\"labelAriaLabel\"));\n\t\t}\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tif (this.isDirty(\"pointTo\") || this.isDirty(\"pointerOrientation\")) {\n\t\t\t// can't compare to previous, as sometimes pointTo is set twice (when pointer moves, so the position won't be udpated)\n\t\t\tthis._updateBackground();\n\t\t}\n\n\t\tif (this.isDirty(\"tooltipTarget\")) {\n\t\t\tthis.updateBackgroundColor();\n\t\t}\n\n\t\tif (this.isDirty(\"keepTargetHover\")) {\n\t\t\tconst keephover = this.get(\"keepTargetHover\");\n\t\t\tif (keephover) {\n\t\t\t\tconst bg = this.get(\"background\")!;\n\t\t\t\tthis._keepHoverDp = new MultiDisposer([\n\t\t\t\t\tbg.events.on(\"pointerover\", (_ev) => {\n\t\t\t\t\t\tlet target = this.get(\"tooltipTarget\");\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tif (target.parent && target.parent.getPrivate(\"tooltipTarget\") == target) {\n\t\t\t\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttarget.hover();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tbg.events.on(\"pointerout\", (_ev) => {\n\t\t\t\t\t\tlet target = this.get(\"tooltipTarget\");\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tif (target.parent && target.parent.getPrivate(\"tooltipTarget\") == target) {\n\t\t\t\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!this._htmlContentHovered) {\n\t\t\t\t\t\t\t\ttarget.unhover();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t]);\n\n\t\t\t\tthis.label.onPrivate(\"htmlElement\", (htmlElement: any) => {\n\t\t\t\t\tif (this._keepHoverDp && htmlElement) {\n\t\t\t\t\t\tthis._keepHoverDp.disposers.push($utils.addEventListener<PointerEvent | MouseEvent>(htmlElement, \"pointerleave\", (ev: IPointerEvent) => {\n\t\t\t\t\t\t\tconst outEvent = this.root._renderer.getEvent(ev);\n\t\t\t\t\t\t\tbg.events.dispatch(\"pointerout\", {\n\t\t\t\t\t\t\t\ttype: \"pointerout\",\n\t\t\t\t\t\t\t\toriginalEvent: outEvent.event,\n\t\t\t\t\t\t\t\tpoint: outEvent.point,\n\t\t\t\t\t\t\t\tsimulated: false,\n\t\t\t\t\t\t\t\ttarget: bg\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this._keepHoverDp) {\n\t\t\t\t\tthis._keepHoverDp.dispose();\n\t\t\t\t\tthis._keepHoverDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _onShow() {\n\t\tsuper._onShow();\n\t\tthis.updateBackgroundColor();\n\t}\n\n\n\tpublic updateBackgroundColor() {\n\t\tlet tooltipTarget = this.get(\"tooltipTarget\");\n\t\tconst background = this.get(\"background\");\n\t\tlet fill: Color | undefined;\n\t\tlet stroke: Color | undefined;\n\n\n\t\tif (tooltipTarget && background) {\n\n\t\t\tfill = tooltipTarget.get(\"fill\" as any);\n\t\t\tstroke = tooltipTarget.get(\"stroke\" as any);\n\n\t\t\tif (fill == null) {\n\t\t\t\tfill = stroke;\n\t\t\t}\n\n\t\t\tif (this.get(\"getFillFromSprite\")) {\n\n\t\t\t\tif (this._fillDp) {\n\t\t\t\t\tthis._fillDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tbackground.set(\"fill\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._fillDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tbackground.set(\"fill\", fill);\n\t\t\t\t\t\tthis._updateTextColor(fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis._disposers.push(this._fillDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getFillGradientFromSprite\")) {\n\n\t\t\t\tif (this._fillGrDp) {\n\t\t\t\t\tthis._fillGrDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tlet fillGradient = tooltipTarget.get(\"fillGradient\" as any);\n\n\t\t\t\tif (fillGradient != null) {\n\t\t\t\t\tbackground.set(\"fillGradient\", fillGradient);\n\t\t\t\t}\n\n\t\t\t\tthis._fillGrDp = tooltipTarget.on(\"fillGradient\" as any, (fillGradient) => {\n\t\t\t\t\tif (fillGradient != null) {\n\t\t\t\t\t\tbackground.set(\"fillGradient\", fillGradient);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis._disposers.push(this._fillGrDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getStrokeFromSprite\")) {\n\n\t\t\t\tif (this._strokeDp) {\n\t\t\t\t\tthis._strokeDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tbackground.set(\"stroke\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._strokeDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tbackground.set(\"stroke\", fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tthis._disposers.push(this._strokeDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getLabelFillFromSprite\")) {\n\n\t\t\t\tif (this._labelDp) {\n\t\t\t\t\tthis._labelDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tthis.label.set(\"fill\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._labelDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tthis.label.set(\"fill\", fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tthis._disposers.push(this._labelDp);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateTextColor(fill);\n\t}\n\n\n\tprotected _updateTextColor(fill?: Color | Pattern) {\n\t\tif (this.get(\"autoTextColor\")) {\n\t\t\tif (fill == null) {\n\t\t\t\tfill = this.get(\"background\")!.get(\"fill\") as Color;\n\t\t\t}\n\n\t\t\tif (fill == null) {\n\t\t\t\tfill = this._root.interfaceColors.get(\"background\");\n\t\t\t}\n\n\t\t\tif (fill instanceof Color) {\n\t\t\t\tthis.label.set(\"fill\", Color.alternative(fill, this._root.interfaceColors.get(\"alternativeText\"), this._root.interfaceColors.get(\"text\")));\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _setDataItem(dataItem?: DataItem<IComponentDataItem>): void {\n\t\tsuper._setDataItem(dataItem);\n\t\tthis.label._setDataItem(dataItem);\n\t}\n\n\n\tprotected _updateBackground() {\n\t\tsuper.updateBackground();\n\t\tconst parent = this._root.container;\n\n\t\tif (parent) {\n\n\t\t\tlet cw = 0.5;\n\t\t\tlet ch = 0.5;\n\n\t\t\tlet centerX = this.get(\"centerX\");\n\t\t\tif (centerX instanceof Percent) {\n\t\t\t\tcw = centerX.value;\n\t\t\t}\n\n\t\t\tlet centerY = this.get(\"centerY\");\n\t\t\tif (centerY instanceof Percent) {\n\t\t\t\tch = centerY.value;\n\t\t\t}\n\n\t\t\tlet parentW = parent.width();\n\t\t\tlet parentH = parent.height();\n\n\t\t\tlet tooltipContainer = this.parent;\n\t\t\tlet xx = 0;\n\t\t\tlet yy = 0;\n\t\t\tif (tooltipContainer) {\n\t\t\t\txx = tooltipContainer.x();\n\t\t\t\tyy = tooltipContainer.y();\n\n\t\t\t\tconst layerMargin = tooltipContainer.get(\"layerMargin\");\n\t\t\t\tif (layerMargin) {\n\t\t\t\t\txx += layerMargin.left || 0;\n\t\t\t\t\tyy += layerMargin.top || 0;\n\t\t\t\t\tparentW += (layerMargin.left || 0) + (layerMargin.right || 0);\n\t\t\t\t\tparentH += (layerMargin.top || 0) + (layerMargin.bottom || 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst bounds = this.get(\"bounds\", { left: -xx, top: -yy, right: parentW - xx, bottom: parentH - yy });\n\n\t\t\tthis._updateBounds();\n\n\t\t\tlet w = this.width();\n\t\t\tlet h = this.height();\n\n\t\t\t// use old w and h,as when tooltip is hidden, these are 0 and unneeded animation happens\n\t\t\tif (w === 0) {\n\t\t\t\tw = this._w;\n\t\t\t}\n\n\t\t\tif (h === 0) {\n\t\t\t\th = this._h;\n\t\t\t}\n\n\t\t\tlet pointTo = this.get(\"pointTo\", { x: parentW / 2, y: parentH / 2 });\n\t\t\tlet x = pointTo.x;\n\t\t\tlet y = pointTo.y;\n\n\t\t\tlet pointerOrientation = this.get(\"pointerOrientation\");\n\n\t\t\tlet background = this.get(\"background\");\n\t\t\tlet pointerLength = 0;\n\t\t\tlet bgStrokeSizeY = 0;\n\t\t\tlet bgStrokeSizeX = 0;\n\n\t\t\tif (background instanceof PointedRectangle) {\n\t\t\t\tpointerLength = background.get(\"pointerLength\", 0);\n\t\t\t\tbgStrokeSizeY = background.get(\"strokeWidth\", 0) / 2;\n\t\t\t\tbgStrokeSizeX = bgStrokeSizeY;\n\t\t\t\tbackground.set(\"width\", w);\n\t\t\t\tbackground.set(\"height\", h);\n\t\t\t}\n\n\t\t\tlet pointerX = 0;\n\t\t\tlet pointerY = 0;\n\n\t\t\tlet boundsW = bounds.right - bounds.left;\n\t\t\tlet boundsH = bounds.bottom - bounds.top;\n\n\n\t\t\t// horizontal\n\t\t\tif (pointerOrientation == \"horizontal\" || pointerOrientation == \"left\" || pointerOrientation == \"right\") {\n\t\t\t\tbgStrokeSizeY = 0;\n\t\t\t\tif (pointerOrientation == \"horizontal\") {\n\t\t\t\t\tif (x > bounds.left + boundsW / 2) {\n\t\t\t\t\t\tx -= (w * (1 - cw) + pointerLength);\n\t\t\t\t\t\tbgStrokeSizeX *= -1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx += (w * cw + pointerLength);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pointerOrientation == \"left\") {\n\t\t\t\t\tx += (w * (1 - cw) + pointerLength);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tx -= (w * cw + pointerLength);\n\t\t\t\t\tbgStrokeSizeX *= -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// vertical pointer\n\t\t\telse {\n\t\t\t\tbgStrokeSizeX = 0;\n\t\t\t\tif (pointerOrientation == \"vertical\") {\n\t\t\t\t\tif (y > bounds.top + h / 2 + pointerLength) {\n\t\t\t\t\t\ty -= (h * (1 - ch) + pointerLength);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ty += (h * ch + pointerLength);\n\t\t\t\t\t\tbgStrokeSizeY *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pointerOrientation == \"down\") {\n\t\t\t\t\ty -= (h * (1 - ch) + pointerLength);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ty += (h * ch + pointerLength);\n\t\t\t\t\tbgStrokeSizeY *= -1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tx = $math.fitToRange(x, bounds.left + w * cw, bounds.left + boundsW - w * (1 - cw)) + bgStrokeSizeX;\n\t\t\ty = $math.fitToRange(y, bounds.top + h * ch, bounds.top + boundsH - h * (1 - ch)) - bgStrokeSizeY;\n\n\t\t\tpointerX = pointTo.x - x + w * cw + bgStrokeSizeX;\n\t\t\tpointerY = pointTo.y - y + h * ch - bgStrokeSizeY;\n\n\t\t\tthis._fx = x;\n\t\t\tthis._fy = y;\n\n\t\t\tconst animationDuration = this.get(\"animationDuration\", 0);\n\n\t\t\tif (animationDuration > 0 && this.get(\"visible\") && this.get(\"opacity\") > 0.1) {\n\t\t\t\tconst animationEasing = this.get(\"animationEasing\");\n\t\t\t\tthis.animate({ key: \"x\", to: x, duration: animationDuration, easing: animationEasing });\n\t\t\t\tthis.animate({ key: \"y\", to: y, duration: animationDuration, easing: animationEasing });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.set(\"x\", x);\n\t\t\t\tthis.set(\"y\", y);\n\t\t\t}\n\n\t\t\tif (background instanceof PointedRectangle) {\n\t\t\t\tbackground.set(\"pointerX\", pointerX);\n\t\t\t\tbackground.set(\"pointerY\", pointerY);\n\t\t\t}\n\n\t\t\tif (w > 0) {\n\t\t\t\tthis._w = w;\n\t\t\t}\n\t\t\tif (h > 0) {\n\t\t\t\tthis._h = h;\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["Native","constructor","Object","defineProperty","this","_observer","ResizeObserver","entries","$array","entry","_targets","x","target","callback","addTarget","observe","box","push","removeTarget","unobserve","Raf","_timer","lastTime","loop","currentTime","Date","now","delay","newSize","getBoundingClientRect","width","size","height","length","requestAnimationFrame","left","right","top","bottom","y","cancelAnimationFrame","observer","ResizeSensor","element","_sensor","_element","_listener","$utils","isDisposed","_disposed","dispose","sensor","InterfaceColors","Entity","classNames","concat","className","NumberFormatter","_setDefaults","_setDefault","bns","sns","bs","_t","suffix","super","_beforeChanged","format","value","precision","formatted","$type","toLowerCase","get","source","Number","Intl","NumberFormat","undefined","e","details","info","parseFormat","_root","language","positive","negative","zero","mod","$object","decimals","active","template","split","join","applyFormat","thousandSeparator","translateEmpty","decimalSeparator","parts","replace","_part","item","parsed","partFormat","chunks","TextFormatter","chunk","i","text","type","matches","match","mods","modSpacing","a","thousands","passive","b","interval","pop","Math","abs","prefix","indexOf","applyPrefix","ol","min","toString","parseFloat","toPrecision","translate","exp","toExponential","round","d","pow","toFixed","res","ints","Array","ip","intsr","reverse","len","c","substr","unshift","separator","decs","prefixes","force","arguments","newvalue","applied","k","number","floor","escape","unescape","parseDate","timezone","date","year","month","day","hour","minute","second","millisecond","weekday","formatToParts","forEach","toUTCDate","UTC","Timezone","isReal","Error","name","_utc","DateTimeFormat","hour12","timeZone","fractionalSecondDigits","_dtf","new","convertLocal","offset","offsetUTC","userOffset","getTimezoneOffset","output","setUTCMinutes","getUTCMinutes","newUserOffset","DateFormatter","ignoreTimezone","locales","originalDate","utc","getTime","toUpperCase","fullYear","hours","minutes","seconds","milliseconds","timestamp","getUTCFullYear","getUTCMonth","getUTCDay","getUTCDate","getUTCHours","getUTCSeconds","getUTCMilliseconds","getFullYear","getMonth","getDay","getDate","getHours","getMinutes","getSeconds","getMilliseconds","ceil","_getMonth","_getShortMonth","translateFunc","call","_getShortWeekday","_getWeekday","locale","firstDayOfWeek","tz","tzh","tzm","toISOString","toUTCString","dateFormat","_months","index","_shortMonths","_weekdays","_shortWeekdays","parse","parseInt","reg","parsedIndexes","resValues","indexAdjust","year3","year2","year1","getStringList","monthLong","monthShort","week","yearDay","weekdayLong","weekdayShort","am","hour12Base1","hourBase0","hour12Base0","hourBase1","millisecondDigits","zone","iso","regex","RegExp","val","resolveMonth","resolveShortMonth","isAm","ts","resolveTimezoneOffset","dir","isDefault","translateAll","list","DurationFormatter","dmillisecond","dsecond","dminute","dhour","dday","dweek","dmonth","aminute","ahour","aday","aweek","amonth","ayear","base","baseUnit","getFormat","color","dirs","absolute","_unitAliases","tstamp","toTimeStamp","values","part","unit","_toTimeUnit","unitValue","_getUnitValue","digits","code","maxValue","maxUnit","getValueUnit","max","currentUnit","ms","_getUnitValues","key","timeUnit","Language","setPrivate","en","prompt","getPrivate","translation","_len","rest","_key","translateAny","_len2","_key2","setTranslationAny","setTranslationsAny","translations","_len3","_key3","Matrix","tx","ty","setTransform","pivotX","pivotY","rotation","scale","cos","sin","apply","origin","applyInverse","id","append","matrix","a1","b1","c1","d1","prepend","tx1","copyFrom","_slicedToArray","arr","isArray","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","err","sliceIterator","TypeError","TAU","PI","mapToEllipse","_ref","rx","ry","cosphi","sinphi","centerx","centery","approxUnitArc","ang1","ang2","tan","x1","y1","x2","y2","vectorAngle","ux","uy","vx","vy","dot","acos","_ref2","px","py","cx","cy","_ref2$xAxisRotation","xAxisRotation","_ref2$largeArcFlag","largeArcFlag","_ref2$sweepFlag","sweepFlag","curves","pxp","pyp","lambda","sqrt","_getArcCenter","rxsq","rysq","pxpsq","pypsq","radicant","centerxp","centeryp","vx1","vy1","vx2","vy2","getArcCenter","_getArcCenter2","ratio","segments","map","curve","_mapToEllipse","_mapToEllipse2","_mapToEllipse3","checkArgs","actual","expected","checkMinArgs","checkEvenArgs","splitArcFlags","args","flag","exec","splice","assertBinary","eachTargets","hitTarget","f","interactive","_parent","onPointerEvent","event","touches","changedTouches","isTainted","image","canvas","document","createElement","context","getContext","willReadFrequently","drawImage","getImageData","console","warn","src","clearCanvas","view","style","crisp","CanvasPivot","_x","_y","CanvasDisplayObject","DisposerClass","renderer","_renderer","subStatus","status","inactive","layer","_layer","_dispose","_removeObject","getLayer","dirty","getCanvas","self","defaultLayer","setLayer","order","margin","visible","_ghostLayer","setMargin","layers","registerChildLayer","resizeLayer","resizeGhost","markDirtyLayer","clear","invalidateBounds","_localBounds","_addBounds","_bounds","_getColorId","_colorId","paintId","_isInteractive","_forceInteractive","_isInteractiveMask","contains","child","toGlobal","point","_matrix","toLocal","getLocalMatrix","_uMatrix","pivot","angle","getLocalBounds","bn","getAdjustedBounds","bounds","_setMatrix","p0","p1","p2","p3","on","_addEvent","Disposer","_localMatrix","_transform","resolution","m","_transformMargin","_transformLayer","render","targetGhostLayer","exportable","_omitTainted","ghostLayer","ghostContext","mask","save","_runPath","clip","globalAlpha","compoundAlpha","alpha","filter","_deferredGhostLayers","_render","restore","tainted","_ghostOnly","_drawGhost","hovering","_hovering","has","dragging","_dragging","some","shouldCancelTouch","tapToActivate","_touchActive","cancelTouch","CanvasContainer","interactiveChildren","addChild","_children","addChildAt","removeChild","_childLayers","deep","setPoint","Op","colorize","_context","_forceColor","colorizeGhost","forceColor","path","pathGhost","addBounds","BeginPath","beginPath","BeginFill","fillStyle","EndFill","clearShadow","fill","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","EndStroke","stroke","LineStyle","lineJoin","lineCap","strokeStyle","lineWidth","LineDash","dash","setLineDash","LineDashOffset","dashOffset","lineDashOffset","DrawRect","rect","l","t","r","DrawCircle","radius","moveTo","arc","DrawEllipse","radiusX","radiusY","ellipse","Arc","startAngle","endAngle","anticlockwise","arcBounds","$math","ArcTo","arcTo","LineTo","lineTo","MoveTo","ClosePath","closePath","BezierCurveTo","cpX","cpY","cpX2","cpY2","toX","toY","bezierCurveTo","QuadraticCurveTo","quadraticCurveTo","Shadow","blur","offsetX","offsetY","opacity","GraphicsImage","CanvasGraphics","BlendMode","NORMAL","_operations","_pushOp","op","beginFill","_fillAlpha","Color","toCSS","isMeasured","endFill","_hasShadows","endStroke","lineStyle","_strokeAlpha","setLineDashOffset","drawRect","drawCircle","drawEllipse","shadow","svgPath","cpx","cpy","qcpx","qcpy","SEGMENTS_REGEXP","ARGS_REGEXP","relative","arcToBezier","layerDirty","ghostOnly","drawGhost","globalCompositeOperation","blendMode","renderDetached","CanvasText","_textInfo","invalidateVisibility","textVisible","_originalScale","_shared","textAlign","direction","textBaseline","_prerender","ignoreGhost","ignoreFontWeight","fontStyle","_getFontStyle","font","fillOpacity","shadowOpacity","style2","fontVariant","fontWeight","fontSize","fontFamily","_measure","line","_index","textChunks","fillText","textDecoration","thickness","oversizedBehavior","metrics","_measureText","actualBoundingBoxLeft","actualBoundingBoxRight","getTextStyle","_ignoreFontWeight","test","navigator","vendor","rtl","maxWidth","truncate","wrap","refText","lines","currentStyle","styleRestored","minX","maxX","ignoreFormatting","lineInfo","ascent","actualBoundingBoxAscent","actualBoundingBoxDescent","currentFormat","currentFill","currentChunkWidth","currentVerticalAlign","currentDecoration","skipFurtherText","firstTextChunk","leftoverChunks","verticalAlign","chunkWidth","truncated","breakWords","ellipsis","ellipsisMetrics","ellipsisWidth","excessWidth","_truncateText","tmpText","slice","leftBoundMod","rightBoundMod","boundsMod","chunkHeight","lineHeight","Percent","currentChunkOffset","baselineRatio","_fitRatio","minScale","maxW","maxH","maxHeight","w","h","fallbackBreakWords","tmp","measureText","fakeMetrics","div","innerText","visibility","position","body","appendChild","bbox","fontBoundingBoxAscent","fontBoundingBoxDescent","CanvasTextStyle","percent","CanvasRadialText","textType","_renderCircular","deltaAngle","orientation","inward","inside","align","kerning","clockwise","shouldReverse","_textReversed","maxAngle","midAngle","textHeight","lineStartAngle","rotate","angleShift","char","charWidth","_measureCircular","totalWidth","chars","CanvasImage","_imageMask","naturalWidth","naturalHeight","_getMask","imageSmoothingEnabled","fillRect","CanvasRendererEvent","originalPoint","Touch","identifier","CanvasRenderer","ArrayDisposer","GhostLayer","_patternCanvas","Set","window","devicePixelRatio","setAttribute","_layerDom","_disposers","_events","events","disposer","exportableView","listener","ev","preventDefault","_touchActiveTimeout","_delayTouchDeactivate","_ev","setTimeout","prevent","obj","wheelable","resetImageArray","imageArray","clearTimeout","tapToActivateTimeout","debugGhostView","parentNode","createLinearGradient","createRadialGradient","radius1","radius2","createPattern","graphics","background","repetition","_patternContext","clearRect","makeContainer","makeGraphics","makeText","makeTextStyle","makeRadialText","makePicture","resize","_calculatedWidth","_calculatedHeight","realWidth","realHeight","calculatedWidth","calculatedHeight","_realWidth","_realHeight","createDetachedLayer","CanvasLayer","getLayerByOrder","existingLayer","sort","insertBefore","root","_dirtyLayers","deferredGhostLayers","layerx","_lastPointerMoveEvent","native","_dispatchGlobalMousemove","rgb","distributeId","fromHex","_colorMap","_adjustBoundingBox","DOMRect","getEvent","originalEvent","adjustPoint","clientX","clientY","widthScale","heightScale","_getHitTarget","pixel","data","colorId","fromRGB","getObjectAtPoint","getImageArray","_withEvents","dispatching","cleanup","callbacks","disposed","_dispatchEventAll","interactionsEnabled","_dispatchEvent","dispatched","object","_dispatchMousedown","originalTarget","button","dragged","_mousedown","delete","cursorOverStyle","_replacedCursorStyle","add","removeHovering","_dispatchGlobalMouseup","_dispatchDragMove","_dispatchDragEnd","clickevent","_dispatchDoubleClick","_dispatchWheel","_makeSharedEvent","_listeners","CounterDisposer","increment","_onPointerEvent","timer","MultiDisposer","_","_initEvent","mouseup","pointercancel","mousedown","mousemove","options","canvasWidth","canvasHeight","minWidth","minHeight","maxScale","maintainPixelRatio","canvases","forceRender","needRerender","exportableContext","extraX","extraY","clientWidth","clientHeight","domWidth","domHeight","_resolution","_width","_height","rAF","fps","Root","dom","settings","EventDispatcher","VerticalLayout","HorizontalLayout","GridLayout","_settings","accessible","_a11yD","useSafeResolution","HTMLElement","getElementById","registry","rootElements","interfaceColors","inner","tooltipContainerBounds","_tooltipContainerSettings","_inner","_updateComputedStyles","_init","moveDOM","childNodes","_initResizeSensor","_handleLogo","_logo","offsetWidth","offsetHeight","hide","show","_showBranding","logo","tooltipContainer","children","Container","setStateOnChildren","paddingTop","paddingRight","paddingBottom","paddingLeft","centerY","p100","tooltipY","tooltipText","tooltipX","Rectangle","set","systemTooltip","open","states","create","Graphics","strokeWidth","_getRealSize","_getCalculatedSize","calculateSize","focusable","tabindex","ariaLabel","role","rootContainer","_rootContainer","_defaultThemes","DefaultTheme","container","htmlElementContainer","_htmlElementContainer","pointerEvents","overflow","readerAlertElement","_readerAlertElement","focusElementContainer","_focusElementContainer","tooltipElementContainer","_tooltipElementContainer","eventKey","_isShift","shiftKey","focusedSprite","_focusedSprite","announceText","readerAlert","downEvent","MouseEvent","dispatch","simulated","dragOffsetX","dragOffsetY","isDragging","_keyboardDragPoint","isEnabled","dragPoint","moveEvent","upEvent","group","items","_tabindexes","isVisibleDeep","lastIndex","_skipNextGroupJump","_focusNext","_startTicker","setThemes","_addTooltip","_hasLicense","_systemTooltip","tooltip","Tooltip","themeTags","_resizeSensorDisposer","autoResize","_display","_focusElementDirty","_updateCurrentFocus","_runTickers","_tickers","_runAnimations","running","_animations","animation","state","_runAnimation","AnimationState","Stopped","Playing","_isDirtyAnimation","_runDirties","allParents","_isDirtyParents","_dirtyParents","parent","uid","_prepareChildren","_updateChildren","objects","_dirty","entity","_changed","_clearDirty","_isDirty","depths","_dirtyBounds","depth","_positionHTMLElements","$order","_updateBounds","dirtyPositions","_dirtyPositions","sprite","_updatePosition","_afterChanged","_childrenPrep","_childrenUpdt","_renderFrame","_updateTick","_checkComputedStyles","animationDone","_runTicker","animationTime","_ticker","_paused","_runTickerNow","timeout","endTime","performance","updateTick","_addDirtyEntity","_addDirtyParent","_addDirtyBounds","_addDirtyPosition","_addAnimation","_markDirty","_markDirtyRedraw","once","eachFrame","markDirtyGlobal","walkChildren","markDirty","markDirtyBounds","_isDisposed","horizontalLayout","verticalLayout","innerHTML","themes","_applyThemes","tooltipContainerSettings","layerMargin","_tooltip","_registerTabindexOrder","_invalidateTabindexes","_unregisterTabindexOrder","aindex","bindex","groups","_moveFocusElement","_makeFocusElement","_decorateFocusElement","_positionFocusElement","focusElement","removeAttribute","label","populateString","ariaLive","ariaChecked","ariaCurrent","ariaSelected","ariaOrientation","ariaValueNow","ariaValueMin","ariaValueMax","ariaValueText","ariaControls","isHidden","getAttribute","tabIndex","disposers","_handleFocus","_handleBlur","_removeFocusElement","_hideFocusElement","display","globalBounds","padding","focusPadding","_getSpriteByFocusElement","found","focused","el","focusableElements","from","querySelectorAll","targetElement","focus","updateTooltip","_getText","tooltipElement","_makeTooltipElement","remove","removePrivate","_removeTooltipElement","parentElement","_invalidateAccessibility","documentPointToRoot","scaleWidth","scaleHeight","rootPointToDocument","addDisposer","styles","getComputedStyle","fontHash","changed","_fontHash","_invalidateLabelBounds","each","Text","licenses","_licenseApplied","_makeHTMLElement","htmlElement","wrapperTarget","htmlElementWrapper","needWrapper","_walkParents","boxSizing","_positionHTMLElement","_htmlEnabledContainers","clipPath","visualSettings","setting","strtingSettings","compositeScale","compositeRotation","transform","transformOrigin","compositeOpacity","pos","lw","lh","ll","lr","lt","lb","previousBounds","_adjustedLocalBounds","newBounds","originX","isPercent","originY","_setHTMLContent","html","_removeHTMLContent","s","Map","o","keys","async","default","PointedRectangle","isDirty","_clear","cr","bwh","xtl","ytl","xbl","d2","stemX","Infinity","stemY","_afterNew","_setDefaultFn","_label","Label","_updateBackground","_updateTextColor","onPrivate","_htmlContentHovered","_handleReaderAnnouncement","_tooltips","getAccessibleText","isPrivateDirty","_markDirtyKey","updateBackgroundColor","bg","_keepHoverDp","hover","unhover","outEvent","_onShow","tooltipTarget","_fillDp","_fillGrDp","fillGradient","_strokeDp","_labelDp","alternative","_setDataItem","dataItem","updateBackground","cw","ch","centerX","parentW","parentH","xx","yy","_w","_h","pointTo","pointerOrientation","pointerLength","bgStrokeSizeY","bgStrokeSizeX","pointerX","pointerY","boundsW","boundsH","_fx","_fy","animationDuration","animationEasing","animate","to","duration","easing"],"sourceRoot":""}